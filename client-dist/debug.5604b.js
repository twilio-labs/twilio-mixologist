!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s="CjMg")}({"+/Dx":function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){if(t.body&&t.body.message)return t.body.message;switch(t.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function o(t){return t.body?t.body.code:0}function s(t){return 409===t.status?new b.SyncNetworkError(i(t),t.status,o(t),t.body):t.status?new g.SyncError(i(t),t.status,o(t)):t instanceof k.TwilsockUnavailableError?t:new g.SyncError(t.message,0,0)}var a=n("L3Vt"),u=r(a),c=n("T4f3"),l=r(c),f=n("HxWs"),h=r(f),d=n("dACh"),p=r(d),v=n("jx4H"),_=r(v);Object.defineProperty(e,"__esModule",{value:!0});var y=n("qQO4"),m=n("E56Z"),g=n("XzVR"),b=n("eDHa"),w=n("i/BB"),k=n("JE0K"),x=function(){function t(e,n,r,i){(0,p.default)(this,t),this.productId=e,this.clientInfo=n,this.config=r,this.transport=i}return(0,_.default)(t,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":(0,h.default)(this.clientInfo),"Twilio-Request-Id":"RQ"+y.v4().replace(/-/g,""),"X-Twilio-Product-Id":this.productId,"X-Twilio-Token":this.config.token}}},{key:"backoffConfig",value:function(){return(0,l.default)({min:4e3,max:6e4,maxAttemptsTime:9e4,randomness:.2},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new u.default(function(r,i){var o=[502,503,504];n&&o.push(429);var a=new w.default(e.backoffConfig());a.on("attempt",function(){t().then(function(t){return a.succeeded(t)}).catch(function(t){if(-1!==o.indexOf(t.status)){var e=parseInt(t.headers?t.headers["Retry-After"]:null);a.failed(s(t),isNaN(e)?null:1e3*e)}else"Twilsock disconnected"===t.message?a.failed(s(t)):(a.removeAllListeners(),a.cancel(),i(s(t)))})}),a.on("succeeded",function(t){r(t)}),a.on("cancelled",function(t){return i(s(t))}),a.on("failed",function(t){return i(s(t))}),a.start()})}},{key:"get",value:function(t){var e=this,n=this.createHeaders();return m.default.debug("GET",t,"ID:",n["Twilio-Request-Id"]),this.executeWithRetry(function(){return e.transport.get(t,n)},!0)}},{key:"post",value:function(t,e,n,r){var i=this,o=this.createHeaders();return void 0!==n&&null!==n&&(o["If-Match"]=n),m.default.debug("POST",t,"ID:",o["Twilio-Request-Id"]),this.executeWithRetry(function(){return i.transport.post(t,o,e,r)},!1)}},{key:"put",value:function(t,e,n){var r=this,i=this.createHeaders();return void 0!==n&&null!==n&&(i["If-Match"]=n),m.default.debug("PUT",t,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry(function(){return r.transport.put(t,i,e)},!1)}},{key:"delete",value:function(t){var e=this,n=this.createHeaders();return m.default.debug("DELETE",t,"ID:",n["Twilio-Request-Id"]),this.executeWithRetry(function(){return e.transport.delete(t,n)},!1)}}]),t}();e.Network=x,e.default=x},"+o4f":function(t,e,n){"use strict";var r=n("AePr");t.exports=n("cYD/")("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(this,t=0===t?0:t,t)}},r)},"/GKJ":function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){return t&&void 0!==t[e]?t[e]:n}var o=n("dACh"),s=r(o),a=n("jx4H"),u=r(a);Object.defineProperty(e,"__esModule",{value:!0}),e.Configuration=function(){function t(e,n){(0,s.default)(this,t),n=n||{},n=n.Sync||n.DataSync||{};var r=n.cdsUri||"https://cds.twilio.com";this._token=e,this.settings={subscriptionsUri:r+"/v4/Subscriptions",documentsUri:r+"/v3/Documents",listsUri:r+"/v3/Lists",mapsUri:r+"/v3/Maps",sessionStorageEnabled:i(n,"enableSessionStorage",!0)}}return(0,u.default)(t,[{key:"updateToken",value:function(t){this._token=t}},{key:"token",get:function(){return this._token}},{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}}]),t}()},"/lpw":function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("0Qy9"),o=r(i),s=n("L3Vt"),a=r(s),u=n("dACh"),c=r(u),l=n("jx4H"),f=r(l);Object.defineProperty(e,"__esModule",{value:!0});var h=function(){function t(){(0,c.default)(this,t),this.queue=new Array,this.isActive=!1}return(0,f.default)(t,[{key:"wakeupQueue",value:function(){var t=this;!this.isActive&&this.queue.length>0&&(this.isActive=!0,setTimeout(function(){return t.executeTask(t.queue[0])},0))}},{key:"pickNext",value:function(){var t=this;if(this.queue.shift(),0===this.queue.length)return void(this.isActive=!1);setTimeout(function(){return t.executeTask(t.queue[0])},0)}},{key:"pickSame",value:function(t){var e=this;this.queue[0].arg=t,setTimeout(function(){return e.executeTask(e.queue[0])},0)}},{key:"executeTask",value:function(t){var e=this;t.task(t.context,t.arg).then(function(n){e.pickNext(),t.resolve(n)}).catch(function(n){try{if(!t.handle)throw n;t.handle(n).then(function(t){return e.pickSame(t)}).catch(t.reject)}catch(e){t.reject(n)}})}},{key:"add",value:function(t,e,n,r){var i=this;return new a.default(function(o,s){i.queue.push({task:t,context:e,arg:n,handle:r,resolve:o,reject:s}),i.wakeupQueue()})}}]),t}();e.RetryingQueue=h,(0,o.default)(h),e.default=h},"/wuY":function(t,e,n){var r=n("NB7d")("keys"),i=n("X6va");t.exports=function(t){return r[t]||(r[t]=i(t))}},0:function(){},"0KnF":function(t,e,n){n("Bdru"),t.exports=n("zKeE").Object.freeze},"0Qy9":function(t,e,n){t.exports={default:n("0KnF"),__esModule:!0}},"0WCH":function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"0Zys":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7xPs");e.default=function(t){return t&&t.__esModule?t:{default:t}}(r).default,t.exports=e.default},1:function(){},"11Ut":function(t,e,n){var r=n("Gfzd").f,i=n("yS17"),o=n("Ug9I")("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},"1kq3":function(t){t.exports=!0},"2SH0":function(t,e,n){var r=n("vSO4");r(r.P+r.R,"Map",{toJSON:n("x6MZ")("Map")})},"2mwf":function(t,e,n){n("c2zY")("observable")},"3Y9o":function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("L3Vt"),o=r(i),s=n("dACh"),a=r(s),u=n("jx4H"),c=r(u);Object.defineProperty(e,"__esModule",{value:!0}),e.Deferred=function(){function t(){var e=this;(0,a.default)(this,t),this._promise=new o.default(function(t,n){e._resolve=t,e._reject=n})}return(0,c.default)(t,[{key:"update",value:function(t){this._resolve(t)}},{key:"set",value:function(t){this.current=t,this._resolve(t)}},{key:"fail",value:function(t){this._reject(t)}},{key:"promise",get:function(){return this._promise}}]),t}()},"3v7p":function(t,e,n){n("htFH");var r=n("zKeE").Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},"3zRh":function(t,e,n){var r=n("g31e");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},"6Hp8":function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("T4f3"),o=r(i),s=n("aIIw"),a=r(s),u=n("BX4+"),c=r(u),l=n("dACh"),f=r(l),h=n("jx4H"),d=r(h),p=n("VOrx"),v=r(p),_=n("ZKjc"),y=r(_),m=n("L3Vt"),g=r(m),b=function(t,e,n,r){return new(n||(n=g.default))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var w=n("PD3G"),k=n("E56Z"),x=n("GBRx"),C=n("/lpw"),E=n("qXBc"),S=n("NQ19"),T=n("ZUV3"),O=function(t){function e(t,n,r){(0,f.default)(this,e);var i=(0,v.default)(this,(e.__proto__||(0,c.default)(e)).call(this,t,r));return i.actionQueue=new C.RetryingQueue,i.cache=new T.Cache,i.descriptor=n,i}return(0,y.default)(e,t),(0,d.default)(e,[{key:"__set",value:function(t,e){return b(this,void 0,void 0,a.default.mark(function n(){var r;return a.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.services.network.post(t,{data:e.data},e.revision);case 2:return r=n.sent,r.body.data=e.data,n.abrupt("return",r.body);case 5:case"end":return n.stop()}},n,this)}))}},{key:"push",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){var n,r,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.post(this.links.items,{data:t});case 2:return n=e.sent,r=Number(n.body.index),i=this.cache.store(r,new E.ListItem({index:r,revision:n.body.revision,lastEventId:n.body.last_event_id,uri:n.body.url,value:t}),n.body.last_event_id),this.emit("itemAdded",i,!0),e.abrupt("return",i);case 7:case"end":return e.stop()}},e,this)}))}},{key:"set",value:function(t,e){return this._actualSet(t,e)}},{key:"_actualSet",value:function(t,e,n){return b(this,void 0,void 0,a.default.mark(function r(){var i,o,s,u=this;return a.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.get(t);case 2:if(i=r.sent,o=void 0,n){r.next=10;break}return r.next=7,this.__set(i.uri,{data:e,revision:void 0});case 7:o=r.sent,r.next=14;break;case 10:return s=function(t){return b(u,void 0,void 0,a.default.mark(function e(){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(412!==t.status){e.next=5;break}return e.next=3,this._get(i.index);case 3:return r=e.sent,e.abrupt("return",{revision:r.revision,data:n(w.deepClone(r.value))});case 5:throw t;case 6:case"end":return e.stop()}},e,this)}))},r.next=13,this.actionQueue.add(this.__set.bind(this),i.uri,{revision:i.revision,data:e},s);case 13:o=r.sent;case 14:return i=this.cache.get(i.index),i&&o.last_event_id>i.lastEventId&&(i.update(o.last_event_id,o.revision,o.data),this.emit("itemUpdated",i,!0)),r.abrupt("return",i);case 17:case"end":return r.stop()}},r,this)}))}},{key:"mutate",value:function(t,e){return b(this,void 0,void 0,a.default.mark(function n(){var r;return a.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.get(t);case 2:return r=n.sent,n.abrupt("return",this._actualSet(t,e(w.deepClone(r.value)),e));case 4:case"end":return n.stop()}},n,this)}))}},{key:"update",value:function(t,e){return b(this,void 0,void 0,a.default.mark(function n(){return a.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.mutate(t,function(t){return(0,o.default)(t,e)}));case 1:case"end":return n.stop()}},n,this)}))}},{key:"remove",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){var n,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return n=e.sent,e.next=5,this.services.network.delete(n.uri);case 5:r=e.sent,this.cache.delete(t,r.body.last_event_id),this.emit("itemRemoved",t,!0);case 8:case"end":return e.stop()}},e,this)}))}},{key:"get",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){var n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.cache.get(t))){e.next=3;break}return e.abrupt("return",n);case 3:return e.abrupt("return",this._get(t));case 4:case"end":return e.stop()}},e,this)}))}},{key:"_get",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){var n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryItems({index:t});case 2:if(n=e.sent,!(n.items.length<1)){e.next=5;break}throw new Error("No item with index "+t+" found");case 5:return e.abrupt("return",n.items[0]);case 6:case"end":return e.stop()}},e,this)}))}},{key:"queryItems",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){var n,r,i,o,s=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},n=new w.UriBuilder(this.links.items).queryParam("From",t.from).queryParam("PageSize",t.limit).queryParam("Index",t.index).queryParam("PageToken",t.pageToken).queryParam("Order",t.order).build(),e.next=4,this.services.network.get(n);case 4:return r=e.sent,i=r.body.items.map(function(t){return s.cache.get(t.index)?s._handleItemUpdated(t.index,t.url,t.last_event_id,t.revision,t.data):s.cache.store(Number(t.index),new E.ListItem({index:Number(t.index),uri:t.url,revision:t.revision,lastEventId:t.last_event_id,value:t.data}),t.last_event_id),s.cache.get(t.index)}),o=r.body.meta,e.abrupt("return",new S.Paginator(i,function(t){return s.queryItems({pageToken:t})},o.previous_token,o.next_token));case 8:case"end":return e.stop()}},e,this)}))}},{key:"getItems",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},t.limit=t.pageSize||t.limit||50,t.order=t.order||"asc",e.abrupt("return",this.queryItems(t));case 4:case"end":return e.stop()}},e,this)}))}},{key:"getContext",value:function(){return b(this,void 0,void 0,a.default.mark(function t(){var e;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.context){t.next=2;break}return t.abrupt("return",this.context);case 2:return t.next=4,this.services.network.get(this.links.context);case 4:return e=t.sent,this.context=e.body.data,t.abrupt("return",this.context);case 7:case"end":return t.stop()}},t,this)}))}},{key:"updateContext",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.services.network.post(this.links.context,{data:t});case 3:return this.context=t,this.emit("contextUpdated",t,!0),e.abrupt("return",this);case 8:throw e.prev=8,e.t0=e.catch(0),k.default.error("Failed to update context",e.t0),e.t0;case 12:case"end":return e.stop()}},e,this,[[0,8]])}))}},{key:"removeList",value:function(){return b(this,void 0,void 0,a.default.mark(function t(){return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return t.stop()}},t,this)}))}},{key:"onRemoved",value:function(t){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.emit("collectionRemoved",t),t||this.emit("collectionRemovedRemotely")}},{key:"shouldIgnoreEvent",value:function(t,e){return this.cache.isKnown(t,e)}},{key:"_update",value:function(t,e){var n=Number(t.item_index);switch(t.type){case"list_item_added":this._handleItemAdded(n,t.item_url,t.id,t.item_revision,t.item_data);break;case"list_item_updated":this._handleItemUpdated(n,t.item_url,t.id,t.item_revision,t.item_data);break;case"list_item_removed":this._handleItemRemoved(n,t.id);break;case"list_context_updated":this._handleContextUpdate(t.context_data,t.id);break;case"list_removed":this.onRemoved(!1)}e&&this._advanceLastEventId(t.id,t.list_revision)}},{key:"_advanceLastEventId",value:function(t,e){this.lastEventId<t&&(this.descriptor.last_event_id=t,e&&(this.descriptor.revision=e))}},{key:"_handleItemAdded",value:function(t,e,n,r,i){if(!this.cache.isKnown(t,n)){var o=new E.ListItem({index:t,uri:e,lastEventId:n,revision:r,value:i});this.cache.store(t,o,n),this.emit("itemAdded",o,!1),this.emit("itemAddedRemotely",o)}}},{key:"_handleItemUpdated",value:function(t,e,n,r,i){var o=this.cache.get(t);o||this.shouldIgnoreEvent(t,n)?o&&n>o.lastEventId&&(o.update(n,r,i),this.emit("itemUpdated",o,!1),this.emit("itemUpdatedRemotely",o)):(o=this.cache.store(t,new E.ListItem({index:t,uri:e,lastEventId:n,revision:r,value:i}),n),this.emit("itemUpdated",o,!1),this.emit("itemUpdatedRemotely",o))}},{key:"_handleItemRemoved",value:function(t,e){this.cache.delete(t,e),this.emit("itemRemoved",t,!1),this.emit("itemRemovedRemotely",t)}},{key:"_handleContextUpdate",value:function(t,e){this.lastEventId<e&&(this.context=t,this.emit("contextUpdated",t,!1),this.emit("contextUpdatedRemotely",t))}},{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"type",get:function(){return"list"}}],[{key:"type",get:function(){return"list"}}]),e}(x.SyncEntity);e.SyncList=O,e.default=O},"6MLN":function(t,e,n){t.exports=!n("wLcK")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},"6t7t":function(t,e,n){t.exports={default:n("nFDa"),__esModule:!0}},"7AqT":function(t,e,n){var r=n("ZHvQ"),i=n("Ug9I")("iterator"),o=n("dhak");t.exports=n("zKeE").getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},"7Zlx":function(t,e,n){t.exports={default:n("vvo2"),__esModule:!0}},"7ruU":function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("LlWG"),o=r(i),s=n("dACh"),a=r(s),u=n("jx4H"),c=r(u);e.default=function(){function t(e,n){var r=this;(0,a.default)(this,t),n=n||{},(0,o.default)(this,{_twilsockWsHost:{value:((n.Twilsock||{}).uri||n.wsServer||"wss://tsock.twilio.com")+"/v3/wsconnect"},_token:{value:e,writable:!0},twilsockUri:{get:function(){return r._twilsockWsHost}},token:{get:function(){return r._token}}})}return(0,c.default)(t,[{key:"updateToken",value:function(t){this._token=t}}]),t}(),t.exports=e.default},"7tZR":function(t,e,n){var r=n("BxvP"),i=n("ayXv"),o=n("Ug9I")("species");t.exports=function(t){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},"7xPs":function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("0Qy9"),o=r(i),s=n("7Zlx"),a=r(s),u=n("L3Vt"),c=r(u),l=n("YZrv"),f=r(l),h=n("LlWG"),d=r(h),p=n("BX4+"),v=r(p),_=n("dACh"),y=r(_),m=n("jx4H"),g=r(m),b=n("VOrx"),w=r(b),k=n("ZKjc"),x=r(k),C=n("FRpO"),E=r(C),S=n("obon"),T=r(S),O=n("qQO4"),A=r(O),R=n("7ruU"),j=r(R),P=n("kthq"),I=r(P),F=n("f/lV"),M=r(F),L=function(t){function e(t,n){(0,y.default)(this,e);var r=(0,w.default)(this,(e.__proto__||(0,v.default)(e)).call(this));n=n||{},n.logLevel=n.logLevel||"error",T.default.setLevel(n.logLevel);var i=new j.default(t,n),o=new I.default(i),s=new M.default(o);return(0,d.default)(r,{_config:{value:i},_socket:{value:o},_packet:{value:s},_registrations:{value:new f.default},_registrationsInProgress:{value:new f.default},isConnected:{get:function(){return r._socket.isConnected}},connected:{get:function(){return r._socket.isConnected}},state:{get:function(){return r._socket.state}}}),r._socket.on("message",function(t,e){return setTimeout(function(){r.emit("message",t,e)},0)}),r._socket.on("connected",function(){return r._updateRegistrations()}),r._socket.on("connected",function(){return r.emit("connected")}),r._socket.on("disconnected",function(){return r.emit("disconnected")}),r._socket.on("stateChanged",function(t){return r.emit("stateChanged",t)}),r}return(0,x.default)(e,t),(0,g.default)(e,[{key:"send",value:function(t){return this._packet.send(t.to,t.headers,t.body)}},{key:"updateToken",value:function(t){return T.default.info("updateToken"),this._config.token===t?c.default.resolve():(this._config.updateToken(t),this._socket.updateToken(),c.default.resolve())}},{key:"_updateRegistration",value:function(t,e){var n=this;T.default.info("update registration for context",t);var r=this._registrationsInProgress.get(t);r||(r=new a.default,this._registrationsInProgress.set(t,r));var i=A.default.v4();return r.add(i),this._packet.putNotificationContext(t,e).then(function(){T.default.info("registration attempt succeeded for context",e),r.delete(i),0===(void 0!==r.size?r.size:(r._c||{}).size)&&(n._registrationsInProgress.delete(t),n.emit("registered",t))}).catch(function(o){T.default.info("registration attempt failed for context",e),T.default.debug(o),r.delete(i),0===(void 0!==r.size?r.size:(r._c||{}).size)&&(n._registrationsInProgress.delete(t),n.emit("registrationFailed",t,o))})}},{key:"_updateRegistrations",value:function(){var t=this;T.default.info("refreshing all registrations"),this._registrations.forEach(function(e,n){t._updateRegistration(n,e)})}},{key:"setNotificationsContext",value:function(t,e){if(!t||!e)throw new Error("Invalid arguments provided");this._registrations.set(t,e),this._socket.isConnected&&this._updateRegistration(t,e)}},{key:"removeNotificationsContext",value:function(t){this._registrations.has(t)&&(this._registrations.delete(t),this._socket.isConnected&&this._packet.deleteNotificationContext(t))}},{key:"connect",value:function(){return this._socket.connect()}},{key:"disconnect",value:function(){return this._socket.disconnect()}}]),e}(E.default);e.default=L,(0,o.default)(L),t.exports=e.default},"9kJF":function(t,e,n){"use strict";var r,i,o,s=n("1kq3"),a=n("i1Q6"),u=n("3zRh"),c=n("ZHvQ"),l=n("vSO4"),f=n("BxvP"),h=n("g31e"),d=n("KUik"),p=n("ozpD"),v=n("B1ls"),_=n("uzcO").set,y=n("H109")(),m=a.TypeError,g=a.process,b=a.Promise,g=a.process,w="process"==c(g),k=function(){},x=!!function(){try{var t=b.resolve(1),e=(t.constructor={})[n("Ug9I")("species")]=function(t){t(k,k)};return(w||"function"==typeof PromiseRejectionEvent)&&t.then(k)instanceof e}catch(t){}}(),C=function(t,e){return t===e||t===b&&e===o},E=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},S=function(t){return C(b,t)?new T(t):new i(t)},T=i=function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw m("Bad Promise constructor");e=t,n=r}),this.resolve=h(e),this.reject=h(n)},O=function(t){try{t()}catch(t){return{error:t}}},A=function(t,e){if(!t._n){t._n=!0;var n=t._c;y(function(){for(var r=t._v,i=1==t._s,o=0;n.length>o;)!function(e){var n,o,s=i?e.ok:e.fail,a=e.resolve,u=e.reject,c=e.domain;try{s?(i||(2==t._h&&P(t),t._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&c.exit()),n===e.promise?u(m("Promise-chain cycle")):(o=E(n))?o.call(n,a,u):a(n)):u(r)}catch(t){u(t)}}(n[o++]);t._c=[],t._n=!1,e&&!t._h&&R(t)})}},R=function(t){_.call(a,function(){var e,n,r,i=t._v;if(j(t)&&(e=O(function(){w?g.emit("unhandledRejection",i,t):(n=a.onunhandledrejection)?n({promise:t,reason:i}):(r=a.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=w||j(t)?2:1),t._a=void 0,e)throw e.error})},j=function t(e){if(1==e._h)return!1;for(var n,r=e._a||e._c,i=0;r.length>i;)if(n=r[i++],n.fail||!t(n.promise))return!1;return!0},P=function(t){_.call(a,function(){var e;w?g.emit("rejectionHandled",t):(e=a.onrejectionhandled)&&e({promise:t,reason:t._v})})},I=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),A(e,!0))},F=function t(e){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw m("Promise can't be resolved itself");(n=E(e))?y(function(){var i={_w:r,_d:!1};try{n.call(e,u(t,i,1),u(I,i,1))}catch(t){I.call(i,t)}}):(r._v=e,r._s=1,A(r,!1))}catch(t){I.call({_w:r,_d:!1},t)}}};x||(b=function(t){d(this,b,"Promise","_h"),h(t),r.call(this);try{t(u(F,this,1),u(I,this,1))}catch(t){I.call(this,t)}},r=function(){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n("O6kh")(b.prototype,{then:function(t,e){var n=S(v(this,b));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=w?g.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&A(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),T=function(){var t=new r;this.promise=t,this.resolve=u(F,t,1),this.reject=u(I,t,1)}),l(l.G+l.W+l.F*!x,{Promise:b}),n("11Ut")(b,"Promise"),n("FGzK")("Promise"),o=n("zKeE").Promise,l(l.S+l.F*!x,"Promise",{reject:function(t){var e=S(this);return(0,e.reject)(t),e.promise}}),l(l.S+l.F*(s||!x),"Promise",{resolve:function(t){if(t instanceof b&&C(t.constructor,this))return t;var e=S(this);return(0,e.resolve)(t),e.promise}}),l(l.S+l.F*!(x&&n("Lli7")(function(t){b.all(t).catch(k)})),"Promise",{all:function(t){var e=this,n=S(e),r=n.resolve,i=n.reject,o=O(function(){var n=[],o=0,s=1;p(t,!1,function(t){var a=o++,u=!1;n.push(void 0),s++,e.resolve(t).then(function(t){u||(u=!0,n[a]=t,--s||r(n))},i)}),--s||r(n)});return o&&i(o.error),n.promise},race:function(t){var e=this,n=S(e),r=n.reject,i=O(function(){p(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i&&r(i.error),n.promise}})},"9kxq":function(t,e,n){var r=n("BxvP"),i=n("i1Q6").document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},"9u1Q":function(t,e,n){n("tuDi"),n("i+u+"),n("COf8"),n("9kJF"),t.exports=n("zKeE").Promise},AMYL:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("dACh"),o=r(i),s=n("jx4H"),a=r(s);Object.defineProperty(e,"__esModule",{value:!0});var u=n("luWe"),c=function(){function t(){(0,o.default)(this,t),this.cachedContinuationToken=null,this.myInstanceNumber=this.initializeInstanceId()}return(0,a.default)(t,[{key:"initializeInstanceId",value:function(){var e=function(){try{if(sessionStorage)return parseInt(sessionStorage.getItem("Twilio::RTD::EmsClient::InstanceId"))||0}catch(t){return 0}}();e>t.instancesCounter&&(t.instancesCounter=e);var n=t.instancesCounter++;try{sessionStorage&&(sessionStorage.setItem("Twilio::RTD::EmsClient::InstanceId",t.instancesCounter.toString()),window&&window.addEventListener("beforeunload",function(){sessionStorage.removeItem("Twilio::RTD::EmsClient::InstanceId")}))}catch(t){}return n}},{key:"shouldUsePersistentToken",get:function(){return 0===this.myInstanceNumber}},{key:"continuationToken",get:function(){if(this.cachedContinuationToken)return this.cachedContinuationToken;try{if(this.shouldUsePersistentToken&&sessionStorage)return this.cachedContinuationToken=sessionStorage.getItem("Twilio::RTD::EndpointId")}catch(t){u.default.info("Can't access persistent storage",t.message)}return null},set:function(t){this.cachedContinuationToken=t;try{this.shouldUsePersistentToken&&sessionStorage&&sessionStorage.setItem("Twilio::RTD::EndpointId",t)}catch(t){u.default.info("Can't access persistent storage",t.message)}}}]),t}();c.instancesCounter=0,e.PersistentState=c},Aa2f:function(t,e,n){"use strict";var r=n("i1Q6"),i=n("yS17"),o=n("6MLN"),s=n("vSO4"),a=n("gojl"),u=n("e8vu").KEY,c=n("wLcK"),l=n("NB7d"),f=n("11Ut"),h=n("X6va"),d=n("Ug9I"),p=n("ZxII"),v=n("c2zY"),_=n("pFSU"),y=n("ycyv"),m=n("ayXv"),g=n("zotD"),b=n("Wyka"),w=n("EKwp"),k=n("0WCH"),x=n("TNJq"),C=n("rMkZ"),E=n("sxPs"),S=n("Gfzd"),T=n("knrM"),O=E.f,A=S.f,R=C.f,j=r.Symbol,P=r.JSON,I=P&&P.stringify,F=d("_hidden"),M=d("toPrimitive"),L={}.propertyIsEnumerable,D=l("symbol-registry"),N=l("symbols"),U=l("op-symbols"),B=Object.prototype,q="function"==typeof j,z=r.QObject,H=!z||!z.prototype||!z.prototype.findChild,V=o&&c(function(){return 7!=x(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=O(B,e);r&&delete B[e],A(t,e,n),r&&t!==B&&A(B,e,r)}:A,W=function(t){var e=N[t]=x(j.prototype);return e._k=t,e},K=q&&"symbol"==typeof j.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof j},G=function(t,e,n){return t===B&&G(U,e,n),g(t),e=w(e,!0),g(n),i(N,e)?(n.enumerable?(i(t,F)&&t[F][e]&&(t[F][e]=!1),n=x(n,{enumerable:k(0,!1)})):(i(t,F)||A(t,F,k(1,{})),t[F][e]=!0),V(t,e,n)):A(t,e,n)},Q=function(t,e){g(t);for(var n,r=y(e=b(e)),i=0,o=r.length;o>i;)G(t,n=r[i++],e[n]);return t},Y=function(t,e){return void 0===e?x(t):Q(x(t),e)},X=function(t){var e=L.call(this,t=w(t,!0));return!(this===B&&i(N,t)&&!i(U,t))&&(!(e||!i(this,t)||!i(N,t)||i(this,F)&&this[F][t])||e)},J=function(t,e){if(t=b(t),e=w(e,!0),t!==B||!i(N,e)||i(U,e)){var n=O(t,e);return!n||!i(N,e)||i(t,F)&&t[F][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=R(b(t)),r=[],o=0;n.length>o;)i(N,e=n[o++])||e==F||e==u||r.push(e);return r},$=function(t){for(var e,n=t===B,r=R(n?U:b(t)),o=[],s=0;r.length>s;)!i(N,e=r[s++])||n&&!i(B,e)||o.push(N[e]);return o};q||(j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),e=function e(n){this===B&&e.call(U,n),i(this,F)&&i(this[F],t)&&(this[F][t]=!1),V(this,t,k(1,n))};return o&&H&&V(B,t,{configurable:!0,set:e}),W(t)},a(j.prototype,"toString",function(){return this._k}),E.f=J,S.f=G,n("Ni5N").f=C.f=Z,n("z7R8").f=X,n("Ocr3").f=$,o&&!n("1kq3")&&a(B,"propertyIsEnumerable",X,!0),p.f=function(t){return W(d(t))}),s(s.G+s.W+s.F*!q,{Symbol:j});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)d(tt[et++]);for(var tt=T(d.store),et=0;tt.length>et;)v(tt[et++]);s(s.S+s.F*!q,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=j(t)},keyFor:function(t){if(K(t))return _(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){H=!0},useSimple:function(){H=!1}}),s(s.S+s.F*!q,"Object",{create:Y,defineProperty:G,defineProperties:Q,getOwnPropertyDescriptor:J,getOwnPropertyNames:Z,getOwnPropertySymbols:$}),P&&s(s.S+s.F*(!q||c(function(){var t=j();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!K(t)){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);return e=r[1],"function"==typeof e&&(n=e),!n&&m(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!K(e))return e}),r[1]=e,I.apply(P,r)}}}),j.prototype[M]||n("akPY")(j.prototype,M,j.prototype.valueOf),f(j,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},AePr:function(t,e,n){"use strict";var r=n("Gfzd").f,i=n("TNJq"),o=n("O6kh"),s=n("3zRh"),a=n("KUik"),u=n("U72i"),c=n("ozpD"),l=n("uRfg"),f=n("xwD+"),h=n("FGzK"),d=n("6MLN"),p=n("e8vu").fastKey,v=d?"_s":"size",_=function(t,e){var n,r=p(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,l){var f=t(function(t,r){a(t,f,e,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=r&&c(r,n,t[l],t)});return o(f.prototype,{clear:function(){for(var t=this,e=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete e[n.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var e=this,n=_(e,t);if(n){var r=n.n,i=n.p;delete e._i[n.i],n.r=!0,i&&(i.n=r),r&&(r.p=i),e._f==n&&(e._f=r),e._l==n&&(e._l=i),e[v]--}return!!n},forEach:function(t){a(this,f,"forEach");for(var e,n=s(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.n:this._f;)for(n(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!_(this,t)}}),d&&r(f.prototype,"size",{get:function(){return u(this[v])}}),f},def:function(t,e,n){var r,i,o=_(t,e);return o?o.v=n:(t._l=o={i:i=p(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[v]++,"F"!==i&&(t._i[i]=o)),t},getEntry:_,setStrong:function(t,e,n){l(t,e,function(t,e){this._t=t,this._k=e,this._l=void 0},function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?"keys"==e?f(0,n.k):"values"==e?f(0,n.v):f(0,[n.k,n.v]):(t._t=void 0,f(1))},n?"entries":"values",!n,!0),h(e)}}},AgUv:function(t,e,n){function r(t){Error.call(this,t),this.message=t}function i(t){Error.call(this,t),this.message=t}var o=n("gfUn");o.inherits(r,Error),r.prototype.name="IllegalArgumentError",o.inherits(i,Error),i.prototype.name="IllegalStateError",t.exports.IllegalStateError=i,t.exports.IllegalArgumentError=r},"An/8":function(t,e,n){(function(){var e,r,i,o=function(t,e){return function(){return t.apply(e,arguments)}},s=[].slice;i=10,r=5,e=function(){function t(e,n,r,i,s){this.maxNb=null!=e?e:0,this.minTime=null!=n?n:0,this.highWater=null!=r?r:-1,this.strategy=null!=i?i:t.prototype.strategy.LEAK,this.rejectOnDrop=null!=s&&s,this.schedulePriority=o(this.schedulePriority,this),this.submitPriority=o(this.submitPriority,this),this.submit=o(this.submit,this),this._nextRequest=Date.now(),this._nbRunning=0,this._queues=this._makeQueues(),this._running={},this._nextIndex=0,this._unblockTime=0,this.penalty=15*this.minTime||5e3,this.interrupt=!1,this.reservoir=null,this.limiter=null,this.events={}}var e;return t.default=t,t.strategy=t.prototype.strategy={LEAK:1,OVERFLOW:2,OVERFLOW_PRIORITY:4,BLOCK:3},t.Cluster=t.prototype.Cluster=n("Cv+O"),t.DLList=t.prototype.DLList=n("Cp6S"),t.Promise=t.prototype.Promise=function(){try{return n("fp6q")}catch(t){return e=t,"undefined"!=typeof Promise&&null!==Promise?Promise:function(){throw new Error("Bottleneck: install 'bluebird' or use Node 0.12 or higher for Promise support")}}}(),t.prototype._trigger=function(t,e){return this.rejectOnDrop&&"dropped"===t&&e[0].cb.apply({},[new Error("This job has been dropped by Bottleneck")]),setTimeout(function(n){return function(){var r;return null!=(r=n.events[t])?r.forEach(function(t){return t.apply({},e)}):void 0}}(this),0)},t.prototype._makeQueues=function(){var e,n,r;for(r=[],e=1,n=i;1<=n?e<=n:e>=n;1<=n?++e:--e)r.push(new t.prototype.DLList);return r},t.prototype.chain=function(t){return this.limiter=t,this},t.prototype.isBlocked=function(){return this._unblockTime>=Date.now()},t.prototype._sanitizePriority=function(t){var e;return e=~~t!==t?r:t,e<0?0:e>i-1?i-1:e},t.prototype._find=function(t,e){var n,r,i,o;for(n=r=0,i=t.length;r<i;n=++r)if(o=t[n],e(o))return o;return[]},t.prototype.nbQueued=function(t){return null!=t?this._queues[this._sanitizePriority(t)].length:this._queues.reduce(function(t,e){return t+e.length},0)},t.prototype.nbRunning=function(){return this._nbRunning},t.prototype._getFirst=function(t){return this._find(t,function(t){return t.length>0})},t.prototype._conditionsCheck=function(){return(this.nbRunning()<this.maxNb||this.maxNb<=0)&&(null==this.reservoir||this.reservoir>0)},t.prototype.check=function(){return this._conditionsCheck()&&this._nextRequest-Date.now()<=0},t.prototype._tryToRun=function(){var t,e,n,r,i;return!!(this._conditionsCheck()&&(r=this.nbQueued())>0)&&(this._nbRunning++,null!=this.reservoir&&this.reservoir--,i=Math.max(this._nextRequest-Date.now(),0),this._nextRequest=Date.now()+i+this.minTime,n=this._getFirst(this._queues).shift(),1===r&&this._trigger("empty",[]),t=!1,e=this._nextIndex++,this._running[e]={timeout:setTimeout(function(r){return function(){var i;return i=function(){var i;if(!t&&(t=!0,delete r._running[e],r._nbRunning--,r._tryToRun(),0===r.nbRunning()&&0===r.nbQueued()&&r._trigger("idle",[]),!r.interrupt))return null!=(i=n.cb)?i.apply({},Array.prototype.slice.call(arguments,0)):void 0},null!=r.limiter?r.limiter.submit.apply(r.limiter,Array.prototype.concat(n.task,n.args,i)):n.task.apply({},n.args.concat(i))}}(this),i),job:n},!0)},t.prototype.submit=function(){var t;return t=1<=arguments.length?s.call(arguments,0):[],this.submitPriority.apply({},Array.prototype.concat(r,t))},t.prototype.submitPriority=function(){var e,n,r,i,o,a,u,c;return o=arguments[0],c=arguments[1],e=4<=arguments.length?s.call(arguments,2,r=arguments.length-1):(r=2,[]),n=arguments[r++],i={task:c,args:e,cb:n},o=this._sanitizePriority(o),a=this.highWater>=0&&this.nbQueued()===this.highWater&&!this.check(),this.strategy===t.prototype.strategy.BLOCK&&(a||this.isBlocked())?(this._unblockTime=Date.now()+this.penalty,this._nextRequest=this._unblockTime+this.minTime,this._queues=this._makeQueues(),this._trigger("dropped",[i]),!0):a&&(u=this.strategy===t.prototype.strategy.LEAK?this._getFirst(this._queues.slice(o).reverse()).shift():this.strategy===t.prototype.strategy.OVERFLOW_PRIORITY?this._getFirst(this._queues.slice(o+1).reverse()).shift():this.strategy===t.prototype.strategy.OVERFLOW?i:void 0,null!=u&&this._trigger("dropped",[u]),null==u||this.strategy===t.prototype.strategy.OVERFLOW)?a:(this._queues[o].push(i),this._tryToRun(),a)},t.prototype.schedule=function(){var t;return t=1<=arguments.length?s.call(arguments,0):[],this.schedulePriority.apply({},Array.prototype.concat(r,t))},t.prototype.schedulePriority=function(){var e,n,r,i;return n=arguments[0],r=arguments[1],e=3<=arguments.length?s.call(arguments,2):[],i=function(){var t,e,n;return t=2<=arguments.length?s.call(arguments,0,n=arguments.length-1):(n=0,[]),e=arguments[n++],r.apply({},t).then(function(){var t;return t=1<=arguments.length?s.call(arguments,0):[],e.apply({},Array.prototype.concat(null,t))}).catch(function(){var t;return t=1<=arguments.length?s.call(arguments,0):[],e.apply({},t)})},new t.prototype.Promise(function(t){return function(r,o){return t.submitPriority.apply({},Array.prototype.concat(n,i,e,function(){var t;return t=1<=arguments.length?s.call(arguments,0):[],(null!=t[0]?o:(t.shift(),r)).apply({},t)}))}}(this))},t.prototype.changeSettings=function(t,e,n,r,i){for(this.maxNb=null!=t?t:this.maxNb,this.minTime=null!=e?e:this.minTime,this.highWater=null!=n?n:this.highWater,this.strategy=null!=r?r:this.strategy,this.rejectOnDrop=null!=i?i:this.rejectOnDrop;this._tryToRun(););return this},t.prototype.changePenalty=function(t){return this.penalty=null!=t?t:this.penalty,this},t.prototype.changeReservoir=function(t){for(this.reservoir=t;this._tryToRun(););return this},t.prototype.incrementReservoir=function(t){return null==t&&(t=0),this.changeReservoir(this.reservoir+t),this},t.prototype.on=function(t,e){return null!=this.events[t]?this.events[t].push(e):this.events[t]=[e],this},t.prototype.removeAllListeners=function(t){return null==t&&(t=null),null!=t?delete this.events[t]:this.events={},this},t.prototype.stopAll=function(t){var e,n,r,i,o,a,u;for(this.interrupt=null!=t?t:this.interrupt,i=Object.keys(this._running),e=0,a=i.length;e<a;e++)r=i[e],clearTimeout(this._running[r].timeout);if(this._tryToRun=function(){},this.check=function(){return!1},this.submit=this.submitPriority=function(){var t;return 2<=arguments.length?s.call(arguments,0,t=arguments.length-1):(t=0,[]),(0,arguments[t++])(new Error("This limiter is stopped"))},this.schedule=this.schedulePriority=function(){return Promise.reject(new Error("This limiter is stopped"))},this.interrupt)for(o=0,u=i.length;o<u;o++)r=i[o],this._trigger("dropped",[this._running[r].job]);for(;n=this._getFirst(this._queues).shift();)this._trigger("dropped",[n]);return this._trigger("empty",[]),0===this.nbRunning()&&this._trigger("idle",[]),this},t}(),t.exports=e}).call(this)},Aq8W:function(t,e,n){t.exports={default:n("dXs8"),__esModule:!0}},AwcA:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("T4f3"),o=r(i),s=n("HxWs"),a=r(s),u=n("dACh"),c=r(u),l=n("jx4H"),f=r(l);Object.defineProperty(e,"__esModule",{value:!0}),e.SessionStorage=function(){function t(e,n){(0,c.default)(this,t),this.config=e,this.storageId=null;try{this.storage=n||sessionStorage}catch(t){}}return(0,f.default)(t,[{key:"storageKey",value:function(t,e){return this.storageId+"::"+t+"::"+e}},{key:"updateStorageId",value:function(t){this.storageId=t}},{key:"store",value:function(t,e,n){return this.isReady?this._store(this.storageKey(t,e),n):null}},{key:"read",value:function(t,e){return this.isReady?this._read(this.storageKey(t,e)):null}},{key:"remove",value:function(t,e,n){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(t,e)),n&&this.storage.removeItem(this.storageKey(t,n))}catch(t){}}},{key:"update",value:function(t,e,n,r){if(!this.isReady)return null;this._apply(this.storageKey(t,e),r),n&&this._apply(this.storageKey(t,n),r)}},{key:"_store",value:function(t,e){try{this.storage.setItem(t,(0,a.default)(e))}catch(t){}}},{key:"_read",value:function(t){try{var e=this.storage.getItem(t);if(e)return JSON.parse(e)}catch(t){}return null}},{key:"_apply",value:function(t,e){var n=this._read(t);if(!n)return!1;this._store(t,(0,o.default)(n,e))}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}}]),t}()},B1ls:function(t,e,n){var r=n("zotD"),i=n("g31e"),o=n("Ug9I")("species");t.exports=function(t,e){var n,s=r(t).constructor;return void 0===s||void 0==(n=r(s)[o])?e:i(n)}},B9Lq:function(t,e,n){var r=n("yS17"),i=n("Wyka"),o=n("LNnS")(!1),s=n("/wuY")("IE_PROTO");t.exports=function(t,e){var n,a=i(t),u=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;e.length>u;)r(a,n=e[u++])&&(~o(c,n)||c.push(n));return c}},"BX4+":function(t,e,n){t.exports={default:n("ky2m"),__esModule:!0}},BYJX:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=[];return t.forEach(function(t){return e.push(t)}),e}Object.defineProperty(e,"__esModule",{value:!0});var o=n("0Qy9"),s=r(o),a=n("7Zlx"),u=r(a),c=n("LlWG"),l=r(c),f=n("BX4+"),h=r(f),d=n("dACh"),p=r(d),v=n("jx4H"),_=r(v),y=n("VOrx"),m=r(y),g=n("ZKjc"),b=r(g),w=n("qQO4"),k=r(w),x=n("EwCr"),C=r(x),E=n("FRpO"),S=r(E),T=function(t){function e(t,n,r){(0,p.default)(this,e);var i=(0,m.default)(this,(e.__proto__||(0,h.default)(e)).call(this));return t.id=k.default.v4(),(0,l.default)(i,{_twilsock:{value:n},_messageTypes:{value:new u.default},config:{value:r},context:{value:t}}),n.on("stateChanged",function(t){"connected"!==t&&i.emit("transportReady",!1)}),n.on("registered",function(e){t&&e===t.id&&"connected"===n.state&&i.emit("transportReady",!0)}),i}return(0,b.default)(e,t),(0,_.default)(e,[{key:"setNotificationId",value:function(){return!1}},{key:"updateToken",value:function(){this._twilsock.removeNotificationsContext(this.context.id),this.context.id=k.default.v4(),this._updateContext()}},{key:"has",value:function(t){return this._messageTypes.has(t)}},{key:"subscribe",value:function(t){return this._messageTypes.has(t)?(C.default.trace("Message type already registered ",t),!1):(this._messageTypes.add(t),this._updateContext(),!0)}},{key:"unsubscribe",value:function(t){return!!this._messageTypes.has(t)&&(this._messageTypes.delete(t),this._messageTypes.size>0?this._updateContext():this._twilsock.removeNotificationsContext(this.context.id),!0)}},{key:"_updateContext",value:function(){if(this.config.token){var t=i(this._messageTypes),e={product_id:this.context.productId,notification_protocol_version:4,endpoint_platform:this.context.platform,ttl:172800,token:this.config.token,message_types:t};this.emit("transportReady",!1),this._twilsock.setNotificationsContext(this.context.id,e)}}}]),e}(S.default);e.default=T,(0,s.default)(T),t.exports=e.default},Bdru:function(t,e,n){var r=n("BxvP"),i=n("e8vu").onFreeze;n("cOHw")("freeze",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},BtHH:function(t,e,n){var r=n("mbLO"),i=n("HHE0");n("cOHw")("getPrototypeOf",function(){return function(t){return i(r(t))}})},BxvP:function(t){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},By4a:function(t,e,n){var r=n("ZHvQ"),i=n("Ug9I")("iterator"),o=n("dhak");t.exports=n("zKeE").isIterable=function(t){var e=Object(t);return void 0!==e[i]||"@@iterator"in e||o.hasOwnProperty(r(e))}},C6lX:function(t,e,n){function r(t){return void 0!==t&&null!==t}function i(t){if(t=t||{},r(t.initialDelay)&&t.initialDelay<1)throw new Error("The initial timeout must be greater than 0.");if(r(t.maxDelay)&&t.maxDelay<1)throw new Error("The maximal timeout must be greater than 0.");if(this.initialDelay_=t.initialDelay||100,(this.maxDelay_=t.maxDelay||1e4)<=this.initialDelay_)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");if(r(t.randomisationFactor)&&(t.randomisationFactor<0||t.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");this.randomisationFactor_=t.randomisationFactor||0}n("FRpO"),n("gfUn");i.prototype.getMaxDelay=function(){return this.maxDelay_},i.prototype.getInitialDelay=function(){return this.initialDelay_},i.prototype.next=function(){var t=this.next_(),e=1+Math.random()*this.randomisationFactor_;return Math.round(t*e)},i.prototype.next_=function(){throw new Error("BackoffStrategy.next_() unimplemented.")},i.prototype.reset=function(){this.reset_()},i.prototype.reset_=function(){throw new Error("BackoffStrategy.reset_() unimplemented.")},t.exports=i},COf8:function(t,e,n){n("OYXR");for(var r=n("i1Q6"),i=n("akPY"),o=n("dhak"),s=n("Ug9I")("toStringTag"),a=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var c=a[u],l=r[c],f=l&&l.prototype;f&&!f[s]&&i(f,s,c),o[c]=o.Array}},CjMg:function(t,e,n){"use strict";function r(){s.document("configuration").then(function(t){window.configurationDoc=t,i("configuration",t.value),window.configurationDoc.on("updated",function(t){i("configuration",t)})}),s.list("orderQueue").then(function(t){window.orderQueueList=t,o("orderQueue",window.orderQueueList),window.orderQueueList.on("itemAdded",function(){return o("orderQueue",window.orderQueueList)}),window.orderQueueList.on("itemRemoved",function(){return o("orderQueue",window.orderQueueList)}),window.orderQueueList.on("itemUpdated",function(){return o("orderQueue",window.orderQueueList)})}),s.list("allOrders").then(function(t){window.allOrdersList=t,o("allOrders",window.allOrdersList),window.allOrdersList.on("itemAdded",function(){return o("allOrders",window.allOrdersList)}),window.allOrdersList.on("itemRemoved",function(){return o("allOrders",window.allOrdersList)}),window.allOrdersList.on("itemUpdated",function(){return o("allOrders",window.allOrdersList)})}),s.map("customers").then(function(t){window.customersMap=t,o("customers",window.customersMap),window.customersMap.on("itemAdded",function(){return o("customers",window.customersMap)}),window.customersMap.on("itemRemoved",function(){return o("customers",window.customersMap)}),window.customersMap.on("itemUpdated",function(){return o("customers",window.customersMap)})})}function i(t,e){document.querySelector("#"+t).innerText=JSON.stringify(e,void 0,2)}function o(t,e){return e.getItems({pageSize:1e3}).then(function(e){i(t,e.items)})}Object.defineProperty(e,"__esModule",{value:!0});var s,a=n("dVxL");n.n(a);window.orderQueueList=void 0,window.configurationDoc=void 0,window.customersMap=void 0,window.allOrdersList=void 0,fetch("/api/token",{credentials:"include"}).then(function(t){return t.json()}).then(function(t){var e=t.token;return console.log(e),s=new a.SyncClient(e)}).then(function(){r()}).catch(function(t){return console.error(t)})},Cp6S:function(t){(function(){var e;e=function(){function t(){this._first=null,this._last=null,this.length=0}return t.prototype.push=function(t){var e;this.length++,e={value:t,next:null},null!=this._last?(this._last.next=e,this._last=e):this._first=this._last=e},t.prototype.shift=function(){var t,e;if(null!=this._first)return this.length--,e=this._first.value,this._first=null!=(t=this._first.next)?t:this._last=null,e},t.prototype.getArray=function(){var t,e,n;for(t=this._first,n=[];null!=t;)n.push((e=t,t=t.next,e.value));return n},t}(),t.exports=e}).call(this)},"Cv+O":function(t,e,n){(function(){var e,r={}.hasOwnProperty;e=function(){function t(t,e,r,i,o){this.maxNb=t,this.minTime=e,this.highWater=r,this.strategy=i,this.rejectOnDrop=o,this.limiters={},this.Bottleneck=n("An/8"),this.timeout=3e5,this.startAutoCleanup()}return t.prototype.key=function(t){var e;return null==t&&(t=""),null!=(e=this.limiters[t])?e:this.limiters[t]=new this.Bottleneck(this.maxNb,this.minTime,this.highWater,this.strategy,this.rejectOnDrop)},t.prototype.deleteKey=function(t){return null==t&&(t=""),delete this.limiters[t]},t.prototype.all=function(t){var e,n,i,o;n=this.limiters,i=[];for(e in n)r.call(n,e)&&(o=n[e],i.push(t(o)));return i},t.prototype.keys=function(){return Object.keys(this.limiters)},t.prototype.startAutoCleanup=function(){var t;return this.stopAutoCleanup(),"function"==typeof(t=this.interval=setInterval(function(t){return function(){var e,n,r,i,o;i=Date.now(),n=t.limiters,r=[];for(e in n)o=n[e],r.push(o._nextRequest+t.timeout<i?t.deleteKey(e):void 0);return r}}(this),this.timeout/10)).unref?t.unref():void 0},t.prototype.stopAutoCleanup=function(){return clearInterval(this.interval)},t.prototype.changeTimeout=function(t){return this.timeout=t,this.startAutoCleanup()},t}(),t.exports=e}).call(this)},Dygy:function(t,e,n){t.exports=n("g7Jl")},E07s:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("0Qy9"),o=r(i),s=n("YZrv"),a=r(s),u=n("LlWG"),c=r(u),l=n("BX4+"),f=r(l),h=n("dACh"),d=r(h),p=n("jx4H"),v=r(p),_=n("VOrx"),y=r(_),m=n("ZKjc"),g=r(m),b=n("FRpO"),w=r(b),k=n("LGMx"),x=r(k),C=n("BYJX"),E=r(C),S=function(t){function e(t,n,r,i){(0,d.default)(this,e);var o=(0,y.default)(this,(e.__proto__||(0,f.default)(e)).call(this));(0,c.default)(o,{_conf:{value:i},_connectors:{value:new a.default}});var s=o._detectPlatform();return o._connectors.set("twilsock",new E.default({productId:t,platform:s},r,i)),o._connectors.set("gcm",new x.default({productId:t,platform:s},n,i,"gcm")),o._connectors.set("fcm",new x.default({productId:t,platform:s},n,i,"fcm")),o._connectors.set("apn",new x.default({productId:t,platform:s},n,i,"apn")),o._connectors.get("twilsock").on("transportReady",function(t){return o.emit("transportReady",t)}),o}return(0,g.default)(e,t),(0,v.default)(e,[{key:"setNotificationId",value:function(t,e){this._connector(t).setNotificationId(e)}},{key:"hasSubscription",value:function(t,e){this._connector(e).has(t)}},{key:"subscribe",value:function(t,e){this._connector(e).subscribe(t)}},{key:"unsubscribe",value:function(t,e){this._connector(e).unsubscribe(t)}},{key:"updateToken",value:function(){this._connectors.forEach(function(t){return t.updateToken()})}},{key:"_connector",value:function(t){var e=this._connectors.get(t);if(!e)throw new Error("Unknown channel type: "+t);return e}},{key:"_detectPlatform",value:function(){var t="";return"undefined"!=typeof navigator?(t="unknown",void 0!==navigator.product&&(t=navigator.product),void 0!==navigator.userAgent&&(t=navigator.userAgent)):t="web",t.substring(0,128)}}]),e}(w.default);e.default=S,(0,o.default)(S),t.exports=e.default},E1ih:function(t,e,n){function r(t){i.EventEmitter.call(this),this.backoffStrategy_=t,this.maxNumberOfRetry_=-1,this.backoffNumber_=0,this.backoffDelay_=0,this.timeoutID_=-1,this.handlers={backoff:this.onBackoff_.bind(this)}}var i=n("FRpO"),o=n("Dygy");n("gfUn").inherits(r,i.EventEmitter),r.prototype.failAfter=function(t){o.checkArgument(t>0,"Expected a maximum number of retry greater than 0 but got %s.",t),this.maxNumberOfRetry_=t},r.prototype.backoff=function(t){o.checkState(-1===this.timeoutID_,"Backoff in progress."),this.backoffNumber_===this.maxNumberOfRetry_?(this.emit("fail",t),this.reset()):(this.backoffDelay_=this.backoffStrategy_.next(),this.timeoutID_=setTimeout(this.handlers.backoff,this.backoffDelay_),this.emit("backoff",this.backoffNumber_,this.backoffDelay_,t))},r.prototype.onBackoff_=function(){this.timeoutID_=-1,this.emit("ready",this.backoffNumber_,this.backoffDelay_),this.backoffNumber_++},r.prototype.reset=function(){this.backoffNumber_=0,this.backoffStrategy_.reset(),clearTimeout(this.timeoutID_),this.timeoutID_=-1},t.exports=r},E56Z:function(t,e,n){"use strict";function r(t,e){return[t].concat((0,o.default)(e))}var i=n("VuZO"),o=function(t){return t&&t.__esModule?t:{default:t}}(i);Object.defineProperty(e,"__esModule",{value:!0});var s=n("T51w");e.default={setLevel:function(t){s.setLevel(t)},trace:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.trace.apply(null,r("Sync T:",e))},debug:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.debug.apply(null,r("Sync D:",e))},info:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.info.apply(null,r("Sync I:",e))},warn:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.warn.apply(null,r("Sync W:",e))},error:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.error.apply(null,r("Sync E:",e))}}},E5Ce:function(t,e,n){var r=n("ShN9");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},EKwp:function(t,e,n){var r=n("BxvP");t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},EwCr:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){return[t].concat((0,s.default)(e))}Object.defineProperty(e,"__esModule",{value:!0});var o=n("VuZO"),s=r(o),a=n("T51w"),u=r(a);e.default={setLevel:function(t){u.default.setLevel(t)},trace:function(){u.default.trace.apply(null,i("Notify T:",arguments))},debug:function(){u.default.debug.apply(null,i("Notify D:",arguments))},info:function(){u.default.info.apply(null,i("Notify I:",arguments))},warn:function(){u.default.warn.apply(null,i("Notify W:",arguments))},error:function(){u.default.error.apply(null,i("Notify E:",arguments))}},t.exports=e.default},FFZn:function(t,e,n){t.exports={default:n("3v7p"),__esModule:!0}},FGzK:function(t,e,n){"use strict";var r=n("i1Q6"),i=n("zKeE"),o=n("Gfzd"),s=n("6MLN"),a=n("Ug9I")("species");t.exports=function(t){var e="function"==typeof i[t]?i[t]:r[t];s&&e&&!e[a]&&o.f(e,a,{configurable:!0,get:function(){return this}})}},FRpO:function(t){function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function r(t){return"number"==typeof t}function i(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(t){if(!r(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},e.prototype.emit=function(t){var e,r,s,a,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(r=this._events[t],o(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(i(r))for(a=Array.prototype.slice.call(arguments,1),c=r.slice(),s=c.length,u=0;u<s;u++)c[u].apply(this,a);return!0},e.prototype.addListener=function(t,r){var s;if(!n(r))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(r.listener)?r.listener:r),this._events[t]?i(this._events[t])?this._events[t].push(r):this._events[t]=[this._events[t],r]:this._events[t]=r,i(this._events[t])&&!this._events[t].warned&&(s=o(this._maxListeners)?e.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},e.prototype.removeListener=function(t,e){var r,o,s,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,o=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(r)){for(a=s;a-- >0;)if(r[a]===e||r[a].listener&&r[a].listener===e){o=a;break}if(o<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},e.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},e.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},e.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},e.listenerCount=function(t,e){return t.listenerCount(e)}},FshL:function(t,e,n){var r=n("vSO4");r(r.S+r.F*!n("6MLN"),"Object",{defineProperties:n("gjjs")})},GBRx:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("BX4+"),o=r(i),s=n("dACh"),a=r(s),u=n("jx4H"),c=r(u),l=n("VOrx"),f=r(l),h=n("ZKjc"),d=r(h);Object.defineProperty(e,"__esModule",{value:!0});var p=n("FRpO"),v=function(t){function e(t,n){(0,a.default)(this,e);var r=(0,f.default)(this,(e.__proto__||(0,o.default)(e)).call(this));return r.services=t,r.removalHandler=n,r}return(0,d.default)(e,t),(0,c.default)(e,[{key:"_advanceLastEventId",value:function(){}},{key:"reportFailure",value:function(t){404===t.status?this.onRemoved(!1):this.emit("failure",t)}},{key:"_subscribe",value:function(){return this.services.router.subscribe(this.sid,this),this}},{key:"_unsubscribe",value:function(){return this.services.router.unsubscribe(this.sid,this),this}},{key:"close",value:function(){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName)}}]),e}(p.EventEmitter);e.SyncEntity=v,e.default=v},Gfzd:function(t,e,n){var r=n("zotD"),i=n("R6c1"),o=n("EKwp"),s=Object.defineProperty;e.f=n("6MLN")?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},"GyB/":function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n("6t7t"),o=r(i),s=n("ibPW"),a=r(s),u="function"==typeof a.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof a.default&&t.constructor===a.default&&t!==a.default.prototype?"symbol":typeof t};e.default="function"==typeof a.default&&"symbol"===u(o.default)?function(t){return void 0===t?"undefined":u(t)}:function(t){return t&&"function"==typeof a.default&&t.constructor===a.default&&t!==a.default.prototype?"symbol":void 0===t?"undefined":u(t)}},H109:function(t,e,n){var r=n("i1Q6"),i=n("uzcO").set,o=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,u="process"==n("ShN9")(s);t.exports=function(){var t,e,n,c=function(){var r,i;for(u&&(r=s.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(u)n=function(){s.nextTick(c)};else if(o){var l=!0,f=document.createTextNode("");new o(c).observe(f,{characterData:!0}),n=function(){f.data=l=!l}}else if(a&&a.resolve){var h=a.resolve();n=function(){h.then(c)}}else n=function(){i.call(r,c)};return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},H3OR:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("TpZJ");e.default=function(t){return t&&t.__esModule?t:{default:t}}(r).default,t.exports=e.default},HHE0:function(t,e,n){var r=n("yS17"),i=n("mbLO"),o=n("/wuY")("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},HxWs:function(t,e,n){t.exports={default:n("Q17y"),__esModule:!0}},ID6i:function(t){t.exports=function(){}},JE0K:function(t,e,n){"use strict";function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t){var e=t.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(e){var n={protocol:e[1],host:e[2],hostname:e[3],port:e[4],pathname:e[5],search:e[6],hash:e[7]};if(n.search.length>0){n.params=n.search.substring(1).split("&").map(function(t){return t.split("=")}).reduce(function(t,e){return t.hasOwnProperty(e[0])?Array.isArray(t[e[0]])?t[e[0]].push(e[1]):t[e[0]]=[t[e[0]],e[1]]:t[e[0]]=e[1],t},{})}return n}throw new Error("Incorrect URI: "+t)}function s(t,e){var n=o(e),r={method:t,host:n.host,path:n.pathname};return n.params&&(r.params=n.params),r}function a(t,e,n,r){return{to:s(t,e),headers:n,body:r}}function u(t){return{status:t.status,headers:t.header.http_headers,body:t.body}}function c(t,e,n){return{url:t,headers:e,body:n}}function l(t){try{t.body=JSON.parse(t.body)}catch(t){}return t}function f(t){for(var e=Object.keys(t.headers),n=e.length,r={};n--;){var i=e[n];r[i.toLowerCase()]=t.headers[i]}return t.headers=r,t}Object.defineProperty(e,"__esModule",{value:!0}),e.TwilsockUnavailableError=e.Transport=void 0;var h=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),d=n("iSVM"),p=function(t){return t&&t.__esModule?t:{default:t}}(d),v=function(t){function e(){return r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return i(e,t),e}(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Error)),_=function(){function t(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.defineProperties(this,{_activeGetRequests:{value:new Map},_twilsock:{value:t},_http:{value:p.default},_twilsockIsAvailable:{get:function(){return e._twilsock&&e._twilsock.isConnected}},_concurrentHttpRequestLimit:{value:n.concurrentHttpRequestLimit||1/0},_concurrentHttpRequestCount:{value:0,writable:!0},_requestQueue:{value:[]}}),t&&(t.connect(),t.on("connected",function(){return e._processQueuedRequests()}))}return h(t,[{key:"get",value:function(t,e,n){var r=this;if(this._activeGetRequests.has(t))return this._activeGetRequests.get(t);var i=this._get(t,e,n).then(function(e){return r._activeGetRequests.delete(t),e}).catch(function(e){throw r._activeGetRequests.delete(t),e});return this._activeGetRequests.set(t,i),i}},{key:"_oneOfBasedOnChannelAvailability",value:function(t,e){var n=this;return function(r){var i=r.sendViaTwilsock,o=r.sendDirectHttp;return n._twilsockIsAvailable?i():e?Promise.reject(new v):n._concurrentHttpRequestCount>=n._concurrentHttpRequestLimit?new Promise(function(e,r){return n._requestQueue.push({sendingOptions:t,resolve:e,reject:r})}):(n._concurrentHttpRequestCount++,o().then(function(t){return n._concurrentHttpRequestCount--,n._processQueuedRequests(),t}).catch(function(t){throw n._concurrentHttpRequestCount--,n._processQueuedRequests(),t}))}(t).then(f)}},{key:"_processQueuedRequests",value:function(){for(;this._requestQueue.length>0&&(this._twilsockIsAvailable||this._concurrentHttpRequestCount<this._concurrentHttpRequestLimit);){var t=this._requestQueue.shift();this._oneOfBasedOnChannelAvailability(t.sendingOptions,!1).then(t.resolve).catch(t.reject)}}},{key:"_get",value:function(t,e,n){var r=this;return this._oneOfBasedOnChannelAvailability({sendViaTwilsock:function(){return r._twilsock.send(a("GET",t,e)).then(u)},sendDirectHttp:function(){return r._http.get(c(t,e)).then(l)}},n)}},{key:"post",value:function(t,e,n,r){var i=this;return this._oneOfBasedOnChannelAvailability({sendViaTwilsock:function(){return i._twilsock.send(a("POST",t,e,n)).then(u)},sendDirectHttp:function(){return i._http.post(c(t,e,n)).then(l)}},r)}},{key:"put",value:function(t,e,n,r){var i=this;return this._oneOfBasedOnChannelAvailability({sendViaTwilsock:function(){return i._twilsock.send(a("PUT",t,e,n)).then(u)},sendDirectHttp:function(){return i._http.put(c(t,e,n)).then(l)}},r)}},{key:"delete",value:function(t,e,n){var r=this;return this._oneOfBasedOnChannelAvailability({sendViaTwilsock:function(){return r._twilsock.send(a("DELETE",t,e)).then(u)},sendDirectHttp:function(){return r._http.delete(c(t,e)).then(l)}},n)}}]),t}();e.default=_,e.Transport=_,e.TwilsockUnavailableError=v},JWsA:function(t,e){var n,r;!function(){function i(t,e,n,r){return this instanceof i?(this.remainder=null,"string"==typeof t?a.call(this,t,e):void 0===e?s.call(this,t):void o.apply(this,arguments)):new i(t,e,n,r)}function o(t,e,n,r){return void 0===n?(this._a00=65535&t,this._a16=t>>>16,this._a32=65535&e,this._a48=e>>>16,this):(this._a00=0|t,this._a16=0|e,this._a32=0|n,this._a48=0|r,this)}function s(t){return this._a00=65535&t,this._a16=t>>>16,this._a32=0,this._a48=0,this}function a(t,e){e=e||10,this._a00=0,this._a16=0,this._a32=0,this._a48=0;for(var n=u[e]||new i(Math.pow(e,5)),r=0,o=t.length;r<o;r+=5){var s=Math.min(5,o-r),a=parseInt(t.slice(r,r+s),e);this.multiply(s<5?new i(Math.pow(e,s)):n).add(new i(a))}return this}var u={16:i(Math.pow(16,5)),10:i(Math.pow(10,5)),2:i(Math.pow(2,5))},c={16:i(16),10:i(10),2:i(2)};i.prototype.fromBits=o,i.prototype.fromNumber=s,i.prototype.fromString=a,i.prototype.toNumber=function(){return 65536*this._a16+this._a00},i.prototype.toString=function(t){t=t||10;var e=c[t]||new i(t);if(!this.gt(e))return this.toNumber().toString(t);for(var n=this.clone(),r=new Array(64),o=63;o>=0&&(n.div(e),r[o]=n.remainder.toNumber().toString(t),n.gt(e));o--);return r[o-1]=n.toNumber().toString(t),r.join("")},i.prototype.add=function(t){var e=this._a00+t._a00,n=e>>>16;n+=this._a16+t._a16;var r=n>>>16;r+=this._a32+t._a32;var i=r>>>16;return i+=this._a48+t._a48,this._a00=65535&e,this._a16=65535&n,this._a32=65535&r,this._a48=65535&i,this},i.prototype.subtract=function(t){return this.add(t.clone().negate())},i.prototype.multiply=function(t){var e=this._a00,n=this._a16,r=this._a32,i=this._a48,o=t._a00,s=t._a16,a=t._a32,u=t._a48,c=e*o,l=c>>>16;l+=e*s;var f=l>>>16;l&=65535,l+=n*o,f+=l>>>16,f+=e*a;var h=f>>>16;return f&=65535,f+=n*s,h+=f>>>16,f&=65535,f+=r*o,h+=f>>>16,h+=e*u,h&=65535,h+=n*a,h&=65535,h+=r*s,h&=65535,h+=i*o,this._a00=65535&c,this._a16=65535&l,this._a32=65535&f,this._a48=65535&h,this},i.prototype.div=function(t){if(0==t._a16&&0==t._a32&&0==t._a48){if(0==t._a00)throw Error("division by zero");if(1==t._a00)return this.remainder=new i(0),this}if(t.gt(this))return this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0,this;if(this.eq(t))return this.remainder=new i(0),this._a00=1,this._a16=0,this._a32=0,this._a48=0,this;for(var e=t.clone(),n=-1;!this.lt(e);)e.shiftLeft(1,!0),n++;for(this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0;n>=0;n--)e.shiftRight(1),this.remainder.lt(e)||(this.remainder.subtract(e),n>=48?this._a48|=1<<n-48:n>=32?this._a32|=1<<n-32:n>=16?this._a16|=1<<n-16:this._a00|=1<<n);return this},i.prototype.negate=function(){var t=1+(65535&~this._a00);return this._a00=65535&t,t=(65535&~this._a16)+(t>>>16),this._a16=65535&t,t=(65535&~this._a32)+(t>>>16),this._a32=65535&t,this._a48=~this._a48+(t>>>16)&65535,this},i.prototype.equals=i.prototype.eq=function(t){return this._a48==t._a48&&this._a00==t._a00&&this._a32==t._a32&&this._a16==t._a16},i.prototype.greaterThan=i.prototype.gt=function(t){return this._a48>t._a48||!(this._a48<t._a48)&&(this._a32>t._a32||!(this._a32<t._a32)&&(this._a16>t._a16||!(this._a16<t._a16)&&this._a00>t._a00))},i.prototype.lessThan=i.prototype.lt=function(t){return this._a48<t._a48||!(this._a48>t._a48)&&(this._a32<t._a32||!(this._a32>t._a32)&&(this._a16<t._a16||!(this._a16>t._a16)&&this._a00<t._a00))},i.prototype.or=function(t){return this._a00|=t._a00,this._a16|=t._a16,this._a32|=t._a32,this._a48|=t._a48,this},i.prototype.and=function(t){return this._a00&=t._a00,this._a16&=t._a16,this._a32&=t._a32,this._a48&=t._a48,this},i.prototype.xor=function(t){return this._a00^=t._a00,this._a16^=t._a16,this._a32^=t._a32,this._a48^=t._a48,this},i.prototype.not=function(){return this._a00=65535&~this._a00,this._a16=65535&~this._a16,this._a32=65535&~this._a32,this._a48=65535&~this._a48,this},i.prototype.shiftRight=i.prototype.shiftr=function(t){return t%=64,t>=48?(this._a00=this._a48>>t-48,this._a16=0,this._a32=0,this._a48=0):t>=32?(t-=32,this._a00=65535&(this._a32>>t|this._a48<<16-t),this._a16=this._a48>>t&65535,this._a32=0,this._a48=0):t>=16?(t-=16,this._a00=65535&(this._a16>>t|this._a32<<16-t),this._a16=65535&(this._a32>>t|this._a48<<16-t),this._a32=this._a48>>t&65535,this._a48=0):(this._a00=65535&(this._a00>>t|this._a16<<16-t),this._a16=65535&(this._a16>>t|this._a32<<16-t),this._a32=65535&(this._a32>>t|this._a48<<16-t),this._a48=this._a48>>t&65535),this},i.prototype.shiftLeft=i.prototype.shiftl=function(t,e){return t%=64,t>=48?(this._a48=this._a00<<t-48,this._a32=0,this._a16=0,this._a00=0):t>=32?(t-=32,this._a48=this._a16<<t|this._a00>>16-t,this._a32=this._a00<<t&65535,this._a16=0,this._a00=0):t>=16?(t-=16,this._a48=this._a32<<t|this._a16>>16-t,this._a32=65535&(this._a16<<t|this._a00>>16-t),this._a16=this._a00<<t&65535,this._a00=0):(this._a48=this._a48<<t|this._a32>>16-t,this._a32=65535&(this._a32<<t|this._a16>>16-t),this._a16=65535&(this._a16<<t|this._a00>>16-t),this._a00=this._a00<<t&65535),e||(this._a48&=65535),this},i.prototype.rotateLeft=i.prototype.rotl=function(t){if(0==(t%=64))return this;if(t>=32){var e=this._a00;if(this._a00=this._a32,this._a32=e,e=this._a48,this._a48=this._a16,this._a16=e,32==t)return this;t-=32}var n=this._a48<<16|this._a32,r=this._a16<<16|this._a00,i=n<<t|r>>>32-t,o=r<<t|n>>>32-t;return this._a00=65535&o,this._a16=o>>>16,this._a32=65535&i,this._a48=i>>>16,this},i.prototype.rotateRight=i.prototype.rotr=function(t){if(0==(t%=64))return this;if(t>=32){var e=this._a00;if(this._a00=this._a32,this._a32=e,e=this._a48,this._a48=this._a16,this._a16=e,32==t)return this;t-=32}var n=this._a48<<16|this._a32,r=this._a16<<16|this._a00,i=n>>>t|r<<32-t,o=r>>>t|n<<32-t;return this._a00=65535&o,this._a16=o>>>16,this._a32=65535&i,this._a48=i>>>16,this},i.prototype.clone=function(){return new i(this._a00,this._a16,this._a32,this._a48)},n=[],void 0!==(r=function(){return i}.apply(e,n))&&(t.exports=r)}()},Jb0q:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("YZrv"),o=r(i),s=n("dACh"),a=r(s),u=n("jx4H"),c=r(u);Object.defineProperty(e,"__esModule",{value:!0}),e.EntitiesCache=function(){function t(){(0,a.default)(this,t),this.names=new o.default,this.entities=new o.default}return(0,c.default)(t,[{key:"store",value:function(t){var e=this.entities.get(t.sid);return e||(this.entities.set(t.sid,t),t.uniqueName&&this.names.set(t.type+"::"+t.uniqueName,t.sid),t)}},{key:"getResolved",value:function(t,e){var n=this.names.get(e+"::"+t);return n?this.entities.get(n):null}},{key:"get",value:function(t,e){return this.entities.get(t)||this.getResolved(t,e)||null}},{key:"remove",value:function(t){var e=this.entities.get(t);e&&(this.entities.delete(t),e.uniqueName&&this.names.delete(e.type+"::"+e.uniqueName))}}]),t}()},JgNJ:function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=t[e+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+t[e+f],f+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+f>=1?h/u:h*Math.pow(2,1-f),e*u>=2&&(s++,u/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(e*u-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+d]=255&s,d+=p,s/=256,c-=8);t[n+d-p]|=128*v}},"K+F3":function(t,e,n){n("tuDi"),n("i+u+"),n("COf8"),n("SKjJ"),n("2SH0"),t.exports=n("zKeE").Map},KUik:function(t){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},KxjL:function(t){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},Ky5l:function(t,e,n){n("Aa2f"),n("tuDi"),n("c6mp"),n("2mwf"),t.exports=n("zKeE").Symbol},L3Vt:function(t,e,n){t.exports={default:n("9u1Q"),__esModule:!0}},LGMx:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=[];return t.forEach(function(t){return e.push(t)}),e}Object.defineProperty(e,"__esModule",{value:!0});var o=n("0Qy9"),s=r(o),a=n("L3Vt"),u=r(a),c=n("7Zlx"),l=r(c),f=n("LlWG"),h=r(f),d=n("BX4+"),p=r(d),v=n("dACh"),_=r(v),y=n("jx4H"),m=r(y),g=n("VOrx"),b=r(g),w=n("ZKjc"),k=r(w),x=n("FRpO"),C=r(x),E=n("EwCr"),S=r(E),T=n("uxiv"),O=r(T),A=n("PvFw"),R=r(A),j=function(t){function e(t,n,r,i){(0,_.default)(this,e);var o=(0,b.default)(this,(e.__proto__||(0,p.default)(e)).call(this)),s=O.default.create({initial:{state:"unregistered",event:"init",defer:!0},events:[{name:"userUpdate",from:["unregistered"],to:"registering"},{name:"userUpdate",from:["registered"],to:"unregistering"},{name:"registered",from:["registering","retrying"],to:"registered"},{name:"unregistered",from:["unregistering"],to:"unregistered"},{name:"retry",from:["retrying"],to:"retrying"},{name:"failure",from:["registering"],to:"retrying"},{name:"failure",from:["retrying"],to:"retrying"},{name:"failure",from:["unregistering"],to:"unregistered"}],callbacks:{onregistering:function(t,e,n,r){return o._register(r)},onunregistering:function(){return o._unregister()},onregistered:function(){return o._onRegistered()},onunregistered:function(){return o._onUnregistered()},onretrying:function(t,e,n,r){return o._initRetry(r)},onfailure:function(t,e,n,r){"retrying"===e&&o._initRetry(r)}}}),a=R.default.exponential({randomisationFactor:.2,initialDelay:2e3,maxDelay:12e4});return a.on("ready",function(){o._retry()}),(0,h.default)(o,{_transport:{value:n},_context:{value:t},_url:{value:r.registrarUri,writable:!1},_config:{value:r},_fsm:{value:s},_backoff:{value:a},_channelType:{value:i},_registrationId:{value:!1,writable:!0},_notificationId:{value:!1,writable:!0},_messageTypes:{value:new l.default,writable:!0},_pendingUpdate:{value:null,writable:!0}}),s.init(),o}return(0,k.default)(e,t),(0,m.default)(e,[{key:"setNotificationId",value:function(t){this._notificationId!==t&&(this._notificationId=t,this._updateRegistration())}},{key:"updateToken",value:function(){return this._updateRegistration()}},{key:"has",value:function(t){return this._messageTypes.has(t)}},{key:"subscribe",value:function(t){return this._messageTypes.has(t)?(S.default.debug("Message type already registered ",t),!1):(this._messageTypes.add(t),this._updateRegistration(),!0)}},{key:"unsubscribe",value:function(t){return!!this._messageTypes.has(t)&&(this._messageTypes.delete(t),this._messageTypes.size>0?this._updateRegistration():this._removeRegistration(),!0)}},{key:"_updateRegistration",value:function(){this._notificationId&&this._update(this._notificationId,i(this._messageTypes))}},{key:"_removeRegistration",value:function(){this._notificationId&&this._update(this._notificationId,i(this._messageTypes))}},{key:"_update",value:function(t,e){var n={notificationId:t,messageTypes:e};this._fsm.is("unregistered")?n.notificationId&&n.messageTypes.length>0&&this._fsm.userUpdate(n):this._fsm.is("registered")?(this._fsm.userUpdate(n),this._setPendingUpdate(n)):this._setPendingUpdate(n)}},{key:"_setPendingUpdate",value:function(t){this._pendingUpdate=t}},{key:"_checkPendingUpdate",value:function(){if(this._pendingUpdate){var t=this._pendingUpdate;this._pendingUpdate=null,this._updateRegistration(t.notificationId,t.messageTypes)}}},{key:"_initRetry",value:function(t){this._pendingUpdate||this._setPendingUpdate(t),this._backoff.backoff()}},{key:"_retry",value:function(){if(this._pendingUpdate){var t=this._pendingUpdate;this._pendingUpdate=null,this._register(t)}}},{key:"_onRegistered",value:function(){this._backoff.reset(),this.emit("stateChanged","registered"),this._checkPendingUpdate()}},{key:"_onUnregistered",value:function(){this._backoff.reset(),this.emit("stateChanged","unregistered"),this._checkPendingUpdate()}},{key:"_register",value:function(t){var e=this,n={endpoint_platform:this._context.platform,channel_type:this._channelType,version:"2",message_types:t.messageTypes,data:{},ttl:"PT24H"};"twilsock"===this._channelType?n.data.url=t.notificationId:n.data.registration_id=t.notificationId;var r=this._url+"?productId="+this._context.productId,i={"Content-Type":"application/json","X-Twilio-Token":this._config.token};return S.default.trace("Creating registration for channel ",this._channelType),this._transport.post(r,i,n).then(function(n){e._registrationId=n.body.id,e._registrationData=t,S.default.debug("Registration created: ",n),e._fsm.registered()}).catch(function(n){return S.default.error("Registration failed: ",n),e._fsm.failure(t),n})}},{key:"_unregister",value:function(){var t=this;if(!this._registrationId)return u.default.resolve();var e=this._url+"/"+this._registrationId+"?productId="+this._context.productId,n={"Content-Type":"application/json","X-Twilio-Token":this._config.token};return S.default.trace("Removing registration for ",this._channelType),this._transport.delete(e,n).then(function(){S.default.debug("Registration removed for ",t._channelType),t._registrationId=!1,t._fsm.unregistered()}).catch(function(e){return S.default.error("Failed to remove of registration ",t.channelType,e),t._fsm.failure(),e})}}]),e}(C.default);e.default=j,(0,s.default)(j),t.exports=e.default},LNnS:function(t,e,n){var r=n("Wyka"),i=n("S7IM"),o=n("N1kU");t.exports=function(t){return function(e,n,s){var a,u=r(e),c=i(u.length),l=o(s,c);if(t&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},LUBQ:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("aIIw"),o=r(i),s=n("BX4+"),a=r(s),u=n("jx4H"),c=r(u),l=n("VOrx"),f=r(l),h=n("ZKjc"),d=r(h),p=n("dACh"),v=r(p),_=n("L3Vt"),y=r(_),m=function(t,e,n,r){return new(n||(n=y.default))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var g=n("FRpO"),b=n("i/BB"),w=n("ZAcJ"),k=n("luWe"),x=n("AMYL"),C=n("JE0K"),E=function t(){(0,v.default)(this,t)},S=function(t){function e(t){(0,v.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,a.default)(e)).call(this));return t=t||{},t.transport=t.transport||new C.Transport(t.twilsockClient||null),n.state=new x.PersistentState,n.config=new w.default(t),n.twilsock=t.twilsockClient,n.transport=t.transport,n}return(0,d.default)(e,t),(0,c.default)(e,[{key:"setToken",value:function(t){return m(this,void 0,void 0,o.default.mark(function e(){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentFpaToken!==t&&(this.currentFpaToken=t,n=this.currentTokenRequest,this.currentTokenRequest=this.establishToken(t),this.notifyRejected(n)),e.abrupt("return",this.currentTokenRequest.promise);case 2:case"end":return e.stop()}},e,this)}))}},{key:"notifyRejected",value:function(t){t&&setTimeout(function(){return t.reject(new Error("Operation has been cancelled by next token"))},0)}},{key:"establishToken",value:function(t){var e=this,n=new E,r=new y.default(function(r,i){e.establishTokenImpl(t).then(r).catch(i),n.resolve=r,n.reject=i});return n.promise=r,n}},{key:"establishTokenImpl",value:function(t){return m(this,void 0,void 0,o.default.mark(function e(){var n=this;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new b.default({min:500,max:2e3}).run(function(){return n.requestRtdToken(t)}).then(function(e){if("ok"!=e.status)throw e.exception;if(n.currentFpaToken===t){n.state.continuationToken=e.response.continuation_token;var r=e.response.twilio_rtd_token;"NEW"===e.response.status.status?n.emit("tokenCreated",r):n.emit("tokenUpdated",r),n.emit("token",r);var i={token:e.response.twilio_rtd_token,ttl:e.response.ttl,status:e.response.status.status,reason:e.response.status.reason||null,identity:e.response.identity||null,accountSid:e.response.account_sid,serviceSids:e.response.instance_sids};return n.emit("response",i),i}}).catch(function(t){throw k.default.error(t),t}));case 1:case"end":return e.stop()}},e,this)}))}},{key:"requestRtdToken",value:function(t){return m(this,void 0,void 0,o.default.mark(function e(){var n,r,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={"Content-Type":"application/json"},r={fpa_token:t,continuation_token:this.state.continuationToken},k.default.debug("Token request",r),e.prev=3,e.next=6,this.transport.post(this.config.url,n,r);case 6:return i=e.sent,k.default.debug("Token response:",i),e.abrupt("return",{status:"ok",token:t,response:i.body});case 11:if(e.prev=11,e.t0=e.catch(3),401!==e.t0.status&&403!==e.t0.status){e.next=16;break}return e.t0 instanceof Error||(e.t0.body?e.t0=new Error(e.t0.body.message):e.t0.description&&(e.t0=new Error(e.t0.description))),e.abrupt("return",{status:"denied",exception:e.t0,token:null,response:null});case 16:throw e.t0;case 17:case"end":return e.stop()}},e,this,[[3,11]])}))}}]),e}(g.EventEmitter);e.EmsClient=S;var T=S;e.EMSClient=T,e.default=T},LlWG:function(t,e,n){t.exports={default:n("tvE3"),__esModule:!0}},Lli7:function(t,e,n){var r=n("Ug9I")("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},t(o)}catch(t){}return n}},Lvd3:function(t,e,n){n("COf8"),n("i+u+"),t.exports=n("ugM7")},MpYs:function(t){var e=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:e)(t)}},N1kU:function(t,e,n){var r=n("MpYs"),i=Math.max,o=Math.min;t.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},N484:function(t,e,n){"use strict";var r=n("3zRh"),i=n("vSO4"),o=n("mbLO"),s=n("hEIm"),a=n("af0K"),u=n("S7IM"),c=n("vUQk"),l=n("7AqT");i(i.S+i.F*!n("Lli7")(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,f,h=o(t),d="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,_=void 0!==v,y=0,m=l(h);if(_&&(v=r(v,p>2?arguments[2]:void 0,2)),void 0==m||d==Array&&a(m))for(e=u(h.length),n=new d(e);e>y;y++)c(n,y,_?v(h[y],y):h[y]);else for(f=m.call(h),n=new d;!(i=f.next()).done;y++)c(n,y,_?s(f,v,[i.value,y],!0):i.value);return n.length=y,n}})},NB7d:function(t,e,n){var r=n("i1Q6"),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});t.exports=function(t){return i[t]||(i[t]={})}},NQ19:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("aIIw"),o=r(i),s=n("dACh"),a=r(s),u=n("jx4H"),c=r(u),l=n("L3Vt"),f=r(l),h=function(t,e,n,r){return new(n||(n=f.default))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var d=function(){function t(e,n,r,i){(0,a.default)(this,t),this.prevToken=r,this.nextToken=i,this.items=e,this.source=n}return(0,c.default)(t,[{key:"nextPage",value:function(){return h(this,void 0,void 0,o.default.mark(function t(){return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.hasNextPage){t.next=2;break}throw new Error("No next page");case 2:return t.abrupt("return",this.source(this.nextToken));case 3:case"end":return t.stop()}},t,this)}))}},{key:"prevPage",value:function(){return h(this,void 0,void 0,o.default.mark(function t(){return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.hasPrevPage){t.next=2;break}throw new Error("No previous page");case 2:return t.abrupt("return",this.source(this.prevToken));case 3:case"end":return t.stop()}},t,this)}))}},{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}}]),t}();e.Paginator=d,e.default=d},"Nf0/":function(t,e,n){(function(e){function r(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t.charCodeAt(n);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(n++,i=65536+((1023&i)<<10|1023&t.charCodeAt(n)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return new Uint8Array(e)}function i(){return 2==arguments.length?new i(arguments[1]).update(arguments[0]).digest():this instanceof i?void o.call(this,arguments[0]):new i(arguments[0])}function o(t){return this.seed=t instanceof s?t.clone():s(t),this.v1=this.seed.clone().add(a).add(u),this.v2=this.seed.clone().add(u),this.v3=this.seed.clone(),this.v4=this.seed.clone().subtract(a),this.total_len=0,this.memsize=0,this.memory=null,this}var s=n("P5jY").UINT32;s.prototype.xxh_update=function(t,e){var n,r,i=u._low,o=u._high;r=t*i,n=r>>>16,n+=e*i,n&=65535,n+=t*o;var s=this._low+(65535&r),c=s>>>16;c+=this._high+(65535&n);var l=c<<16|65535&s;l=l<<13|l>>>19,s=65535&l,c=l>>>16,i=a._low,o=a._high,r=s*i,n=r>>>16,n+=c*i,n&=65535,n+=s*o,this._low=65535&r,this._high=65535&n};var a=s("2654435761"),u=s("2246822519"),c=s("3266489917"),l=s("668265263"),f=s("374761393");i.prototype.init=o,i.prototype.update=function(t){var n,i="string"==typeof t;i&&(t=r(t),i=!1,n=!0),"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&(n=!0,t=new Uint8Array(t));var o=0,s=t.length,a=o+s;if(0==s)return this;if(this.total_len+=s,0==this.memsize&&(this.memory=i?"":n?new Uint8Array(16):new e(16)),this.memsize+s<16)return i?this.memory+=t:n?this.memory.set(t.subarray(0,s),this.memsize):t.copy(this.memory,this.memsize,0,s),this.memsize+=s,this;if(this.memsize>0){i?this.memory+=t.slice(0,16-this.memsize):n?this.memory.set(t.subarray(0,16-this.memsize),this.memsize):t.copy(this.memory,this.memsize,0,16-this.memsize);var u=0;i?(this.v1.xxh_update(this.memory.charCodeAt(u+1)<<8|this.memory.charCodeAt(u),this.memory.charCodeAt(u+3)<<8|this.memory.charCodeAt(u+2)),u+=4,this.v2.xxh_update(this.memory.charCodeAt(u+1)<<8|this.memory.charCodeAt(u),this.memory.charCodeAt(u+3)<<8|this.memory.charCodeAt(u+2)),u+=4,this.v3.xxh_update(this.memory.charCodeAt(u+1)<<8|this.memory.charCodeAt(u),this.memory.charCodeAt(u+3)<<8|this.memory.charCodeAt(u+2)),u+=4,this.v4.xxh_update(this.memory.charCodeAt(u+1)<<8|this.memory.charCodeAt(u),this.memory.charCodeAt(u+3)<<8|this.memory.charCodeAt(u+2))):(this.v1.xxh_update(this.memory[u+1]<<8|this.memory[u],this.memory[u+3]<<8|this.memory[u+2]),u+=4,this.v2.xxh_update(this.memory[u+1]<<8|this.memory[u],this.memory[u+3]<<8|this.memory[u+2]),u+=4,this.v3.xxh_update(this.memory[u+1]<<8|this.memory[u],this.memory[u+3]<<8|this.memory[u+2]),u+=4,this.v4.xxh_update(this.memory[u+1]<<8|this.memory[u],this.memory[u+3]<<8|this.memory[u+2])),o+=16-this.memsize,this.memsize=0,i&&(this.memory="")}if(o<=a-16){var c=a-16;do{i?(this.v1.xxh_update(t.charCodeAt(o+1)<<8|t.charCodeAt(o),t.charCodeAt(o+3)<<8|t.charCodeAt(o+2)),o+=4,this.v2.xxh_update(t.charCodeAt(o+1)<<8|t.charCodeAt(o),t.charCodeAt(o+3)<<8|t.charCodeAt(o+2)),o+=4,this.v3.xxh_update(t.charCodeAt(o+1)<<8|t.charCodeAt(o),t.charCodeAt(o+3)<<8|t.charCodeAt(o+2)),o+=4,this.v4.xxh_update(t.charCodeAt(o+1)<<8|t.charCodeAt(o),t.charCodeAt(o+3)<<8|t.charCodeAt(o+2))):(this.v1.xxh_update(t[o+1]<<8|t[o],t[o+3]<<8|t[o+2]),o+=4,this.v2.xxh_update(t[o+1]<<8|t[o],t[o+3]<<8|t[o+2]),o+=4,this.v3.xxh_update(t[o+1]<<8|t[o],t[o+3]<<8|t[o+2]),o+=4,this.v4.xxh_update(t[o+1]<<8|t[o],t[o+3]<<8|t[o+2])),o+=4}while(o<=c)}return o<a&&(i?this.memory+=t.slice(o):n?this.memory.set(t.subarray(o,a),this.memsize):t.copy(this.memory,this.memsize,o,a),this.memsize=a-o),this},i.prototype.digest=function(){var t,e,n=this.memory,r="string"==typeof n,i=0,o=this.memsize,h=new s;for(t=this.total_len>=16?this.v1.rotl(1).add(this.v2.rotl(7).add(this.v3.rotl(12).add(this.v4.rotl(18)))):this.seed.clone().add(f),t.add(h.fromNumber(this.total_len));i<=o-4;)r?h.fromBits(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2)):h.fromBits(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2]),t.add(h.multiply(c)).rotl(17).multiply(l),i+=4;for(;i<o;)h.fromBits(r?n.charCodeAt(i++):n[i++],0),t.add(h.multiply(f)).rotl(11).multiply(a);return e=t.clone().shiftRight(15),t.xor(e).multiply(u),e=t.clone().shiftRight(13),t.xor(e).multiply(c),e=t.clone().shiftRight(16),t.xor(e),this.init(this.seed),t},t.exports=i}).call(e,n("peL6").Buffer)},Ni5N:function(t,e,n){var r=n("B9Lq"),i=n("KxjL").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},O35A:function(t,e,n){n("i+u+"),n("N484"),t.exports=n("zKeE").Array.from},O6kh:function(t,e,n){var r=n("akPY");t.exports=function(t,e,n){for(var i in e)n&&t[i]?t[i]=e[i]:r(t,i,e[i]);return t}},OFjk:function(t,e,n){(function(e){function r(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t.charCodeAt(n);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(n++,i=65536+((1023&i)<<10|1023&t.charCodeAt(n)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return new Uint8Array(e)}function i(){return 2==arguments.length?new i(arguments[1]).update(arguments[0]).digest():this instanceof i?void o.call(this,arguments[0]):new i(arguments[0])}function o(t){return this.seed=t instanceof s?t.clone():s(t),this.v1=this.seed.clone().add(a).add(u),this.v2=this.seed.clone().add(u),this.v3=this.seed.clone(),this.v4=this.seed.clone().subtract(a),this.total_len=0,this.memsize=0,this.memory=null,this}var s=n("P5jY").UINT64,a=s("11400714785074694791"),u=s("14029467366897019727"),c=s("1609587929392839161"),l=s("9650029242287828579"),f=s("2870177450012600261");i.prototype.init=o,i.prototype.update=function(t){var n,i="string"==typeof t;i&&(t=r(t),i=!1,n=!0),"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&(n=!0,t=new Uint8Array(t));var o=0,c=t.length,l=o+c;if(0==c)return this;if(this.total_len+=c,0==this.memsize&&(this.memory=i?"":n?new Uint8Array(32):new e(32)),this.memsize+c<32)return i?this.memory+=t:n?this.memory.set(t.subarray(0,c),this.memsize):t.copy(this.memory,this.memsize,0,c),this.memsize+=c,this;if(this.memsize>0){i?this.memory+=t.slice(0,32-this.memsize):n?this.memory.set(t.subarray(0,32-this.memsize),this.memsize):t.copy(this.memory,this.memsize,0,32-this.memsize);var f=0;if(i){var h;h=s(this.memory.charCodeAt(f+1)<<8|this.memory.charCodeAt(f),this.memory.charCodeAt(f+3)<<8|this.memory.charCodeAt(f+2),this.memory.charCodeAt(f+5)<<8|this.memory.charCodeAt(f+4),this.memory.charCodeAt(f+7)<<8|this.memory.charCodeAt(f+6)),this.v1.add(h.multiply(u)).rotl(31).multiply(a),f+=8,h=s(this.memory.charCodeAt(f+1)<<8|this.memory.charCodeAt(f),this.memory.charCodeAt(f+3)<<8|this.memory.charCodeAt(f+2),this.memory.charCodeAt(f+5)<<8|this.memory.charCodeAt(f+4),this.memory.charCodeAt(f+7)<<8|this.memory.charCodeAt(f+6)),this.v2.add(h.multiply(u)).rotl(31).multiply(a),f+=8,h=s(this.memory.charCodeAt(f+1)<<8|this.memory.charCodeAt(f),this.memory.charCodeAt(f+3)<<8|this.memory.charCodeAt(f+2),this.memory.charCodeAt(f+5)<<8|this.memory.charCodeAt(f+4),this.memory.charCodeAt(f+7)<<8|this.memory.charCodeAt(f+6)),this.v3.add(h.multiply(u)).rotl(31).multiply(a),f+=8,h=s(this.memory.charCodeAt(f+1)<<8|this.memory.charCodeAt(f),this.memory.charCodeAt(f+3)<<8|this.memory.charCodeAt(f+2),this.memory.charCodeAt(f+5)<<8|this.memory.charCodeAt(f+4),this.memory.charCodeAt(f+7)<<8|this.memory.charCodeAt(f+6)),this.v4.add(h.multiply(u)).rotl(31).multiply(a)}else{var h;h=s(this.memory[f+1]<<8|this.memory[f],this.memory[f+3]<<8|this.memory[f+2],this.memory[f+5]<<8|this.memory[f+4],this.memory[f+7]<<8|this.memory[f+6]),this.v1.add(h.multiply(u)).rotl(31).multiply(a),f+=8,h=s(this.memory[f+1]<<8|this.memory[f],this.memory[f+3]<<8|this.memory[f+2],this.memory[f+5]<<8|this.memory[f+4],this.memory[f+7]<<8|this.memory[f+6]),this.v2.add(h.multiply(u)).rotl(31).multiply(a),f+=8,h=s(this.memory[f+1]<<8|this.memory[f],this.memory[f+3]<<8|this.memory[f+2],this.memory[f+5]<<8|this.memory[f+4],this.memory[f+7]<<8|this.memory[f+6]),this.v3.add(h.multiply(u)).rotl(31).multiply(a),f+=8,h=s(this.memory[f+1]<<8|this.memory[f],this.memory[f+3]<<8|this.memory[f+2],this.memory[f+5]<<8|this.memory[f+4],this.memory[f+7]<<8|this.memory[f+6]),this.v4.add(h.multiply(u)).rotl(31).multiply(a)}o+=32-this.memsize,this.memsize=0,i&&(this.memory="")}if(o<=l-32){var d=l-32;do{if(i){var h;h=s(t.charCodeAt(o+1)<<8|t.charCodeAt(o),t.charCodeAt(o+3)<<8|t.charCodeAt(o+2),t.charCodeAt(o+5)<<8|t.charCodeAt(o+4),t.charCodeAt(o+7)<<8|t.charCodeAt(o+6)),this.v1.add(h.multiply(u)).rotl(31).multiply(a),o+=8,h=s(t.charCodeAt(o+1)<<8|t.charCodeAt(o),t.charCodeAt(o+3)<<8|t.charCodeAt(o+2),t.charCodeAt(o+5)<<8|t.charCodeAt(o+4),t.charCodeAt(o+7)<<8|t.charCodeAt(o+6)),this.v2.add(h.multiply(u)).rotl(31).multiply(a),o+=8,h=s(t.charCodeAt(o+1)<<8|t.charCodeAt(o),t.charCodeAt(o+3)<<8|t.charCodeAt(o+2),t.charCodeAt(o+5)<<8|t.charCodeAt(o+4),t.charCodeAt(o+7)<<8|t.charCodeAt(o+6)),this.v3.add(h.multiply(u)).rotl(31).multiply(a),o+=8,h=s(t.charCodeAt(o+1)<<8|t.charCodeAt(o),t.charCodeAt(o+3)<<8|t.charCodeAt(o+2),t.charCodeAt(o+5)<<8|t.charCodeAt(o+4),t.charCodeAt(o+7)<<8|t.charCodeAt(o+6)),this.v4.add(h.multiply(u)).rotl(31).multiply(a)}else{var h;h=s(t[o+1]<<8|t[o],t[o+3]<<8|t[o+2],t[o+5]<<8|t[o+4],t[o+7]<<8|t[o+6]),this.v1.add(h.multiply(u)).rotl(31).multiply(a),o+=8,h=s(t[o+1]<<8|t[o],t[o+3]<<8|t[o+2],t[o+5]<<8|t[o+4],t[o+7]<<8|t[o+6]),this.v2.add(h.multiply(u)).rotl(31).multiply(a),o+=8,h=s(t[o+1]<<8|t[o],t[o+3]<<8|t[o+2],t[o+5]<<8|t[o+4],t[o+7]<<8|t[o+6]),this.v3.add(h.multiply(u)).rotl(31).multiply(a),o+=8,h=s(t[o+1]<<8|t[o],t[o+3]<<8|t[o+2],t[o+5]<<8|t[o+4],t[o+7]<<8|t[o+6]),this.v4.add(h.multiply(u)).rotl(31).multiply(a)}o+=8}while(o<=d)}return o<l&&(i?this.memory+=t.slice(o):n?this.memory.set(t.subarray(o,l),this.memsize):t.copy(this.memory,this.memsize,o,l),this.memsize=l-o),this},i.prototype.digest=function(){var t,e,n=this.memory,r="string"==typeof n,i=0,o=this.memsize,h=new s;for(this.total_len>=32?(t=this.v1.clone().rotl(1),t.add(this.v2.clone().rotl(7)),t.add(this.v3.clone().rotl(12)),t.add(this.v4.clone().rotl(18)),t.xor(this.v1.multiply(u).rotl(31).multiply(a)),t.multiply(a).add(l),t.xor(this.v2.multiply(u).rotl(31).multiply(a)),t.multiply(a).add(l),t.xor(this.v3.multiply(u).rotl(31).multiply(a)),t.multiply(a).add(l),t.xor(this.v4.multiply(u).rotl(31).multiply(a)),t.multiply(a).add(l)):t=this.seed.clone().add(f),t.add(h.fromNumber(this.total_len));i<=o-8;)r?h.fromBits(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2),n.charCodeAt(i+5)<<8|n.charCodeAt(i+4),n.charCodeAt(i+7)<<8|n.charCodeAt(i+6)):h.fromBits(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2],n[i+5]<<8|n[i+4],n[i+7]<<8|n[i+6]),h.multiply(u).rotl(31).multiply(a),t.xor(h).rotl(27).multiply(a).add(l),i+=8;for(i+4<=o&&(r?h.fromBits(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2),0,0):h.fromBits(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2],0,0),t.xor(h.multiply(a)).rotl(23).multiply(u).add(c),i+=4);i<o;)h.fromBits(r?n.charCodeAt(i++):n[i++],0,0,0),t.xor(h.multiply(f)).rotl(11).multiply(a);return e=t.clone().shiftRight(33),t.xor(e).multiply(u),e=t.clone().shiftRight(29),t.xor(e).multiply(c),e=t.clone().shiftRight(32),t.xor(e),this.init(this.seed),t},t.exports=i}).call(e,n("peL6").Buffer)},OLak:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("aIIw"),o=r(i),s=n("dACh"),a=r(s),u=n("jx4H"),c=r(u),l=n("L3Vt"),f=r(l),h=function(t,e,n,r){return new(n||(n=f.default))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var d=n("E56Z"),p="com.twilio.rtd.cds.document",v="com.twilio.rtd.cds.list",_="com.twilio.rtd.cds.map",y="twilio.sync.event",m=function(){function t(e){var n=this;(0,a.default)(this,t),this.config=e.config,this.subscriptions=e.subscriptions,this.notifications=e.notifications,this.notifications.subscribe(y),this.notifications.subscribe(p),this.notifications.subscribe(v),this.notifications.subscribe(_),this.notifications.on("message",function(t,e){return n.onMessage(t,e)}),this.notifications.on("transportReady",function(t){return n.onConnectionStateChanged(t)})}return(0,c.default)(t,[{key:"onMessage",value:function(t,e){switch(d.default.trace("Notification type:",t,"content:",e),t){case p:case v:case _:this.subscriptions.acceptMessage(e,!1);break;case y:this.subscriptions.acceptMessage(e,!0)}}},{key:"subscribe",value:function(t,e){return h(this,void 0,void 0,o.default.mark(function n(){return o.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.subscriptions.add(t,e);case 2:case"end":return n.stop()}},n,this)}))}},{key:"unsubscribe",value:function(t){return h(this,void 0,void 0,o.default.mark(function e(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.subscriptions.remove(t);case 2:case"end":return e.stop()}},e,this)}))}},{key:"onConnectionStateChanged",value:function(t){this.subscriptions.onConnectionStateChanged(t)}}]),t}();e.Router=m,e.default=m},OYXR:function(t,e,n){"use strict";var r=n("ID6i"),i=n("xwD+"),o=n("dhak"),s=n("Wyka");t.exports=n("uRfg")(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):"keys"==e?i(0,n):"values"==e?i(0,t[n]):i(0,[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},Ocr3:function(t,e){e.f=Object.getOwnPropertySymbols},P5jY:function(t,e,n){e.UINT32=n("mc9D"),e.UINT64=n("JWsA")},PD3G:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return JSON.parse((0,l.default)(t))}var o=n("dACh"),s=r(o),a=n("jx4H"),u=r(a),c=n("HxWs"),l=r(c);Object.defineProperty(e,"__esModule",{value:!0}),e.deepClone=i,e.UriBuilder=function(){function t(e){(0,s.default)(this,t),this.base=e,this.args=new Array,this.paths=new Array}return(0,u.default)(t,[{key:"pathSegment",value:function(t){return this.paths.push(encodeURIComponent(t)),this}},{key:"queryParam",value:function(t,e){return void 0!==e&&this.args.push(encodeURIComponent(t)+"="+encodeURIComponent(e)),this}},{key:"build",value:function(){var t=this.base;return this.paths.length&&(t+="/"+this.paths.join("/")),this.args.length&&(t+="?"+this.args.join("&")),t}}]),t}()},PvFw:function(t,e,n){var r=n("E1ih"),i=n("b1KJ"),o=n("XdV9"),s=n("V5Fu");t.exports.Backoff=r,t.exports.FunctionCall=s,t.exports.FibonacciStrategy=o,t.exports.ExponentialStrategy=i,t.exports.fibonacci=function(t){return new r(new o(t))},t.exports.exponential=function(t){return new r(new i(t))},t.exports.call=function(t,e,n){var r=Array.prototype.slice.call(arguments);return t=r[0],e=r.slice(1,r.length-1),n=r[r.length-1],new s(t,e,n)}},Q17y:function(t,e,n){var r=n("zKeE"),i=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(){return i.stringify.apply(i,arguments)}},QVnC:function(t,e,n){(function(e){!function(e){"use strict";function n(t,e,n,r){var o=e&&e.prototype instanceof i?e:i,s=Object.create(o.prototype);return s._invoke=c(t,n,new d(r||[])),s}function r(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function i(){}function o(){}function s(){}function a(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function u(t){function n(e,i,o,s){var a=r(t[e],t,i);if("throw"!==a.type){var u=a.arg,c=u.value;return c&&"object"==typeof c&&m.call(c,"__await")?Promise.resolve(c.__await).then(function(t){n("next",t,o,s)},function(t){n("throw",t,o,s)}):Promise.resolve(c).then(function(t){u.value=t,o(u)},s)}s(a.arg)}function i(t,e){function r(){return new Promise(function(r,i){n(t,e,r,i)})}return o=o?o.then(r,r):r()}"object"==typeof e.process&&e.process.domain&&(n=e.process.domain.bind(n));var o;this._invoke=i}function c(t,e,n){var i=E;return function(o,s){if(i===T)throw new Error("Generator is already running");if(i===O){if("throw"===o)throw s;return v()}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var u=l(a,n);if(u){if(u===A)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===E)throw i=O,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=T;var c=r(t,e,n);if("normal"===c.type){if(i=n.done?O:S,c.arg===A)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=O,n.method="throw",n.arg=c.arg)}}}function l(t,e){var n=t.iterator[e.method];if(n===_){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=_,l(t,e),"throw"===e.method))return A;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var i=r(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,A;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=_),e.delegate=null,A):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,A)}function f(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function h(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(f,this),this.reset(!0)}function p(t){if(t){var e=t[b];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(m.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=_,e.done=!0,e};return r.next=r}}return{next:v}}function v(){return{value:_,done:!0}}var _,y=Object.prototype,m=y.hasOwnProperty,g="function"==typeof Symbol?Symbol:{},b=g.iterator||"@@iterator",w=g.asyncIterator||"@@asyncIterator",k=g.toStringTag||"@@toStringTag",x="object"==typeof t,C=e.regeneratorRuntime;if(C)return void(x&&(t.exports=C));C=e.regeneratorRuntime=x?t.exports:{},C.wrap=n;var E="suspendedStart",S="suspendedYield",T="executing",O="completed",A={},R={};R[b]=function(){return this};var j=Object.getPrototypeOf,P=j&&j(j(p([])));P&&P!==y&&m.call(P,b)&&(R=P);var I=s.prototype=i.prototype=Object.create(R);o.prototype=I.constructor=s,s.constructor=o,s[k]=o.displayName="GeneratorFunction",C.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},C.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,k in t||(t[k]="GeneratorFunction")),t.prototype=Object.create(I),t},C.awrap=function(t){return{__await:t}},a(u.prototype),u.prototype[w]=function(){return this},C.AsyncIterator=u,C.async=function(t,e,r,i){var o=new u(n(t,e,r,i));return C.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},a(I),I[k]="Generator",I[b]=function(){return this},I.toString=function(){return"[object Generator]"},C.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},C.values=p,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=_,this.done=!1,this.delegate=null,this.method="next",this.arg=_,this.tryEntries.forEach(h),!t)for(var e in this)"t"===e.charAt(0)&&m.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=_)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,r){return o.type="throw",o.arg=t,n.next=e,r&&(n.method="next",n.arg=_),!!r}if(this.done)throw t;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var s=m.call(i,"catchLoc"),a=m.call(i,"finallyLoc");if(s&&a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&m.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),A},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),h(n),A}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;h(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:p(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=_),A}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(e,n("h6ac"))},QYzI:function(t,e,n){(function(e){var r="object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this,i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=n("QVnC"),i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}}).call(e,n("h6ac"))},QlMj:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("dACh"),o=r(i),s=n("jx4H"),a=r(s);Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(e){(0,o.default)(this,t),this.descriptor=e}return(0,a.default)(t,[{key:"update",value:function(t,e,n){return this.descriptor.last_event_id=t,this.descriptor.revision=e,this.descriptor.data=n,this}},{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"key",get:function(){return this.descriptor.key}},{key:"value",get:function(){return this.descriptor.data}}]),t}();e.MapItem=u,e.default=u},R1bg:function(t,e,n){"use strict";var r=n("dACh"),i=function(t){return t&&t.__esModule?t:{default:t}}(r);Object.defineProperty(e,"__esModule",{value:!0});var o=n("kohK"),s=function t(e){(0,i.default)(this,t),this.sdk="js",this.sdkVer=e,this.os=o.os.family,this.osVer=o.os.version,this.pl=o.name,this.plVer=o.version};e.ClientInfo=s,e.default=s},R6c1:function(t,e,n){t.exports=!n("6MLN")&&!n("wLcK")(function(){return 7!=Object.defineProperty(n("9kxq")("div"),"a",{get:function(){return 7}}).a})},REa7:function(t){var e={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==e.call(t)}},S7IM:function(t,e,n){var r=n("MpYs"),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},SKjJ:function(t,e,n){"use strict";var r=n("AePr");t.exports=n("cYD/")("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=r.getEntry(this,t);return e&&e.v},set:function(t,e){return r.def(this,0===t?0:t,e)}},r,!0)},ShN9:function(t){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},T4f3:function(t,e,n){"use strict";e.__esModule=!0;var r=n("gc0D");e.default=function(t){return t&&t.__esModule?t:{default:t}}(r).default||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}},T51w:function(t,e,n){var r,i;!function(o,s){"use strict";r=s,void 0!==(i="function"==typeof r?r.call(e,n,e,t):r)&&(t.exports=i)}(0,function(){"use strict";function t(t){return typeof console!==a&&(void 0!==console[t]?e(console,t):void 0!==console.log?e(console,"log"):s)}function e(t,e){var n=t[e];if("function"==typeof n.bind)return n.bind(t);try{return Function.prototype.bind.call(n,t)}catch(e){return function(){return Function.prototype.apply.apply(n,[t,arguments])}}}function n(t,e,n){return function(){typeof console!==a&&(r.call(this,e,n),this[t].apply(this,arguments))}}function r(t,e){for(var n=0;n<u.length;n++){var r=u[n];this[r]=n<t?s:this.methodFactory(r,t,e)}}function i(e){return t(e)||n.apply(this,arguments)}function o(t,e,n){function o(t){var e=(u[t]||"silent").toUpperCase();try{return void(window.localStorage[f]=e)}catch(t){}try{window.document.cookie=encodeURIComponent(f)+"="+e+";"}catch(t){}}function s(){var t;try{t=window.localStorage[f]}catch(t){}if(typeof t===a)try{var e=window.document.cookie,n=e.indexOf(encodeURIComponent(f)+"=");n&&(t=/^([^;]+)/.exec(e.slice(n))[1])}catch(t){}return void 0===l.levels[t]&&(t=void 0),t}var c,l=this,f="loglevel";t&&(f+=":"+t),l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=n||i,l.getLevel=function(){return c},l.setLevel=function(e,n){if("string"==typeof e&&void 0!==l.levels[e.toUpperCase()]&&(e=l.levels[e.toUpperCase()]),!("number"==typeof e&&e>=0&&e<=l.levels.SILENT))throw"log.setLevel() called with invalid level: "+e;if(c=e,!1!==n&&o(e),r.call(l,e,t),typeof console===a&&e<l.levels.SILENT)return"No console available for logging"},l.setDefaultLevel=function(t){s()||l.setLevel(t,!1)},l.enableAll=function(t){l.setLevel(l.levels.TRACE,t)},l.disableAll=function(t){l.setLevel(l.levels.SILENT,t)};var h=s();null==h&&(h=null==e?"WARN":e),l.setLevel(h,!1)}var s=function(){},a="undefined",u=["trace","debug","info","warn","error"],c=new o,l={};c.getLogger=function(t){if("string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=l[t];return e||(e=l[t]=new o(t,c.getLevel(),c.methodFactory)),e};var f=typeof window!==a?window.log:void 0;return c.noConflict=function(){return typeof window!==a&&window.log===c&&(window.log=f),c},c})},"TD/Z":function(t,e,n){var r=n("7tZR");t.exports=function(t,e){return new(r(t))(e)}},TEgB:function(t,e,n){n("COf8"),n("i+u+"),t.exports=n("By4a")},TNJq:function(t,e,n){var r=n("zotD"),i=n("gjjs"),o=n("KxjL"),s=n("/wuY")("IE_PROTO"),a=function(){},u=function(){var t,e=n("9kxq")("iframe"),r=o.length;for(e.style.display="none",n("ebIA").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(a.prototype=r(t),n=new a,a.prototype=null,n[s]=t):n=u(),void 0===e?n:i(n,e)}},TpZJ:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){var r=new S.default(e,n,1,S.default.strategy.LEAK);return function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift(t),r.schedule.apply(r,e)}}Object.defineProperty(e,"__esModule",{value:!0});var o=n("L3Vt"),s=r(o),a=n("LlWG"),u=r(a),c=n("BX4+"),l=r(c),f=n("dACh"),h=r(f),d=n("jx4H"),p=r(d),v=n("VOrx"),_=r(v),y=n("ZKjc"),m=r(y),g=n("zWNa"),b=r(g),w=n("FRpO"),k=r(w),x=n("EwCr"),C=r(x),E=n("y9oC"),S=r(E),T=n("E07s"),O=r(T),A=n("0Zys"),R=r(A),j=n("JE0K"),P=r(j),I=n("LUBQ");e.default=function(t){function e(t,n){(0,h.default)(this,e);var r=(0,_.default)(this,(e.__proto__||(0,l.default)(e)).call(this));if(!t)throw new Error("Token is required for Notifications client");n=n||{},n.logLevel=n.logLevel||"error",C.default.setLevel(n.logLevel);var o=n.minTokenRefreshInterval||1e4,s=n.productId||"notifications";n.twilsockClient=n.twilsockClient||new R.default(t,n),n.transport=n.transport||new P.default(n.twilsockClient),n.emsClient=n.emsClient||new I.EMSClient(n);var a=n.twilsockClient,c=n.transport,f={overall:!1,transport:!1,registration:!1,lastEmitted:null},d=new b.default(null,n);return(0,u.default)(r,{_config:{value:d},_emsClient:{value:n.emsClient},_registrar:{value:new O.default(s,c,a,d)},_twilsock:{value:a},_reliableTransportState:{value:f},updateToken:{value:i(r._updateToken.bind(r),1,o),enumerable:!0},connectionState:{get:function(){return"disconnected"===r._twilsock.state?"disconnected":"disconnecting"===r._twilsock.state?"disconnecting":"connected"===r._twilsock.state&&r._reliableTransportState.registration?"connected":"rejected"===r._twilsock.state?"denied":"connecting"}}}),r._emsClient.setToken(t).then(function(t){r._config.updateToken(t.token),r._registrar.updateToken()}).catch(function(t){C.default.warn("Failed to set token",t)}),r._onTransportStateChange(r._twilsock.connected),r._registrar.on("transportReady",function(t){r._onRegistrationStateChange(t?"registered":"")}),r._registrar.on("stateChanged",function(t){r._onRegistrationStateChange(t)}),r._registrar.on("needReliableTransport",r._onNeedReliableTransport.bind(r)),r._twilsock.on("message",function(t,e){return r._routeMessage(t,e)}),r._twilsock.on("connected",function(t){r._onTransportStateChange(!0),r._registrar.setNotificationId("twilsock",t)}),r._twilsock.on("disconnected",function(){r._onTransportStateChange(!1)}),r}return(0,m.default)(e,t),(0,p.default)(e,[{key:"_routeMessage",value:function(t,e){C.default.trace("Message arrived: ",t,e),this.emit("message",t,e)}},{key:"_onNeedReliableTransport",value:function(t){t?this._twilsock.connect():this._twilsock.disconnect()}},{key:"_onRegistrationStateChange",value:function(t){this._reliableTransportState.registration="registered"===t,this._updateTransportState()}},{key:"_onTransportStateChange",value:function(t){this._reliableTransportState.transport=t,this._updateTransportState()}},{key:"_updateTransportState",value:function(){var t=this._reliableTransportState.transport&&this._reliableTransportState.registration;this._reliableTransportState.overall!==t&&(this._reliableTransportState.overall=t,C.default.info("Transport ready "+t),this.emit("transportReady",t)),this._reliableTransportState.lastEmitted!==this.connectionState&&(this._reliableTransportState.lastEmitted=this.connectionState,this.emit("connectionStateChanged",this.connectionState))}},{key:"subscribe",value:function(t,e){return e=e||"twilsock",C.default.trace("Add subscriptions for message type: ",t,e),this._registrar.subscribe(t,e)}},{key:"unsubscribe",value:function(t,e){return e=e||"twilsock",C.default.trace("Remove subscriptions for message type: ",t,e),this._registrar.unsubscribe(t,e)}},{key:"handlePushNotification",value:function(t){C.default.warn("Push message passed, but no functionality implemented yet: "+t)}},{key:"setPushRegistrationId",value:function(t,e){this._registrar.setNotificationId(e||"gcm",t)}},{key:"_updateToken",value:function(t){var e=this;return C.default.info("authTokenUpdated"),this._fpaToken===t?s.default.resolve():(this._twilsock.updateToken(t),this._emsClient.setToken(t).then(function(t){return t.token}).then(function(t){e._config.updateToken(t),e._registrar.updateToken()}))}}]),e}(k.default),t.exports=e.default},U72i:function(t){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},Ug9I:function(t,e,n){var r=n("NB7d")("wks"),i=n("X6va"),o=n("i1Q6").Symbol,s="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=s&&o[t]||(s?o:i)("Symbol."+t))}).store=r},V5Fu:function(t,e,n){function r(t,e,n){i.EventEmitter.call(this),o.checkIsFunction(t,"Expected fn to be a function."),o.checkIsArray(e,"Expected args to be an array."),o.checkIsFunction(n,"Expected callback to be a function."),this.function_=t,this.arguments_=e,this.callback_=n,this.lastResult_=[],this.numRetries_=0,this.backoff_=null,this.strategy_=null,this.failAfter_=-1,this.retryPredicate_=r.DEFAULT_RETRY_PREDICATE_,this.state_=r.State_.PENDING}var i=n("FRpO"),o=n("Dygy"),s=n("gfUn"),a=n("E1ih"),u=n("XdV9");s.inherits(r,i.EventEmitter),r.State_={PENDING:0,RUNNING:1,COMPLETED:2,ABORTED:3},r.DEFAULT_RETRY_PREDICATE_=function(){return!0},r.prototype.isPending=function(){return this.state_==r.State_.PENDING},r.prototype.isRunning=function(){return this.state_==r.State_.RUNNING},r.prototype.isCompleted=function(){return this.state_==r.State_.COMPLETED},r.prototype.isAborted=function(){return this.state_==r.State_.ABORTED},r.prototype.setStrategy=function(t){return o.checkState(this.isPending(),"FunctionCall in progress."),this.strategy_=t,this},r.prototype.retryIf=function(t){return o.checkState(this.isPending(),"FunctionCall in progress."),this.retryPredicate_=t,this},r.prototype.getLastResult=function(){return this.lastResult_.concat()},r.prototype.getNumRetries=function(){return this.numRetries_},r.prototype.failAfter=function(t){return o.checkState(this.isPending(),"FunctionCall in progress."),this.failAfter_=t,this},r.prototype.abort=function(){this.isCompleted()||this.isAborted()||(this.isRunning()&&this.backoff_.reset(),this.state_=r.State_.ABORTED,this.lastResult_=[new Error("Backoff aborted.")],this.emit("abort"),this.doCallback_())},r.prototype.start=function(t){o.checkState(!this.isAborted(),"FunctionCall is aborted."),o.checkState(this.isPending(),"FunctionCall already started.");var e=this.strategy_||new u;this.backoff_=t?t(e):new a(e),this.backoff_.on("ready",this.doCall_.bind(this,!0)),this.backoff_.on("fail",this.doCallback_.bind(this)),this.backoff_.on("backoff",this.handleBackoff_.bind(this)),this.failAfter_>0&&this.backoff_.failAfter(this.failAfter_),this.state_=r.State_.RUNNING,this.doCall_(!1)},r.prototype.doCall_=function(t){t&&this.numRetries_++;var e=["call"].concat(this.arguments_);i.EventEmitter.prototype.emit.apply(this,e),this.function_.apply(null,this.arguments_.concat(this.handleFunctionCallback_.bind(this)))},r.prototype.doCallback_=function(){this.callback_.apply(null,this.lastResult_)},r.prototype.handleFunctionCallback_=function(){if(!this.isAborted()){var t=Array.prototype.slice.call(arguments);this.lastResult_=t,i.EventEmitter.prototype.emit.apply(this,["callback"].concat(t));var e=t[0];e&&this.retryPredicate_(e)?this.backoff_.backoff(e):(this.state_=r.State_.COMPLETED,this.doCallback_())}},r.prototype.handleBackoff_=function(t,e,n){this.emit("backoff",t,e,n)},t.exports=r},VOrx:function(t,e,n){"use strict";e.__esModule=!0;var r=n("GyB/"),i=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,i.default)(e))&&"function"!=typeof e?t:e}},Vroa:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return t._subscribe(),t}function o(t,e,n,r){return{unique_name:t,purpose:e,context:n,data:r}}function s(t){return t?"string"==typeof t?{id:t,purpose:null,data:null,context:null,mode:null,optimistic:!1}:{id:t.uniqueName||t.sid||t.id,purpose:t.purpose,data:t.data,context:t.context,mode:t.mode,optimistic:!!t.optimistic}:{id:null,purpose:null,data:null,context:null,mode:null,optimistic:!1}}var a=n("aIIw"),u=r(a),c=n("BX4+"),l=r(c),f=n("dACh"),h=r(f),d=n("jx4H"),p=r(d),v=n("VOrx"),_=r(v),y=n("ZKjc"),m=r(y),g=n("L3Vt"),b=r(g),w=function(t,e,n,r){return new(n||(n=b.default))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var k=n("FRpO"),x=n("r9SO"),C=n("0Zys"),E=n("JE0K"),S=n("LUBQ"),T=n("H3OR"),O=n("PD3G"),A=n("E56Z"),R=n("/GKJ"),j=n("cFQ4"),P=n("OLak"),I=n("+/Dx"),F=n("hznj"),M=n("6Hp8"),L=n("al4s"),D=n("R1bg"),N=n("Jb0q"),U=n("AwcA"),B=n("PD3G"),q=n("3Y9o"),z=n("XzVR"),H="data_sync",V=n("qEFr").version,W=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,h.default)(this,e);var r=(0,_.default)(this,(e.__proto__||(0,l.default)(e)).call(this));if(!t)throw new Error("Sync library needs a valid Twilio token to be passed");n.hasOwnProperty("logLevel")&&A.default.setLevel(n.logLevel),r.productId=n.productId=n.productId||H;var i=n.twilsockClient=n.twilsockClient||new C(t,n),o=n.transport=n.transport||new E.Transport(n.twilsockClient,{concurrentHttpRequestLimit:20}),s=n.emsClient=n.emsClient||new S.EmsClient(n),a=n.notificationsClient=n.notificationsClient||new T(t,n),u=new R.Configuration(null,n),c=new I.Network(r.productId,new D.ClientInfo(V),u,o),f=new U.SessionStorage(u);r.localStorageId=null,r.fpaToken=t,r.authData=new q.Deferred,r.authData.promise.then(function(t){return r.handleEmsResponse(t)}),s.once("response",function(t){return r.authData.update(t)}),s.setToken(t).catch(function(t){A.default.warn("Failed to set token",t)}),i.connect(),r.services={config:u,twilsock:i,notifications:a,network:c,emsClient:s,storage:f,router:null,subscriptions:null};var d=new j.Subscriptions(r.services),p=new P.Router({config:u,subscriptions:d,notifications:a});return r.services.router=p,r.services.subscriptions=d,r.entities=new N.EntitiesCache,a.on("connectionStateChanged",function(){r.emit("connectionStateChanged",r.services.notifications.connectionState)}),r}return(0,m.default)(e,t),(0,p.default)(e,[{key:"handleEmsResponse",value:function(t){this.services.config.updateToken(t.token);try{var e=t.identity,n=t.serviceSids[this.productId];this.services.storage.updateStorageId(x.h64().update("TW::"+e+"::"+n).digest().toString(16))}catch(t){A.default.error("Failed to initialize persistent storage",t)}}},{key:"ensureReady",value:function(){return w(this,void 0,void 0,u.default.mark(function t(){return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.authData.promise;case 2:case"end":return t.stop()}},t,this)}))}},{key:"storeRootInSessionCache",value:function(t,e,n){if(this.services.config.sessionStorageEnabled&&e){var r=B.deepClone(n);t!==F.SyncDocument.type&&(r.last_event_id=null,delete r.items),this.services.storage.store(t,e,r)}}},{key:"readRootFromSessionCache",value:function(t,e){return this.services.config.sessionStorageEnabled&&e?this.services.storage.read(t,e):null}},{key:"_get",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return w(this,void 0,void 0,u.default.mark(function r(){var i,o;return u.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return",null);case 2:return i=new O.UriBuilder(t).pathSegment(e).queryParam("Include",n?"items":void 0).build(),r.prev=3,r.next=6,this.services.network.get(i);case 6:return o=r.sent,r.abrupt("return",o.body);case 10:if(r.prev=10,r.t0=r.catch(3),404!==r.t0.status){r.next=14;break}return r.abrupt("return",null);case 14:throw r.t0;case 15:case"end":return r.stop()}},r,this,[[3,10]])}))}},{key:"_createDocument",value:function(t,e){return this.services.network.post(this.services.config.documentsUri,{unique_name:t,data:e}).then(function(t){return t.body})}},{key:"_getDocument",value:function(t){return w(this,void 0,void 0,u.default.mark(function e(){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(F.SyncDocument.type,t)||this._get(this.services.config.documentsUri,t));case 1:case"end":return e.stop()}},e,this)}))}},{key:"_createList",value:function(t,e,n){return this.services.network.post(this.services.config.listsUri,o(t,e,n)).then(function(t){return t.body})}},{key:"_getList",value:function(t){return w(this,void 0,void 0,u.default.mark(function e(){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(M.SyncList.type,t)||this._get(this.services.config.listsUri,t));case 1:case"end":return e.stop()}},e,this)}))}},{key:"_createMap",value:function(t){return this.services.network.post(this.services.config.mapsUri,{unique_name:t}).then(function(t){return t.body})}},{key:"_getMap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return w(this,void 0,void 0,u.default.mark(function n(){return u.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.readRootFromSessionCache(L.SyncMap.type,t)||this._get(this.services.config.mapsUri,t,e));case 1:case"end":return n.stop()}},n,this)}))}},{key:"getCached",value:function(t,e){return t?this.entities.get(t,e)||null:null}},{key:"removeFromCacheAndSession",value:function(t,e,n){this.entities.remove(e),this.services.config.sessionStorageEnabled&&this.services.storage.remove(t,e,n)}},{key:"document",value:function(t){return w(this,void 0,void 0,u.default.mark(function e(){var n,r,o,a,c,l,f,h=this;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if(n=s(t),r=n.id,o=n.data,a=n.mode,!(c=this.getCached(r,"document"))){e.next=8;break}return e.abrupt("return",c);case 8:return e.next=10,this._getDocument(r);case 10:if(l=e.sent){e.next=29;break}if("open"!==a){e.next=16;break}throw new z.default("Not found",404);case 16:return e.prev=16,e.next=19,this._createDocument(r,o);case 19:l=e.sent,e.next=29;break;case 22:if(e.prev=22,e.t0=e.catch(16),409!==e.t0.status){e.next=28;break}return e.abrupt("return",this.document(t));case 28:throw e.t0;case 29:return this.storeRootInSessionCache(F.SyncDocument.type,r,l),f=new F.SyncDocument(this.services,l,function(t,e,n){return h.removeFromCacheAndSession(t,e,n)}),f=this.entities.store(f),e.abrupt("return",i(f));case 33:case"end":return e.stop()}},e,this,[[16,22]])}))}},{key:"map",value:function(t){return w(this,void 0,void 0,u.default.mark(function e(){var n,r,o,a,c,l,f,h=this;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if(n=s(t),r=n.id,o=n.mode,a=n.optimistic,!(c=this.getCached(r,"map"))){e.next=8;break}return e.abrupt("return",c);case 8:return e.next=10,this._getMap(r,a);case 10:if(l=e.sent){e.next=29;break}if("open"!==o){e.next=16;break}throw new z.default("Not found",404);case 16:return e.prev=16,e.next=19,this._createMap(r);case 19:l=e.sent,e.next=29;break;case 22:if(e.prev=22,e.t0=e.catch(16),409!==e.t0.status){e.next=28;break}return e.abrupt("return",this.map(t));case 28:throw e.t0;case 29:return this.storeRootInSessionCache(L.SyncMap.type,r,l),f=new L.SyncMap(this.services,l,function(t,e,n){return h.removeFromCacheAndSession(t,e,n)}),f=this.entities.store(f),e.abrupt("return",i(f));case 33:case"end":return e.stop()}},e,this,[[16,22]])}))}},{key:"list",value:function(t){return w(this,void 0,void 0,u.default.mark(function e(){var n,r,o,a,c,l,f,h,d=this;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if(n=s(t),r=n.id,o=n.purpose,a=n.context,c=n.mode,!(l=this.getCached(r,"list"))){e.next=8;break}return e.abrupt("return",l);case 8:return e.next=10,this._getList(r);case 10:if(f=e.sent){e.next=29;break}if("open"!==c){e.next=16;break}throw new z.default("Not found",404);case 16:return e.prev=16,e.next=19,this._createList(r,o,a);case 19:f=e.sent,e.next=29;break;case 22:if(e.prev=22,e.t0=e.catch(16),409!==e.t0.status){e.next=28;break}return e.abrupt("return",this.list(t));case 28:throw e.t0;case 29:return this.storeRootInSessionCache(M.SyncList.type,r,f),h=new M.SyncList(this.services,f,function(t,e,n){return d.removeFromCacheAndSession(t,e,n)}),h=this.entities.store(h),e.abrupt("return",i(h));case 33:case"end":return e.stop()}},e,this,[[16,22]])}))}},{key:"shutdown",value:function(){return w(this,void 0,void 0,u.default.mark(function t(){return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.services.subscriptions.shutdown();case 2:return t.next=4,this.services.twilsock.disconnect();case 4:case"end":return t.stop()}},t,this)}))}},{key:"updateToken",value:function(t){return w(this,void 0,void 0,u.default.mark(function e(){var n;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.emsClient.setToken(t);case 2:return n=e.sent,this.services.config.updateToken(n.token),e.next=6,b.default.all([this.services.notifications.updateToken(t),this.services.twilsock.updateToken(t)]);case 6:this.fpaToken=t;case 7:case"end":return e.stop()}},e,this)}))}},{key:"connectionState",get:function(){return this.services.notifications.connectionState}}],[{key:"version",get:function(){return V}}]),e}(k.EventEmitter);e.SyncClient=W,e.Client=W,e.default=W},VuZO:function(t,e,n){t.exports={default:n("O35A"),__esModule:!0}},Wyka:function(t,e,n){var r=n("E5Ce"),i=n("U72i");t.exports=function(t){return r(i(t))}},X6va:function(t){var e=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+n).toString(36))}},X9RM:function(t,e,n){t.exports={default:n("Lvd3"),__esModule:!0}},XMdB:function(t,e,n){var r=n("vSO4");r(r.P+r.R,"Set",{toJSON:n("x6MZ")("Set")})},XdV9:function(t,e,n){function r(t){o.call(this,t),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}var i=n("gfUn"),o=n("C6lX");i.inherits(r,o),r.prototype.next_=function(){var t=Math.min(this.nextBackoffDelay_,this.getMaxDelay());return this.nextBackoffDelay_+=this.backoffDelay_,this.backoffDelay_=t,t},r.prototype.reset_=function(){this.nextBackoffDelay_=this.getInitialDelay(),this.backoffDelay_=0},t.exports=r},XzVR:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("BX4+"),o=r(i),s=n("dACh"),a=r(s),u=n("VOrx"),c=r(u),l=n("ZKjc"),f=r(l);Object.defineProperty(e,"__esModule",{value:!0});var h=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,a.default)(this,e);var i=(0,c.default)(this,(e.__proto__||(0,o.default)(e)).call(this));return i.name=i.constructor.name,i.message=t,i.status=n,i.code=r,i}return(0,f.default)(e,t),e}(Error);e.SyncError=h,e.default=h},YD0x:function(t,e,n){var r=n("vSO4");r(r.S+r.F,"Object",{assign:n("uj5A")})},YLmZ:function(t,e,n){var r=n("ozpD");t.exports=function(t,e){var n=[];return r(t,!1,n.push,n,e),n}},YZrv:function(t,e,n){t.exports={default:n("K+F3"),__esModule:!0}},ZAcJ:function(t,e,n){"use strict";var r=n("dACh"),i=function(t){return t&&t.__esModule?t:{default:t}}(r);Object.defineProperty(e,"__esModule",{value:!0}),e.default=function t(e){(0,i.default)(this,t);var n=e.emsClient||{},r=e.realm||"us1",o="https://ems."+r+".twilio.com";this.url=n.url||n.emsUri||n.emsUrl||o+"/v1/token"}},ZHvQ:function(t,e,n){var r=n("ShN9"),i=n("Ug9I")("toStringTag"),o="Arguments"==r(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=s(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},ZKjc:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n("Aq8W"),o=r(i),s=n("yeEC"),a=r(s),u=n("GyB/"),c=r(u);e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,c.default)(e)));t.prototype=(0,a.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(o.default?(0,o.default)(t,e):t.__proto__=e)}},ZUV3:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("dACh"),o=r(i),s=n("jx4H"),a=r(s);Object.defineProperty(e,"__esModule",{value:!0});var u=n("lmjd"),c=function(){function t(e,n){(0,o.default)(this,t),this.value=e,this.revision=n||0}return(0,a.default)(t,[{key:"isValid",get:function(){return!0}}]),t}(),l=function(){function t(e){(0,o.default)(this,t),this.revision=e}return(0,a.default)(t,[{key:"isValid",get:function(){return!1}}]),t}(),f=function(){function t(){(0,o.default)(this,t),this.items=new u.TreeMap}return(0,a.default)(t,[{key:"store",value:function(t,e,n){var r=this.items.get(t);return r&&r.revision>n?r.isValid?r.value:null:(this.items.set(t,new c(e,n)),e)}},{key:"delete",value:function(t,e){var n=this.items.get(t);(!n||n.revision<e)&&this.items.set(t,new l(e))}},{key:"isKnown",value:function(t,e){var n=this.items.get(t);return n&&n.revision>=e}},{key:"get",value:function(t){var e=this.items.get(t);return e&&e.isValid?e.value:null}},{key:"has",value:function(t){var e=this.items.get(t);return e&&e.isValid}}]),t}();e.Cache=f,e.default=f},ZaKr:function(t,e,n){var r=n("BxvP"),i=n("zotD"),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n("3zRh")(Function.call,n("sxPs").f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},ZxII:function(t,e,n){e.f=n("Ug9I")},aIIw:function(t,e,n){t.exports=n("QYzI")},af0K:function(t,e,n){var r=n("dhak"),i=n("Ug9I")("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},akPY:function(t,e,n){var r=n("Gfzd"),i=n("0WCH");t.exports=n("6MLN")?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},al4s:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("T4f3"),o=r(i),s=n("aIIw"),a=r(s),u=n("BX4+"),c=r(u),l=n("dACh"),f=r(l),h=n("jx4H"),d=r(h),p=n("VOrx"),v=r(p),_=n("ZKjc"),y=r(_),m=n("L3Vt"),g=r(m),b=function(t,e,n,r){return new(n||(n=g.default))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var w=n("PD3G"),k=n("GBRx"),x=n("/lpw"),C=n("QlMj"),E=n("NQ19"),S=n("ZUV3"),T=function(t){function e(t,n,r){(0,f.default)(this,e);var i=(0,v.default)(this,(e.__proto__||(0,c.default)(e)).call(this,t,r));return i.actionQueue=new x.RetryingQueue,i.cache=new S.Cache,i.descriptor=n,n.items&&n.items.forEach(function(t){i.cache.store(t.key,new C.MapItem(t),t.last_event_id)}),i}return(0,y.default)(e,t),(0,d.default)(e,[{key:"_get",value:function(t){return this.queryItems({key:t}).then(function(e){if(e.items.length<1)throw new Error("No item with key "+t+" found");return e.items[0]})}},{key:"__set",value:function(t,e){return this.services.network.post(t,{data:e.data},e.revision).then(function(t){return t=t.body,t.data=e.data,t})}},{key:"_set",value:function(t,e,n){return b(this,void 0,void 0,a.default.mark(function r(){var i,o=this;return a.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n){r.next=2;break}return r.abrupt("return",this.__set(t,{data:e.data}));case 2:return i=function(t){return b(o,void 0,void 0,a.default.mark(function r(){var i;return a.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(412!==t.status){r.next=5;break}return r.next=3,this._get(e.key);case 3:return i=r.sent,r.abrupt("return",{revision:i.revision,data:n(w.deepClone(i.value))});case 5:throw t;case 6:case"end":return r.stop()}},r,this)}))},r.abrupt("return",this.actionQueue.add(this.__set.bind(this),t,{revision:e.revision,data:e.data},i));case 4:case"end":return r.stop()}},r,this)}))}},{key:"_tryAddOrUpdate",value:function(t,e,n){return b(this,void 0,void 0,a.default.mark(function r(){var i,o,s,u,c,l;return a.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.services.network.post(t,e);case 3:return i=r.sent,i.body.data=e.data,r.abrupt("return",{added:!0,value:i.body});case 8:if(r.prev=8,r.t0=r.catch(0),409===r.t0.status){r.next=12;break}throw r.t0;case 12:if(o=r.t0.body.links.item,n){r.next=20;break}return r.next=16,this._set(o,e,n);case 16:return s=r.sent,r.abrupt("return",{added:!1,value:s});case 20:return r.next=22,this.services.network.get(o);case 22:return u=r.sent,c=n(w.deepClone(u.body.data)),r.next=26,this._set(o,{key:u.body.key,revision:u.body.revision,data:c},n);case 26:return l=r.sent,r.abrupt("return",{added:!1,value:l});case 28:case"end":return r.stop()}},r,this,[[0,8]])}))}},{key:"getContext",value:function(){return b(this,void 0,void 0,a.default.mark(function t(){var e;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===this.context){t.next=2;break}return t.abrupt("return",this.context);case 2:return t.next=4,this.services.network.get(this.links.context);case 4:return e=t.sent,this.context=e.body.data,t.abrupt("return",this.context);case 7:case"end":return t.stop()}},t,this)}))}},{key:"updateContext",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.post(this.links.context,{data:t});case 2:this.context=t,this.emit("contextUpdated",t,!0);case 4:case"end":return e.stop()}},e,this)}))}},{key:"set",value:function(t,e){return this._actualSet(t,e)}},{key:"_actualSet",value:function(t,e,n){return b(this,void 0,void 0,a.default.mark(function r(){var i,o,s,u,c;return a.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=void 0,o=void 0,!(s=this.cache.get(t))){r.next=11;break}return u={key:t,data:e,revision:s.revision||void 0},r.next=7,this._set(s.uri,u,n);case 7:i=r.sent,o=!1,r.next=16;break;case 11:return r.next=13,this._tryAddOrUpdate(this.links.items,{key:t,data:e},n);case 13:c=r.sent,i=c.value,o=c.added;case 16:return s=this.cache.get(t),s&&i.last_event_id>s.lastEventId?(s.update(i.last_event_id,i.revision,i.data),this.emit("itemUpdated",s,!0)):s||(s=this.cache.store(t,new C.MapItem(i),i.last_event_id),o?this.emit("itemAdded",s,!0):this.emit("itemUpdated",s,!0)),r.abrupt("return",s);case 19:case"end":return r.stop()}},r,this)}))}},{key:"get",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){var n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cache.has(t)){e.next=2;break}return e.abrupt("return",this.cache.get(t));case 2:return e.next=4,this.queryItems({key:t});case 4:if(n=e.sent,!(n.items.length<1)){e.next=7;break}throw new Error("No item with key "+t+" found");case 7:return e.abrupt("return",n.items[0]);case 8:case"end":return e.stop()}},e,this)}))}},{key:"mutate",value:function(t,e){return b(this,void 0,void 0,a.default.mark(function n(){var r;return a.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.get(t).then(function(t){return t.value}).catch(function(){return{}});case 2:return r=n.sent,n.abrupt("return",this._actualSet(t,e(w.deepClone(r)),e));case 4:case"end":return n.stop()}},n,this)}))}},{key:"update",value:function(t,e){return b(this,void 0,void 0,a.default.mark(function n(){return a.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.mutate(t,function(t){return(0,o.default)(t,e)}));case 1:case"end":return n.stop()}},n,this)}))}},{key:"remove",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){var n,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}throw new Error("Key argument is invalid");case 2:return e.next=4,this.get(t);case 4:return n=e.sent,e.next=7,this.services.network.delete(n.uri);case 7:r=e.sent,this.cache.delete(t,r.body.last_event_id),this.emit("itemRemoved",t,!0);case 10:case"end":return e.stop()}},e,this)}))}},{key:"queryItems",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){var n,r,i,o,s=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},n=new w.UriBuilder(this.links.items).queryParam("From",t.from).queryParam("PageSize",t.limit).queryParam("Key",t.key).queryParam("PageToken",t.pageToken).queryParam("Order",t.order).build(),e.next=4,this.services.network.get(n);case 4:return r=e.sent,i=r.body.items.map(function(t){return s.cache.get(t.key)?s._handleItemUpdated(t.key,t.url,t.last_event_id,t.revision,t.data):s.cache.store(t.key,new C.MapItem(t),t.last_event_id),s.cache.get(t.key)}),o=r.body.meta,e.abrupt("return",new E.Paginator(i,function(t){return s.queryItems({pageToken:t})},o.previous_token,o.next_token));case 8:case"end":return e.stop()}},e,this)}))}},{key:"getItems",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},t.limit=t.pageSize||t.limit||50,t.order=t.order||"asc",e.abrupt("return",this.queryItems(t));case 4:case"end":return e.stop()}},e,this)}))}},{key:"forEach",value:function(t){var e=this;return new g.default(function(n,r){function i(e){e.items.forEach(function(e){return t(e)}),e.hasNextPage?e.nextPage().then(i).catch(r):n()}e.queryItems().then(i).catch(r)})}},{key:"shouldIgnoreEvent",value:function(t,e){return this.cache.isKnown(t,e)}},{key:"_update",value:function(t,e){switch(t.type){case"map_item_added":this._handleItemAdded(t.item_key,t.item_url,t.id,t.item_revision,t.item_data);break;case"map_item_updated":this._handleItemUpdated(t.item_key,t.item_url,t.id,t.item_revision,t.item_data);break;case"map_item_removed":this._handleItemRemoved(t.item_key,t.id);break;case"map_context_updated":this._handleContextUpdate(t.context_data,t.id);break;case"map_removed":this.onRemoved(!1)}e&&this._advanceLastEventId(t.id,t.map_revision)}},{key:"_advanceLastEventId",value:function(t,e){this.lastEventId<t&&(this.descriptor.last_event_id=t,e&&(this.descriptor.revision=e))}},{key:"_handleItemAdded",value:function(t,e,n,r,i){if(!this.cache.has(t)&&!this.shouldIgnoreEvent(t,n)){var o=new C.MapItem({key:t,url:e,last_event_id:n,revision:r,data:i});this.cache.store(t,o,n),this.emit("itemAdded",o,!1),this.emit("itemAddedRemotely",o)}}},{key:"_handleItemUpdated",value:function(t,e,n,r,i){var o=this.cache.get(t);o||this.shouldIgnoreEvent(t,n)?o&&n>o.lastEventId&&(o.update(n,r,i),this.emit("itemUpdated",o,!1),this.emit("itemUpdatedRemotely",o)):(o=new C.MapItem({key:t,url:e,last_event_id:n,revision:r,data:i}),this.cache.store(t,o,n),this.emit("itemUpdated",o,!1),this.emit("itemUpdatedRemotely",o))}},{key:"_handleItemRemoved",value:function(t,e){this.cache.delete(t,e),this.emit("itemRemoved",t,!1),this.emit("itemRemovedRemotely",t)}},{key:"_handleContextUpdate",value:function(t,e){this.lastEventId<e&&(this.context=t,this.emit("contextUpdated",t,!1),this.emit("contextUpdatedRemotely",t))}},{key:"onRemoved",value:function(t){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.emit("collectionRemoved",t),t||this.emit("collectionRemovedRemotely")}},{key:"removeMap",value:function(){return b(this,void 0,void 0,a.default.mark(function t(){return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return t.stop()}},t,this)}))}},{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"type",get:function(){return"map"}}],[{key:"type",get:function(){return"map"}}]),e}(k.SyncEntity);e.SyncMap=T,e.default=T},ayXv:function(t,e,n){var r=n("ShN9");t.exports=Array.isArray||function(t){return"Array"==r(t)}},b0lL:function(t){var e,e;!function(e){t.exports=e()}(function(){return function t(n,r,i){function o(a,u){if(!r[a]){if(!n[a]){var c="function"==typeof e&&e;if(!u&&c)return e(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var f=r[a]={exports:{}};n[a][0].call(f.exports,function(t){var e=n[a][1][t];return o(e||t)},f,f.exports,t,n,r,i)}return r[a].exports}for(var s="function"==typeof e&&e,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){"use strict";function r(t){var e=t.op;return"remove"===e||"replace"===e||"copy"===e||"move"===e}function i(t,e){var n={};for(var r in t)n[r]=1;for(var i in e)delete n[i];return Object.keys(n)}function o(t){var e={};t.forEach(function(t){for(var n in t)e[n]=(e[n]||0)+1});var n=t.length;for(var r in e)e[r]<n&&delete e[r];return Object.keys(e)}function s(t){return void 0===t?"undefined":null===t?"null":Array.isArray(t)?"array":typeof t}function a(t){return"add"===t.op}function u(t){return"remove"===t.op}function c(t,e,n){function r(n,o){var s=i[n+","+o];if(void 0===s){if(v(t[n-1],e[o-1]))s=r(n-1,o-1);else{var a=[];if(n>0){var u=r(n-1,o);a.push({operations:u.operations.concat({op:"remove",index:n-1}),cost:u.cost+1})}if(o>0){var c=r(n,o-1);a.push({operations:c.operations.concat({op:"add",index:n-1,value:e[o-1]}),cost:c.cost+1})}if(n>0&&o>0){var l=r(n-1,o-1);a.push({operations:l.operations.concat({op:"replace",index:n-1,original:t[n-1],value:e[o-1]}),cost:l.cost+1})}s=a.sort(function(t,e){return t.cost-e.cost})[0]}i[n+","+o]=s}return s}var i={"0,0":{operations:[],cost:0}},o=isNaN(t.length)||t.length<=0?0:t.length,s=isNaN(e.length)||e.length<=0?0:e.length,c=r(o,s).operations,l=c.reduce(function(t,e){var r=d(t,2),i=r[0],s=r[1];if(a(e)){var c=e.index+1+s,l=c<o+s?String(c):"-",f={op:e.op,path:n.add(l).toString(),value:e.value};return[i.concat(f),s+1]}if(u(e)){var f={op:e.op,path:n.add(String(e.index+s)).toString()};return[i.concat(f),s-1]}var v=n.add(String(e.index+s)),_=h(e.original,e.value,v);return[i.concat.apply(i,p(_)),s]},[[],0]),f=d(l,2),_=f[0];return _}function l(t,e,n){var r=[];return i(t,e).forEach(function(t){r.push({op:"remove",path:n.add(t).toString()})}),i(e,t).forEach(function(t){r.push({op:"add",path:n.add(t).toString(),value:e[t]})}),o([t,e]).forEach(function(i){r.push.apply(r,p(h(t[i],e[i],n.add(i))))}),r}function f(t,e,n){return v(t,e)?[]:[{op:"replace",path:n.toString(),value:e}]}function h(t,e,n){var r=s(t),i=s(e);return"array"==r&&"array"==i?c(t,e,n):"object"==r&&"object"==i?l(t,e,n):f(t,e,n)}var d=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var n,r=[],i=t[Symbol.iterator]();!(n=i.next()).done&&(r.push(n.value),!e||r.length!==e););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},p=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)};n.isDestructive=r,n.subtract=i,n.intersection=o,n.objectType=s,n.diffArrays=c,n.diffObjects=l,n.diffValues=f,n.diffAny=h,Object.defineProperty(n,"__esModule",{value:!0});var v=t("./equal").compare},{"./equal":2}],2:[function(t,e,n){"use strict";function r(t,e){for(var n=[],r=0,i=t.length;r<i;r++)n.push([t[r],e[r]]);return n}function i(t,e){return t.length===e.length&&r(t,e).every(function(t){return s(t[0],t[1])})}function o(t,e){var n=Object.keys(t);return!!i(n,Object.keys(e))&&n.every(function(n){return s(t[n],e[n])})}function s(t,e){return t===e||(Array.isArray(t)&&Array.isArray(e)?i(t,e):Object(t)===t&&Object(e)===e&&o(t,e))}n.compare=s,Object.defineProperty(n,"__esModule",{value:!0})},{}],3:[function(t,e,n){"use strict";var r=function t(e,n,r){var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i&&i.writable)return i.value;var s=i.get;if(void 0!==s)return s.call(r)},i=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)};Object.defineProperty(n,"__esModule",{value:!0});n.MissingError=function(t){function e(t){r(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,"Value required at path: "+t),this.path=t,this.name=this.constructor.name}return i(e,t),e}(Error),n.InvalidOperationError=function(t){function e(t){r(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,"Invalid operation: "+t),this.op=t,this.name=this.constructor.name}return i(e,t),e}(Error),n.TestError=function(t){function e(t,n){r(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,"Test failed: "+t+" != "+n),this.actual=t,this.expected=n,this.name=this.constructor.name,this.actual=t,this.expected=n}return i(e,t),e}(Error)},{}],4:[function(t,e,n){"use strict";function r(t,e){return e.map(function(e){var n=c[e.op];return void 0===n?new a(e.op):n(t,e)})}function i(t,e){var n=new u;return f(t,e,n)}function o(t,e){var n=u.fromJSON(e).evaluate(t);if(void 0!==n)return{op:"test",path:e,value:n.value}}function s(t,e){var n=new Array;return e.filter(h).forEach(function(e){var r=o(t,e.path);if(r&&n.push(r),"from"in e){var i=o(t,e.from);i&&n.push(i)}}),n}n.applyPatch=r,n.createPatch=i,n.createTests=s,Object.defineProperty(n,"__esModule",{value:!0});var a=t("./errors").InvalidOperationError,u=t("./pointer").Pointer,c=function(t){return t&&t.__esModule?t:{default:t}}(t("./patch")),l=t("./diff"),f=l.diffAny,h=l.isDestructive},{"./diff":1,"./errors":3,"./patch":5,"./pointer":6}],5:[function(t,e,n){"use strict";function r(t,e,n){Array.isArray(t)?"-"==e?t.push(n):t.splice(e,0,n):t[e]=n}function i(t,e){Array.isArray(t)?t.splice(e,1):delete t[e]}function o(t,e){var n=f.fromJSON(e.path).evaluate(t);return void 0===n.parent?new p(e.path):(r(n.parent,n.key,e.value),null)}function s(t,e){var n=f.fromJSON(e.path).evaluate(t);return void 0===n.value?new p(e.path):(i(n.parent,n.key),null)}function a(t,e){var n=f.fromJSON(e.path).evaluate(t);return void 0===n.value?new p(e.path):(n.parent[n.key]=e.value,null)}function u(t,e){var n=f.fromJSON(e.from).evaluate(t);if(void 0===n.value)return new p(e.from);var o=f.fromJSON(e.path).evaluate(t);return void 0===o.parent?new p(e.path):(i(n.parent,n.key),r(o.parent,o.key,n.value),null)}function c(t,e){var n=f.fromJSON(e.from).evaluate(t);if(void 0===n.value)return new p(e.from);var o=f.fromJSON(e.path).evaluate(t);return void 0===o.parent?new p(e.path):(i(n.parent,n.key),r(o.parent,o.key,n.value),null)}function l(t,e){var n=f.fromJSON(e.path).evaluate(t);return h(n.value,e.value)?null:new v(n.value,e.value)}n.add=o,n.remove=s,n.replace=a,n.move=u,n.copy=c,n.test=l,Object.defineProperty(n,"__esModule",{value:!0});var f=t("./pointer").Pointer,h=t("./equal").compare,d=t("./errors"),p=d.MissingError,v=d.TestError},{"./equal":2,"./errors":3,"./pointer":6}],6:[function(t,e,n){"use strict";function r(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function i(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}var o=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(n,"__esModule",{value:!0});n.Pointer=function(){function t(){this.tokens=void 0===arguments[0]?[""]:arguments[0]}return o(t,{toString:{value:function(){return this.tokens.map(i).join("/")}},evaluate:{value:function(t){for(var e=null,n=null,r=1,i=this.tokens.length;r<i;r++)e=t,n=this.tokens[r],t=(e||{})[n];return{parent:e,key:n,value:t}}},push:{value:function(t){this.tokens.push(t)}},add:{value:function(e){return new t(this.tokens.concat(String(e)))}}},{fromJSON:{value:function(e){var n=e.split("/").map(r);if(""!==n[0])throw new Error("Invalid JSON Pointer: "+e);return new t(n)}}}),t}()},{}]},{},[4])(4)})},b1KJ:function(t,e,n){function r(t){s.call(this,t),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay(),this.factor_=r.DEFAULT_FACTOR,t&&void 0!==t.factor&&(o.checkArgument(t.factor>1,"Exponential factor should be greater than 1 but got %s.",t.factor),this.factor_=t.factor)}var i=n("gfUn"),o=n("Dygy"),s=n("C6lX");i.inherits(r,s),r.DEFAULT_FACTOR=2,r.prototype.next_=function(){return this.backoffDelay_=Math.min(this.nextBackoffDelay_,this.getMaxDelay()),this.nextBackoffDelay_=this.backoffDelay_*this.factor_,this.backoffDelay_},r.prototype.reset_=function(){this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()},t.exports=r},b1tA:function(t,e,n){var r=n("vSO4");r(r.S,"Object",{setPrototypeOf:n("ZaKr").set})},b7Q2:function(t,e,n){"use strict";var r=n("TNJq"),i=n("0WCH"),o=n("11Ut"),s={};n("akPY")(s,n("Ug9I")("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(s,{next:i(1,n)}),o(t,e+" Iterator")}},c2zY:function(t,e,n){var r=n("i1Q6"),i=n("zKeE"),o=n("1kq3"),s=n("ZxII"),a=n("Gfzd").f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},c6mp:function(t,e,n){n("c2zY")("asyncIterator")},cFQ4:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("aIIw"),o=r(i),s=n("m8OI"),a=r(s),u=n("X9RM"),c=r(u),l=n("T4f3"),f=r(l),h=n("YZrv"),d=r(h),p=n("dACh"),v=r(p),_=n("jx4H"),y=r(_),m=n("L3Vt"),g=r(m),b=function(t,e,n,r){return new(n||(n=g.default))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var w=n("PvFw"),k=n("E56Z"),x=n("XzVR"),C=n("JE0K"),E=function(){function t(e){(0,v.default)(this,t),this.localObject=e,this.pendingCorrelationId=null,this.established=!1,this.retryCount=0}return(0,y.default)(t,[{key:"update",value:function(t,e){this.localObject._update(t,e)}},{key:"reset",value:function(){this.pendingCorrelationId=null,this.retryCount=0,this.established=!1}},{key:"markAsFailed",value:function(t){this.rejectedWithError=t.error,this.pendingCorrelationId=null,this.localObject.reportFailure(new x.SyncError("Failed to subscribe on service events: "+t.error.message,t.error.status,t.error.code))}},{key:"complete",value:function(t){this.pendingCorrelationId=null,this.established=!0,this.localObject._advanceLastEventId(t)}},{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"isInTransition",get:function(){return null!==this.pendingCorrelationId}},{key:"isEstablished",get:function(){return this.established}}]),t}(),S=function(){function t(e){var n=this;(0,v.default)(this,t),this.isConnected=!1,this.maxBatchSize=100,this.services=e,this.subscriptions=new d.default,this.persisted=new d.default,this.latestPokeResponseArrivalTimestampByCorrelationId=new d.default,this.backoff=w.exponential((0,f.default)({randomisationFactor:.2,initialDelay:100,maxDelay:12e4},this.services.config.backoffConfig)),this.backoff.on("ready",function(){var t=n.getSubscriptionUpdateBatch(),e=t.action,r=t.subscriptions;e?n.applyNewSubscriptionUpdateBatch(e,r):(n.backoff.reset(),k.default.info("All subscriptions resolved."))})}return(0,y.default)(t,[{key:"getSubscriptionUpdateBatch",value:function(){function t(t,e,n,r){var i=[],o=!0,s=!1,u=void 0;try{for(var l,f=(0,c.default)(t);!(o=(l=f.next()).done);o=!0){var h=(0,a.default)(l.value,2),d=h[0],p=h[1];if(!e.get(d)&&(n||!p.isInTransition)&&!p.rejectedWithError&&(i.push(p),r&&i.length>=r))break}}catch(t){s=!0,u=t}finally{try{!o&&f.return&&f.return()}finally{if(s)throw u}}return i}var e=t(this.subscriptions,this.persisted,!1,this.maxBatchSize);if(e.length>0)return{action:"establish",subscriptions:e};var n=t(this.persisted,this.subscriptions,!0,this.maxBatchSize);return n.length>0?{action:"cancel",subscriptions:n}:{action:null,subscriptions:null}}},{key:"persist",value:function(){try{this.backoff.backoff()}catch(t){}}},{key:"applyNewSubscriptionUpdateBatch",value:function(t,e){return b(this,void 0,void 0,o.default.mark(function n(){var r,i,s,a,u,l,f,h,d,p,v,_,y,m,g,b,w,x,E=this;return o.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this.isConnected){n.next=4;break}return k.default.debug("Twilsock connection (required for subscription) not ready; waiting"),this.backoff.reset(),n.abrupt("return");case 4:for(e=this.processLocalActions(t,e),r=(new Date).getTime(),i=!0,s=!1,a=void 0,n.prev=9,u=(0,c.default)(e);!(i=(l=u.next()).done);i=!0)f=l.value,this.recordActionAttemptOn(f,t,r);n.next=17;break;case 13:n.prev=13,n.t0=n.catch(9),s=!0,a=n.t0;case 17:n.prev=17,n.prev=18,!i&&u.return&&u.return();case 20:if(n.prev=20,!s){n.next=23;break}throw a;case 23:return n.finish(20);case 24:return n.finish(17);case 25:return n.prev=25,n.next=28,this.request(t,r,e);case 28:h=n.sent,d=h.body.max_batch_size,!isNaN(parseInt(d))&&isFinite(d)&&d>0&&(this.maxBatchSize=d),"establish"===t&&(p=h.body.estimated_delivery_in_ms,v=!isNaN(parseFloat(p))&&isFinite(p),_=v&&p>0,_?setTimeout(function(){return E.verifyPokeDelivery(r,p,e)},p):k.default.error("Invalid timeout: "+p)),this.backoff.reset(),n.next=57;break;case 35:for(n.prev=35,n.t1=n.catch(25),y=!0,m=!1,g=void 0,n.prev=40,b=(0,c.default)(e);!(y=(w=b.next()).done);y=!0)x=w.value,this.recordActionFailureOn(x,t);n.next=48;break;case 44:n.prev=44,n.t2=n.catch(40),m=!0,g=n.t2;case 48:n.prev=48,n.prev=49,!y&&b.return&&b.return();case 51:if(n.prev=51,!m){n.next=54;break}throw g;case 54:return n.finish(51);case 55:return n.finish(48);case 56:n.t1 instanceof C.TwilsockUnavailableError?(k.default.debug("Twilsock connection (required for subscription) not ready (c:"+r+"); waiting"),this.backoff.reset()):(k.default.debug("Failed an attempt to "+t+" subscriptions (c:"+r+"); retrying",n.t1),this.persist());case 57:case"end":return n.stop()}},n,this,[[9,13,17,25],[18,,20,24],[25,35],[40,44,48,56],[49,,51,55]])}))}},{key:"verifyPokeDelivery",value:function(t,e,n){var r=this,i=this.latestPokeResponseArrivalTimestampByCorrelationId.get(t),o=i?(new Date).getTime()-i:e;if(o>=e)n.filter(function(e){return e.pendingCorrelationId===t}).forEach(function(t){t.pendingCorrelationId=null,t.retryCount++,r.persisted.delete(t.sid)}),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(t);else{var s=e-o;setTimeout(function(){return r.verifyPokeDelivery(t,e,n)},s)}}},{key:"processLocalActions",value:function(t,e){return"cancel"===t?e.filter(function(t){return!t.rejectedWithError}):e}},{key:"recordActionAttemptOn",value:function(t,e,n){if("establish"===e)this.persisted.set(t.sid,t),t.pendingCorrelationId=n;else{var r=this.persisted.get(t.sid);r&&(r.pendingCorrelationId=n)}}},{key:"recordActionFailureOn",value:function(t,e){t.pendingCorrelationId=null,"establish"===e&&this.persisted.delete(t.sid)}},{key:"request",value:function(t,e,n){var r=n.map(function(e){return{object_sid:e.sid,object_type:e.type,last_event_id:"establish"===t?e.lastEventId:void 0}}),i=n.filter(function(t){return t.retryCount>0}).length;return k.default.debug("Attempting '"+t+"' request (c:"+e+"):",r),this.services.network.post(this.services.config.subscriptionsUri,{event_protocol_version:3,action:t,correlation_id:e,retried_requests:i,requests:r},null,!0)}},{key:"add",value:function(t,e){k.default.debug("Establishing intent to subscribe to "+t);var n=this.subscriptions.get(t);n&&n.lastEventId===e.lastEventId||(this.persisted.delete(t),this.subscriptions.set(t,new E(e)),this.persist())}},{key:"remove",value:function(t){k.default.debug("Establishing intent to unsubscribe from "+t),this.subscriptions.delete(t)&&this.persist()}},{key:"acceptMessage",value:function(t,e){switch(k.default.trace("Subscriptions received",t),t.correlation_id&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(t.correlation_id,(new Date).getTime()),t.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(t.event,t.correlation_id);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(t.event,t.correlation_id);break;case"subscription_failed":this.applySubscriptionFailedMessage(t.event,t.correlation_id);break;case(t.event_type.match(/^(?:map|list|document)_/)||{}).input:;this.applyEventToSubscribedEntity(function(){return t.event_type.match(/^map_/)?t.event.map_sid:t.event_type.match(/^list_/)?t.event.list_sid:t.event_type.match(/^document_/)?t.event.document_sid:void 0}(),t,e);break;default:k.default.debug("Dropping unknown message type "+t.event_type)}}},{key:"applySubscriptionEstablishedMessage",value:function(t,e){var n=t.object_sid,r=this.persisted.get(t.object_sid);r&&r.pendingCorrelationId===e?"interrupted"===t.replay_status?(k.default.debug("Event Replay for subscription to "+n+" (c:"+e+") interrupted; continuing eagerly."),r.pendingCorrelationId=null,this.persisted.delete(r.sid),this.backoff.reset()):"completed"===t.replay_status&&(k.default.debug("Event Replay for subscription to "+n+" (c:"+e+") completed. Subscription is ready."),r.complete(t.last_event_id),this.persisted.set(t.object_sid,r),this.backoff.reset()):k.default.debug("Late message for "+t.object_sid+" (c:"+e+") dropped."),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(t,e){var n=this.persisted.get(t.object_sid);n&&n.pendingCorrelationId===e?(n.pendingCorrelationId=null,this.persisted.delete(t.object_sid)):k.default.debug("Late message for "+t.object_sid+" (c:"+e+") dropped."),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(t,e){var n=t.object_sid,r=this.subscriptions.get(n),i=this.persisted.get(n);r&&i?i.pendingCorrelationId===e&&(k.default.error("Failed to subscribe on "+i.sid,t.error),i.markAsFailed(t)):!r&&i&&this.persisted.delete(n),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(t,e,n){var r=this;if(t){n=n||function(){var e=r.persisted.get(t);return e&&e.isEstablished}();var i=this.subscriptions.get(t);i?(e.event.type=e.event_type,i.update(e.event,n)):k.default.debug("Message dropped for SID '"+t+"', for which there is no subscription.")}}},{key:"onConnectionStateChanged",value:function(t){this.isConnected=t,t&&this.poke()}},{key:"poke",value:function(){k.default.info("Triggering event replay for all subscriptions.");var t=[],e=!0,n=!1,r=void 0;try{for(var i,o=(0,c.default)(this.persisted.values());!(e=(i=o.next()).done);e=!0){var s=i.value;s.reset(),s.rejectedWithError&&t.push(s)}}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}this.persisted.clear();var a=!0,u=!1,l=void 0;try{for(var f,h=(0,c.default)(t);!(a=(f=h.next()).done);a=!0){var d=f.value;this.persisted.set(d.sid,d)}}catch(t){u=!0,l=t}finally{try{!a&&h.return&&h.return()}finally{if(u)throw l}}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),t}();e.Subscriptions=S,e.default=S},cOHw:function(t,e,n){var r=n("vSO4"),i=n("zKeE"),o=n("wLcK");t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],s={};s[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",s)}},"cYD/":function(t,e,n){"use strict";var r=n("i1Q6"),i=n("vSO4"),o=n("e8vu"),s=n("wLcK"),a=n("akPY"),u=n("O6kh"),c=n("ozpD"),l=n("KUik"),f=n("BxvP"),h=n("11Ut"),d=n("Gfzd").f,p=n("tMiz")(0),v=n("6MLN");t.exports=function(t,e,n,_,y,m){var g=r[t],b=g,w=y?"set":"add",k=b&&b.prototype,x={};return v&&"function"==typeof b&&(m||k.forEach&&!s(function(){(new b).entries().next()}))?(b=e(function(e,n){l(e,b,t,"_c"),e._c=new g,void 0!=n&&c(n,y,e[w],e)}),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in k&&(!m||"clear"!=t)&&a(b.prototype,t,function(n,r){if(l(this,b,t),!e&&m&&!f(n))return"get"==t&&void 0;var i=this._c[t](0===n?0:n,r);return e?this:i})}),"size"in k&&d(b.prototype,"size",{get:function(){return this._c.size}})):(b=_.getConstructor(e,t,y,w),u(b.prototype,n),o.NEED=!0),h(b,t),x[t]=b,i(i.G+i.W+i.F,x),m||_.setStrong(b,t,y),b}},cjsw:function(t,e,n){n("yOG5");var r=n("zKeE").Object;t.exports=function(t,e){return r.create(t,e)}},dACh:function(t,e){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},dAjQ:function(t){function e(t,e){var r=e||0,i=n;return i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]}for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);t.exports=e},dVxL:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Vroa");e.SyncClient=r.SyncClient,e.SyncDocument=n("hznj").SyncDocument,e.SyncList=n("6Hp8").SyncList,e.SyncListItem=n("qXBc").ListItem,e.SyncMap=n("al4s").SyncMap,e.SyncMapItem=n("QlMj").MapItem,e.default=r.SyncClient,t.exports=r.SyncClient,t.exports.SyncClient=r.SyncClient},dXs8:function(t,e,n){n("b1tA"),t.exports=n("zKeE").Object.setPrototypeOf},dhak:function(t){t.exports={}},e8vu:function(t,e,n){var r=n("X6va")("meta"),i=n("BxvP"),o=n("yS17"),s=n("Gfzd").f,a=0,u=Object.isExtensible||function(){return!0},c=!n("wLcK")(function(){return u(Object.preventExtensions({}))}),l=function(t){s(t,r,{value:{i:"O"+ ++a,w:{}}})},f=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[r].i},h=function(t,e){if(!o(t,r)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[r].w},d=function(t){return c&&p.NEED&&u(t)&&!o(t,r)&&l(t),t},p=t.exports={KEY:r,NEED:!1,fastKey:f,getWeak:h,onFreeze:d}},eDHa:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("BX4+"),o=r(i),s=n("dACh"),a=r(s),u=n("VOrx"),c=r(u),l=n("ZKjc"),f=r(l);Object.defineProperty(e,"__esModule",{value:!0});var h=n("XzVR"),d=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments[3];(0,a.default)(this,e);var s=(0,c.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n,r));return s.body=i,s}return(0,f.default)(e,t),e}(h.SyncError);e.SyncNetworkError=d,e.default=d},ebIA:function(t,e,n){t.exports=n("i1Q6").document&&document.documentElement},"f+DB":function(t,e,n){(function(e){var n,r=e.crypto||e.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var o=new Array(16);n=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}t.exports=n}).call(e,n("h6ac"))},"f/lV":function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return t>=200&&t<300}function o(t){return t&&t.header&&t.header.http_status}Object.defineProperty(e,"__esModule",{value:!0});var s=n("L3Vt"),a=r(s),u=n("YZrv"),c=r(u),l=n("LlWG"),f=r(l),h=n("dACh"),d=r(h),p=n("jx4H"),v=r(p),_=n("obon"),y=r(_);e.default=function(){function t(e){var n=this;(0,d.default)(this,t),(0,f.default)(this,{_activeRequests:{value:new c.default},_socket:{value:e}}),this._socket.on("reply",this._processReply.bind(this)),this._socket.on("disconnected",function(){n._activeRequests.forEach(function(t){clearTimeout(t.timeout),t.reject(new Error("Twilsock disconnected"))}),n._activeRequests.clear()})}return(0,v.default)(t,[{key:"_processReply",value:function(t){var e=this._activeRequests.get(t.id);e&&(clearTimeout(e.timeout),this._activeRequests.delete(t.id),setTimeout(function(){i(t.status.code)?o(t)&&!i(t.header.http_status.code)?e.reject({status:t.header.http_status.code,description:t.header.http_status.status,body:t.body}):e.resolve(t):e.reject(new Error("Transport failure: "+t.status.status))},0))}},{key:"_storeRequest",value:function(t,e,n){var r={resolve:e,reject:n,timeout:setTimeout(function(){y.default.debug("request",t,"is timed out"),n(new Error("Twilsock: request timeout: "+t))},3e4)};this._activeRequests.set(t,r)}},{key:"send",value:function(t,e,n){var r=this;return new a.default(function(i,o){r._socket.isConnected||(y.default.info("Can not send upstream message. Twilsock is not in connected state"),o(new Error("Twilsock is not connected")));var s=r._socket.sendUpstreamMessage(t,e,n);y.default.trace("message sent: ",{id:s,address:t,headers:e,body:n}),r._storeRequest(s,i,o)})}},{key:"putNotificationContext",value:function(t,e){var n=this;return new a.default(function(r,i){n._socket.isConnected||(y.default.info("Can not send put notification context. Twilsock is not in connected state"),i(new Error("Twilsock is not connected")));var o={method:"put_notification_ctx",notification_ctx_id:t},s=n._socket.send(o,e);n._storeRequest(s,r,i)})}},{key:"deleteNotificationContext",value:function(t){var e=this;return new a.default(function(n,r){e._socket.isConnected||(y.default.info("Can not send delete notification context. Twilsock is not in connected state"),r(new Error("Twilsock is not connected")));var i={method:"delete_notification_ctx",notification_ctx_id:t},o=e._socket.send(i);e._storeRequest(o,n,r)})}},{key:"shutdown",value:function(){this._activeRequests.forEach(function(t){clearTimeout(t.timeout),t.reject(new Error("Twilsock: request cancelled by user"))}),this._activeRequests.clear()}}]),t}(),t.exports=e.default},fp6q:function(t,e,n){(function(e){!function(e){t.exports=e()}(function(){var t,n,r;return function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof _dereq_&&_dereq_;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n||t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof _dereq_&&_dereq_,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e){"use strict";e.exports=function(t){function e(t){var e=new n(t),r=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),r}var n=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},{}],2:[function(t,e){"use strict";function n(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new u(16),this._normalQueue=new u(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=a}function r(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function i(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function o(t){this._normalQueue._pushOne(t),this._queueTick()}var s;try{throw new Error}catch(t){s=t}var a=t("./schedule"),u=t("./queue"),c=t("./util");n.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},n.prototype.hasCustomScheduler=function(){return this._customScheduler},n.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},n.prototype.disableTrampolineIfNecessary=function(){c.hasDevTools&&(this._trampolineEnabled=!1)},n.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},n.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},n.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},c.hasDevTools?(n.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?r.call(this,t,e,n):this._schedule(function(){setTimeout(function(){t.call(e,n)},100)})},n.prototype.invoke=function(t,e,n){this._trampolineEnabled?i.call(this,t,e,n):this._schedule(function(){t.call(e,n)})},n.prototype.settlePromises=function(t){this._trampolineEnabled?o.call(this,t):this._schedule(function(){t._settlePromises()})}):(n.prototype.invokeLater=r,n.prototype.invoke=i,n.prototype.settlePromises=o),n.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){e.call(t.shift(),t.shift())}else e._settlePromises()}},n.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},n.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},n.prototype._reset=function(){this._isTickUsed=!1},e.exports=n,e.exports.firstLineError=s},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e){"use strict";e.exports=function(t,e,n,r){var i=!1,o=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(o,o,null,this,t)},a=function(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)},u=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(o){i||(i=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var c=n(o),l=new t(e);l._propagateFrom(this,1);var f=this._target();if(l._setBoundTo(c),c instanceof t){var h={promiseRejectionQueued:!1,promise:l,target:f,bindingPromise:c};f._then(e,s,void 0,l,h),c._then(a,u,void 0,l,h),l._setOnCancel(c)}else l._resolveCallback(f);return l},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e){"use strict";function n(){try{Promise===i&&(Promise=r)}catch(t){}return i}var r;"undefined"!=typeof Promise&&(r=Promise);var i=t("./promise")();i.noConflict=n,e.exports=i},{"./promise":22}],5:[function(t,e){"use strict";var n=Object.create;if(n){var r=n(null),i=n(null);r[" size"]=i[" size"]=0}e.exports=function(e){function n(t,n){var r;if(null!=t&&(r=t[n]),"function"!=typeof r){var i="Object "+a.classString(t)+" has no method '"+a.toString(n)+"'";throw new e.TypeError(i)}return r}function r(t){return n(t,this.pop()).apply(t,this)}function i(t){return t[this]}function o(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}var s,a=t("./util"),u=a.canEvaluate;e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(r,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e,n="number"==typeof t;if(n)e=o;else if(u){var r=s(t);e=null!==r?r:i}else e=i;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),s=o.tryCatch,a=o.errorObj,u=e._async;e.prototype.break=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(o.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=s(t).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),u.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e){"use strict";e.exports=function(e){function n(t,n,a){return function(u){var c=a._boundValue();t:for(var l=0;l<t.length;++l){var f=t[l];if(f===Error||null!=f&&f.prototype instanceof Error){if(u instanceof f)return o(n).call(c,u)}else if("function"==typeof f){var h=o(f).call(c,u);if(h===s)return h;if(h)return o(n).call(c,u)}else if(r.isObject(u)){for(var d=i(f),p=0;p<d.length;++p){var v=d[p];if(f[v]!=u[v])continue t}return o(n).call(c,u)}}return e}}var r=t("./util"),i=t("./es5").keys,o=r.tryCatch,s=r.errorObj;return n}},{"./es5":13,"./util":36}],8:[function(t,e){"use strict";e.exports=function(t){function e(){this._trace=new e.CapturedTrace(r())}function n(){if(i)return new e}function r(){var t=o.length-1;if(t>=0)return o[t]}var i=!1,o=[];return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},e.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},e.prototype._popContext=function(){if(void 0!==this._trace){var t=o.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},e.CapturedTrace=null,e.create=n,e.deactivateLongStackTraces=function(){},e.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,s=t._peekContext,a=t.prototype._peekContext,u=t.prototype._promiseCreated;e.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=s,t.prototype._peekContext=a,t.prototype._promiseCreated=u,i=!1},i=!0,t.prototype._pushContext=e.prototype._pushContext,t.prototype._popContext=e.prototype._popContext,t._peekContext=t.prototype._peekContext=r,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},e}},{}],9:[function(t,e){"use strict";e.exports=function(e,n){function r(t,e){return{promise:e}}function i(){return!1}function o(t,e,n){var r=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+N.toString(t));r._attachCancellationCallback(t)})}catch(t){return t}}function s(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?N.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function a(){return this._onCancelField}function u(t){this._onCancelField=t}function c(){this._cancellationParent=void 0,this._onCancelField=void 0}function l(t,e){if(0!=(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function f(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function h(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function d(){this._trace=new j(this._peekContext())}function p(t,e){if(U(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=x(t);N.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),N.notEnumerableProp(t,"__stackCleaned__",!0)}}}function v(t,e,n,r,i){if(void 0===t&&null!==e&&Y){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&r._bitField))return;n&&(n+=" ");var o="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),u=w(a),c=u.length-1;c>=0;--c){var l=u[c];if(!q.test(l)){var f=l.match(z);f&&(o="at "+f[1]+":"+f[2]+":"+f[3]+" ");break}}if(u.length>0)for(var h=u[0],c=0;c<a.length;++c)if(a[c]===h){c>0&&(s="\n"+a[c-1]);break}}r._warn("a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+s,!0,e)}}function _(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),y(n)}function y(t,n,r){if(ot.warnings){var i,o=new D(t);if(n)r._attachExtraTrace(o);else if(ot.longStackTraces&&(i=e._peekContext()))i.attachExtraTrace(o);else{var s=x(o);o.stack=s.message+"\n"+s.stack.join("\n")}tt("warning",o)||C(o,"",!0)}}function m(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}function g(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function b(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,o=e[i],s=-1,a=r.length-1;a>=0;--a)if(r[a]===o){s=a;break}for(var a=s;a>=0;--a){if(e[i]!==r[a])break;e.pop(),i--}e=r}}function w(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],i="    (No stack trace)"===r||H.test(r),o=i&&nt(r);i&&!o&&(W&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function k(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||H.test(r))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}function x(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?k(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:w(e)}}function C(t,e,n){if("undefined"!=typeof console){var r;if(N.isObject(t)){r=e+V(t.stack,t)}else r=e+String(t);"function"==typeof F?F(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function E(t,e,n,r){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(t){L.throwLater(t)}"unhandledRejection"===t?tt(t,n,r)||i||C(n,"Unhandled rejection "):tt(t,r)}function S(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():N.toString(t);if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+T(e)+">, no stack trace)"}function T(t){return t.length<41?t:t.substr(0,38)+"..."}function O(){return"function"==typeof it}function A(t){var e=t.match(rt);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function R(t,e){if(O()){for(var n,r,i=t.stack.split("\n"),o=e.stack.split("\n"),s=-1,a=-1,u=0;u<i.length;++u){var c=A(i[u]);if(c){n=c.fileName,s=c.line;break}}for(var u=0;u<o.length;++u){var c=A(o[u]);if(c){r=c.fileName,a=c.line;break}}s<0||a<0||!n||!r||n!==r||s>=a||(nt=function(t){if(B.test(t))return!0;var e=A(t);return!!(e&&e.fileName===n&&s<=e.line&&e.line<=a)})}}function j(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);it(this,j),e>32&&this.uncycle()}var P,I,F,M=e._getDomain,L=e._async,D=t("./errors").Warning,N=t("./util"),U=N.canAttachTrace,B=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,q=/\((?:timers\.js):\d+:\d+\)/,z=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,H=null,V=null,W=!1,K=!(0==N.env("BLUEBIRD_DEBUG")),G=!(0==N.env("BLUEBIRD_WARNINGS")||!K&&!N.env("BLUEBIRD_WARNINGS")),Q=!(0==N.env("BLUEBIRD_LONG_STACK_TRACES")||!K&&!N.env("BLUEBIRD_LONG_STACK_TRACES")),Y=0!=N.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(G||!!N.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var t=this;setTimeout(function(){t._notifyUnhandledRejection()},1)}},e.prototype._notifyUnhandledRejectionIsHandled=function(){E("rejectionHandled",P,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),E("unhandledRejection",I,t,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(t,e,n){return y(t,e,n||this)},e.onPossiblyUnhandledRejection=function(t){var e=M();I="function"==typeof t?null===e?t:N.domainBind(e,t):void 0},e.onUnhandledRejectionHandled=function(t){var e=M();P="function"==typeof t?null===e?t:N.domainBind(e,t):void 0};var X=function(){};e.longStackTraces=function(){if(L.haveItemsQueued()&&!ot.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!ot.longStackTraces&&O()){var t=e.prototype._captureStackTrace,r=e.prototype._attachExtraTrace;ot.longStackTraces=!0,X=function(){if(L.haveItemsQueued()&&!ot.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=r,n.deactivateLongStackTraces(),L.enableTrampoline(),ot.longStackTraces=!1},e.prototype._captureStackTrace=d,e.prototype._attachExtraTrace=p,n.activateLongStackTraces(),L.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return ot.longStackTraces&&O()};var J=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return N.global.dispatchEvent(t),function(t,e){var n=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!N.global.dispatchEvent(n)}}if("function"==typeof Event){var t=new Event("CustomEvent");return N.global.dispatchEvent(t),function(t,e){var n=new Event(t.toLowerCase(),{cancelable:!0});return n.detail=e,!N.global.dispatchEvent(n)}}var t=document.createEvent("CustomEvent");return t.initCustomEvent("testingtheevent",!1,!0,{}),N.global.dispatchEvent(t),function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t.toLowerCase(),!1,!0,e),!N.global.dispatchEvent(n)}}catch(t){}return function(){return!1}}(),Z=function(){return N.isNode?function(){return process.emit.apply(process,arguments)}:N.global?function(t){var e="on"+t.toLowerCase(),n=N.global[e];return!!n&&(n.apply(N.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),$={promiseCreated:r,promiseFulfilled:r,promiseRejected:r,promiseResolved:r,promiseCancelled:r,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:r},tt=function(t){var e=!1;try{e=Z.apply(null,arguments)}catch(t){L.throwLater(t),e=!0}var n=!1;try{n=J(t,$[t].apply(null,arguments))}catch(t){L.throwLater(t),n=!0}return n||e};e.config=function(t){if(t=Object(t),"longStackTraces"in t&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&X()),"warnings"in t){var n=t.warnings;ot.warnings=!!n,Y=ot.warnings,N.isObject(n)&&"wForgottenReturn"in n&&(Y=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!ot.cancellation){if(L.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=c,e.prototype._propagateFrom=l,e.prototype._onCancel=a,e.prototype._setOnCancel=u,e.prototype._attachCancellationCallback=s,e.prototype._execute=o,et=l,ot.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!ot.monitoring?(ot.monitoring=!0,e.prototype._fireEvent=tt):!t.monitoring&&ot.monitoring&&(ot.monitoring=!1,e.prototype._fireEvent=i)),e},e.prototype._fireEvent=i,e.prototype._execute=function(t,e,n){try{t(e,n)}catch(t){return t}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(){},e.prototype._attachCancellationCallback=function(){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(){};var et=f,nt=function(){return!1},rt=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;N.inherits(j,Error),n.CapturedTrace=j,j.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;t=this._length=r;for(var r=t-1;r>=0;--r){var o=e[r].stack;void 0===n[o]&&(n[o]=r)}for(var r=0;r<t;++r){var s=e[r].stack,a=n[s];if(void 0!==a&&a!==r){a>0&&(e[a-1]._parent=void 0,e[a-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var u=r>0?e[r-1]:this;a<t-1?(u._parent=e[a+1],u._parent.uncycle(),u._length=u._parent._length+1):(u._parent=void 0,u._length=1);for(var c=u._length+1,l=r-2;l>=0;--l)e[l]._length=c,c++;return}}}},j.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=x(t),n=e.message,r=[e.stack],i=this;void 0!==i;)r.push(w(i.stack.split("\n"))),i=i._parent;b(r),g(r),N.notEnumerableProp(t,"stack",m(n,r)),N.notEnumerableProp(t,"__stackCleaned__",!0)}};var it=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():S(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,H=t,V=e;var n=Error.captureStackTrace;return nt=function(t){return B.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return H=/@/,V=e,W=!0,function(t){t.stack=(new Error).stack};var i;try{throw new Error}catch(t){i="stack"in t}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(V=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?S(e):e.toString()},null):(H=t,V=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(F=function(t){console.warn(t)},N.isNode&&process.stderr.isTTY?F=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:N.isNode||"string"!=typeof(new Error).stack||(F=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var ot={warnings:G,longStackTraces:!1,cancellation:!1,monitoring:!1};return Q&&e.longStackTraces(),{longStackTraces:function(){return ot.longStackTraces},warnings:function(){return ot.warnings},cancellation:function(){return ot.cancellation},monitoring:function(){return ot.monitoring},propagateFromFunction:function(){return et},boundValueFunction:function(){return h},checkForgottenReturns:v,setBounds:R,warn:y,deprecated:_,CapturedTrace:j,fireDomEvent:J,fireGlobalEvent:Z}}},{"./errors":12,"./util":36}],10:[function(t,e){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1];return this.caught(t,function(){throw e})},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];return r instanceof t&&r.suppressUnhandledRejections(),this.caught(n,function(){return r})}}},{}],11:[function(t,e){"use strict";e.exports=function(t,e){function n(){return o(this)}function r(t,n){return i(t,n,e,e)}var i=t.reduce,o=t.all;t.prototype.each=function(t){return i(this,t,e,0)._then(n,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return i(this,t,e,e)},t.each=function(t,r){return i(t,r,e,0)._then(n,void 0,void 0,t,void 0)},t.mapSeries=r}},{}],12:[function(t,e){"use strict";function n(t,e){function n(r){if(!(this instanceof n))return new n(r);l(this,"message","string"==typeof r?r:e),l(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return c(n,Error),n}function r(t){if(!(this instanceof r))return new r(t);l(this,"name","OperationalError"),l(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(l(this,"message",t.message),l(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var i,o,s=t("./es5"),a=s.freeze,u=t("./util"),c=u.inherits,l=u.notEnumerableProp,f=n("Warning","warning"),h=n("CancellationError","cancellation error"),d=n("TimeoutError","timeout error"),p=n("AggregateError","aggregate error");try{i=TypeError,o=RangeError}catch(t){i=n("TypeError","type error"),o=n("RangeError","range error")}for(var v="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),_=0;_<v.length;++_)"function"==typeof Array.prototype[v[_]]&&(p.prototype[v[_]]=Array.prototype[v[_]]);s.defineProperty(p.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),p.prototype.isOperational=!0;var y=0;p.prototype.toString=function(){var t=Array(4*y+1).join(" "),e="\n"+t+"AggregateError of:\n";y++,t=Array(4*y+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];r=i.join("\n"),e+=r+"\n"}return y--,e},c(r,Error);var m=Error.__BluebirdErrorTypes__;m||(m=a({CancellationError:h,TimeoutError:d,OperationalError:r,RejectionError:r,AggregateError:p}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:m,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:i,RangeError:o,CancellationError:m.CancellationError,OperationalError:m.OperationalError,TimeoutError:m.TimeoutError,AggregateError:m.AggregateError,Warning:f}},{"./es5":13,"./util":36}],13:[function(t,e){var n=function(){"use strict";return void 0===this}();if(n)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var r={}.hasOwnProperty,i={}.toString,o={}.constructor.prototype,s=function(t){var e=[];for(var n in t)r.call(t,n)&&e.push(n);return e},a=function(t,e){return{value:t[e]}},u=function(t,e,n){return t[e]=n.value,t},c=function(t){return t},l=function(t){try{return Object(t).constructor.prototype}catch(t){return o}};e.exports={isArray:function(t){try{return"[object Array]"===i.call(t)}catch(t){return!1}},keys:s,names:s,defineProperty:u,getDescriptor:a,freeze:c,getPrototypeOf:l,isES5:n,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],15:[function(t,e){"use strict";e.exports=function(e,n,r){function i(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function o(t){this.finallyHandler=t}function s(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function a(){return c.call(this,this.promise._target()._settledValue())}function u(t){if(!s(this,t))return h.e=t,h}function c(t){var i=this.promise,c=this.handler;if(!this.called){this.called=!0;var l=this.isFinallyHandler()?c.call(i._boundValue()):c.call(i._boundValue(),t);if(l===r)return l;if(void 0!==l){i._setReturnedNonUndefined();var d=n(l,i);if(d instanceof e){if(null!=this.cancelPromise){if(d._isCancelled()){var p=new f("late cancellation observer");return i._attachExtraTrace(p),h.e=p,h}d.isPending()&&d._attachCancellationCallback(new o(this))}return d._then(a,u,void 0,this,void 0)}}}return i.isRejected()?(s(this),h.e=t,h):(s(this),t)}var l=t("./util"),f=e.CancellationError,h=l.errorObj,d=t("./catch_filter")(r);return i.prototype.isFinallyHandler=function(){return 0===this.type},o.prototype._resultCancelled=function(){s(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new i(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,c,c)},e.prototype.tap=function(t){return this._passThrough(t,1,c)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,c);var r,i=new Array(n-1),o=0;for(r=0;r<n-1;++r){var s=arguments[r];if(!l.isObject(s))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+l.classString(s)));i[o++]=s}return i.length=o,this._passThrough(d(i,arguments[r],this),1,void 0,c)},i}},{"./catch_filter":7,"./util":36}],16:[function(t,e){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r){for(var o=0;o<n.length;++o){r._pushContext();var s=d(n[o])(t);if(r._popContext(),s===h){r._pushContext();var a=e.reject(h.e);return r._popContext(),a}var u=i(s,r);if(u instanceof e)return u}return null}function u(t,n,i,o){if(s.cancellation()){var a=new e(r),u=this._finallyPromise=new e(r);this._promise=a.lastly(function(){return u}),a._captureStackTrace(),a._setOnCancel(this)}else{(this._promise=new e(r))._captureStackTrace()}this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(p):p,this._yieldedPromise=null,this._cancellationPhase=!1}var c=t("./errors"),l=c.TypeError,f=t("./util"),h=f.errorObj,d=f.tryCatch,p=[];f.inherits(u,o),u.prototype._isResolved=function(){return null===this._promise},u.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},u.prototype._promiseCancelled=function(){if(!this._isResolved()){var t,n=void 0!==this._generator.return;if(n)this._promise._pushContext(),t=d(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var r=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),t=d(this._generator.throw).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},u.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=d(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},u.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=d(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},u.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},u.prototype.promise=function(){return this._promise},u.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},u.prototype._continue=function(t){var n=this._promise;if(t===h)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var o=i(r,this._promise);if(!(o instanceof e)&&null===(o=a(o,this._yieldHandlers,this._promise)))return void this._promiseRejected(new l("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));o=o._target();var s=o._bitField;0==(50397184&s)?(this._yieldedPromise=o,o._proxy(this,null)):0!=(33554432&s)?e._async.invoke(this._promiseFulfilled,this,o._value()):0!=(16777216&s)?e._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()},e.coroutine=function(t,e){if("function"!=typeof t)throw new l("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=u,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new r(void 0,void 0,n,i),s=o.promise();return o._generator=e,o._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new l("expecting a function but got "+f.classString(t));p.push(t)},e.spawn=function(t){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new u(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e){"use strict";e.exports=function(e,n){t("./util");e.join=function(){var t,e=arguments.length-1;if(e>0&&"function"==typeof arguments[e]){t=arguments[e];var r}var i=[].slice.call(arguments);t&&i.pop();var r=new n(i).promise();return void 0!==t?r.spread(t):r}}},{"./util":36}],18:[function(t,e){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,e,n,r){this.constructor$(t),this._promise._captureStackTrace();var i=c();this._callback=null===i?e:l.domainBind(i,e),this._preservedValues=r===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],d.invoke(this._asyncInit,this,void 0)}function u(t,n,i,o){if("function"!=typeof n)return r("expecting a function but got "+l.classString(n));var s=0;if(void 0!==i){if("object"!=typeof i||null===i)return e.reject(new TypeError("options argument must be an object but it is "+l.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+l.classString(i.concurrency)));s=i.concurrency}return s="number"==typeof s&&isFinite(s)&&s>=1?s:0,new a(t,n,s,o).promise()}var c=e._getDomain,l=t("./util"),f=l.tryCatch,h=l.errorObj,d=e._async;l.inherits(a,n),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(t,n){var r=this._values,o=this.length(),a=this._preservedValues,u=this._limit;if(n<0){if(n=-1*n-1,r[n]=t,u>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(u>=1&&this._inFlight>=u)return r[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var c=this._promise,l=this._callback,d=c._boundValue();c._pushContext();var p=f(l).call(d,t,n,o),v=c._popContext();if(s.checkForgottenReturns(p,v,null!==a?"Promise.filter":"Promise.map",c),p===h)return this._reject(p.e),!0;var _=i(p,this._promise);if(_ instanceof e){_=_._target();var y=_._bitField;if(0==(50397184&y))return u>=1&&this._inFlight++,r[n]=_,_._proxy(this,-1*(n+1)),!1;if(0==(33554432&y))return 0!=(16777216&y)?(this._reject(_._reason()),!0):(this._cancel(),!0);p=_._value()}r[n]=p}return++this._totalResolved>=o&&(null!==a?this._filter(r,a):this._resolve(r),!0)},a.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},a.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;o<n;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},a.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return u(this,t,e,null)},e.map=function(t,e,n,r){return u(t,e,n,r)}}},{"./util":36}],19:[function(t,e){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util"),a=s.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+s.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=a(t).apply(this,arguments),s=r._popContext();return o.checkForgottenReturns(i,s,"Promise.method",r),r._resolveFromSyncValue(i),r}},e.attempt=e.try=function(t){if("function"!=typeof t)return i("expecting a function but got "+s.classString(t));var r=new e(n);r._captureStackTrace(),r._pushContext();var u;if(arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],l=arguments[2];u=s.isArray(c)?a(t).apply(l,c):a(t).call(l,c)}else u=a(t)();var f=r._popContext();return o.checkForgottenReturns(u,f,"Promise.try",r),r._resolveFromSyncValue(u),r},e.prototype._resolveFromSyncValue=function(t){t===s.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e){"use strict";function n(t){return t instanceof Error&&c.getPrototypeOf(t)===Error.prototype}function r(t){var e;if(n(t)){e=new u(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var r=c.keys(t),i=0;i<r.length;++i){var s=r[i];l.test(s)||(e[s]=t[s])}return e}return o.markAsOriginatingFromRejection(t),t}function i(t,e){return function(n,i){if(null!==t){if(n){var o=r(s(n));t._attachExtraTrace(o),t._reject(o)}else if(e){var a=[].slice.call(arguments,1);t._fulfill(a)}else t._fulfill(i);t=null}}}var o=t("./util"),s=o.maybeWrapAsError,a=t("./errors"),u=a.OperationalError,c=t("./es5"),l=/^(?:name|message|stack|cause)$/;e.exports=i},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e){"use strict";e.exports=function(e){function n(t,e){var n=this;if(!o.isArray(t))return r.call(n,t,e);var i=a(e).apply(n._boundValue(),[null].concat(t));i===u&&s.throwLater(i.e)}function r(t,e){var n=this,r=n._boundValue(),i=void 0===t?a(e).call(r,null):a(e).call(r,null,t);i===u&&s.throwLater(i.e)}function i(t,e){var n=this;if(!t){var r=new Error(t+"");r.cause=t,t=r}var i=a(e).call(n._boundValue(),t);i===u&&s.throwLater(i.e)}var o=t("./util"),s=e._async,a=o.tryCatch,u=o.errorObj;e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var o=r;void 0!==e&&Object(e).spread&&(o=n),this._then(o,i,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,e){"use strict";e.exports=function(){function n(){}function r(t,e){if(null==t||t.constructor!==i)throw new m("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new m("expecting a function but got "+d.classString(e))}function i(t){t!==b&&r(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(t){this.promise._resolveCallback(t)}function s(t){this.promise._rejectCallback(t,!1)}function a(t){var e=new i(b);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}var u,c=function(){return new m("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},l=function(){return new i.PromiseInspection(this._target())},f=function(t){return i.reject(new m(t))},h={},d=t("./util");u=d.isNode?function(){var t=process.domain;return void 0===t&&(t=null),t}:function(){return null},d.notEnumerableProp(i,"_getDomain",u);var p=t("./es5"),v=t("./async"),_=new v;p.defineProperty(i,"_async",{value:_});var y=t("./errors"),m=i.TypeError=y.TypeError;i.RangeError=y.RangeError;var g=i.CancellationError=y.CancellationError;i.TimeoutError=y.TimeoutError,i.OperationalError=y.OperationalError,i.RejectionError=y.OperationalError,i.AggregateError=y.AggregateError;var b=function(){},w={},k={},x=t("./thenables")(i,b),C=t("./promise_array")(i,b,x,f,n),E=t("./context")(i),S=E.create,T=t("./debuggability")(i,E),O=t("./finally")(i,x,k),A=t("./catch_filter")(k),R=t("./nodeback"),j=d.errorObj,P=d.tryCatch;return i.prototype.toString=function(){return"[object Promise]"},i.prototype.caught=i.prototype.catch=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;n<e-1;++n){var o=arguments[n];if(!d.isObject(o))return f("Catch statement predicate: expecting an object but got "+d.classString(o));r[i++]=o}return r.length=i,t=arguments[n],this.then(void 0,A(r,t,this))}return this.then(void 0,t)},i.prototype.reflect=function(){return this._then(l,l,void 0,this,void 0)},i.prototype.then=function(t,e){if(T.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+d.classString(t);arguments.length>1&&(n+=", "+d.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},i.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},i.prototype.spread=function(t){return"function"!=typeof t?f("expecting a function but got "+d.classString(t)):this.all()._then(t,void 0,void 0,w,void 0)},i.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},i.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new C(this).promise()},i.prototype.error=function(t){return this.caught(d.originatesFromRejection,t)},i.getNewLibraryCopy=e.exports,i.is=function(t){return t instanceof i},i.fromNode=i.fromCallback=function(t){var e=new i(b);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=P(t)(R(e,n));return r===j&&e._rejectCallback(r.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},i.all=function(t){return new C(t).promise()},i.cast=function(t){var e=x(t);return e instanceof i||(e=new i(b),e._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},i.resolve=i.fulfilled=i.cast,i.reject=i.rejected=function(t){var e=new i(b);return e._captureStackTrace(),e._rejectCallback(t,!0),e},i.setScheduler=function(t){if("function"!=typeof t)throw new m("expecting a function but got "+d.classString(t));return _.setScheduler(t)},i.prototype._then=function(t,e,n,r,o){var s=void 0!==o,a=s?o:new i(b),c=this._target(),l=c._bitField;s||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&l)?this._boundValue():c===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var f=u();if(0!=(50397184&l)){var h,p,v=c._settlePromiseCtx;0!=(33554432&l)?(p=c._rejectionHandler0,h=t):0!=(16777216&l)?(p=c._fulfillmentHandler0,h=e,c._unsetRejectionIsUnhandled()):(v=c._settlePromiseLateCancellationObserver,p=new g("late cancellation observer"),c._attachExtraTrace(p),h=e),_.invoke(v,c,{handler:null===f?h:"function"==typeof h&&d.domainBind(f,h),promise:a,receiver:r,value:p})}else c._addCallbacks(t,e,a,r,f);return a},i.prototype._length=function(){return 65535&this._bitField},i.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},i.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},i.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},i.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},i.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},i.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},i.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},i.prototype._isFinal=function(){return(4194304&this._bitField)>0},i.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},i.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},i.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},i.prototype._setAsyncGuaranteed=function(){_.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},i.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==h)return void 0===e&&this._isBound()?this._boundValue():e},i.prototype._promiseAt=function(t){return this[4*t-4+2]},i.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},i.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},i.prototype._boundValue=function(){},i.prototype._migrateCallback0=function(t){var e=t._fulfillmentHandler0,n=t._rejectionHandler0,r=t._promise0,i=t._receiverAt(0);void 0===i&&(i=h),this._addCallbacks(e,n,r,i,null)},i.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),i=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=h),this._addCallbacks(n,r,i,o,null)},i.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=null===i?t:d.domainBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:d.domainBind(i,e));else{var s=4*o-4;this[s+2]=n,this[s+3]=r,"function"==typeof t&&(this[s+0]=null===i?t:d.domainBind(i,t)),"function"==typeof e&&(this[s+1]=null===i?e:d.domainBind(i,e))}return this._setLength(o+1),o},i.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},i.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(c(),!1);var n=x(t,this);if(!(n instanceof i))return this._fulfill(t);e&&this._propagateFrom(n,2);var r=n._target();if(r===this)return void this._reject(c());var o=r._bitField;if(0==(50397184&o)){var s=this._length();s>0&&r._migrateCallback0(this);for(var a=1;a<s;++a)r._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!=(33554432&o))this._fulfill(r._value());else if(0!=(16777216&o))this._reject(r._reason());else{var u=new g("late cancellation observer");r._attachExtraTrace(u),this._reject(u)}}},i.prototype._rejectCallback=function(t,e,n){var r=d.ensureErrorObject(t),i=r===t;if(!i&&!n&&T.warnings()){this._warn("a promise was rejected with a non-error: "+d.classString(t),!0)}this._attachExtraTrace(r,!!e&&i),this._reject(t)},i.prototype._resolveFromExecutor=function(t){if(t!==b){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)}},i.prototype._settlePromiseFromHandler=function(t,e,n,r){var i=r._bitField;if(0==(65536&i)){r._pushContext();var o;e===w?n&&"number"==typeof n.length?o=P(t).apply(this._boundValue(),n):(o=j,o.e=new m("cannot .spread() a non-array: "+d.classString(n))):o=P(t).call(e,n);var s=r._popContext();i=r._bitField,0==(65536&i)&&(o===k?r._reject(n):o===j?r._rejectCallback(o.e,!1):(T.checkForgottenReturns(o,s,"",r,this),r._resolveCallback(o)))}},i.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},i.prototype._followee=function(){return this._rejectionHandler0},i.prototype._setFollowee=function(t){this._rejectionHandler0=t},i.prototype._settlePromise=function(t,e,r,o){var s=t instanceof i,a=this._bitField,u=0!=(134217728&a);0!=(65536&a)?(s&&t._invokeInternalOnCancel(),r instanceof O&&r.isFinallyHandler()?(r.cancelPromise=t,P(e).call(r,o)===j&&t._reject(j.e)):e===l?t._fulfill(l.call(r)):r instanceof n?r._promiseCancelled(t):s||t instanceof C?t._cancel():r.cancel()):"function"==typeof e?s?(u&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,r,o,t)):e.call(r,o,t):r instanceof n?r._isResolved()||(0!=(33554432&a)?r._promiseFulfilled(o,t):r._promiseRejected(o,t)):s&&(u&&t._setAsyncGuaranteed(),0!=(33554432&a)?t._fulfill(o):t._reject(o))},i.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,r=t.receiver,o=t.value;"function"==typeof e?n instanceof i?this._settlePromiseFromHandler(e,r,o,n):e.call(r,o,n):n instanceof i&&n._reject(o)},i.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},i.prototype._settlePromise0=function(t,e){var n=this._promise0,r=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(n,t,r,e)},i.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},i.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=c();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!=(134217728&e)?this._settlePromises():_.settlePromises(this))}},i.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=t,this._isFinal())return _.fatalError(t,d.isNode);(65535&e)>0?_.settlePromises(this):this._ensurePossibleRejectionHandled()}},i.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},i.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},i.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!=(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},i.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},i.defer=i.pending=function(){return T.deprecated("Promise.defer","new Promise"),{promise:new i(b),resolve:o,reject:s}},d.notEnumerableProp(i,"_makeSelfResolutionError",c),t("./method")(i,b,x,f,T),t("./bind")(i,b,x,T),t("./cancel")(i,C,f,T),t("./direct_resolve")(i),t("./synchronous_inspection")(i),t("./join")(i,C,x,b,_,u),i.Promise=i,i.version="3.5.1",t("./map.js")(i,C,f,x,b,T),t("./call_get.js")(i),t("./using.js")(i,f,x,S,b,T),t("./timers.js")(i,b,T),t("./generators.js")(i,f,b,x,n,T),t("./nodeify.js")(i),t("./promisify.js")(i,b),t("./props.js")(i,C,x,f),t("./race.js")(i,b,x,f),t("./reduce.js")(i,C,f,x,b,T),t("./settle.js")(i,C,T),t("./some.js")(i,C,f),t("./filter.js")(i,b),t("./each.js")(i,b),t("./any.js")(i),d.toFastProperties(i),d.toFastProperties(i.prototype),a({a:1}),a({b:2}),a({c:3}),a(1),a(function(){}),a(void 0),a(!1),a(new i(b)),T.setBounds(v.firstLineError,d.lastLineError),i}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(t,e){"use strict";e.exports=function(e,n,r,i,o){function s(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}function a(t){var r=this._promise=new e(n);t instanceof e&&r._propagateFrom(t,3),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var u=t("./util");return u.inherits(a,o),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function t(n,o){var a=r(this._values,this._promise);if(a instanceof e){a=a._target();var c=a._bitField;if(this._values=a,0==(50397184&c))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,o);if(0==(33554432&c))return 0!=(16777216&c)?this._reject(a._reason()):this._cancel();a=a._value()}if(null===(a=u.asArray(a))){return void this._promise._rejectCallback(i("expecting an array or an iterable object but got "+u.classString(a)).reason(),!1)}if(0===a.length)return void(-5===o?this._resolveEmptyArray():this._resolve(s(o)));this._iterate(a)},a.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,s=null,a=0;a<n;++a){var u=r(t[a],i);u instanceof e?(u=u._target(),s=u._bitField):s=null,o?null!==s&&u.suppressUnhandledRejections():null!==s?0==(50397184&s)?(u._proxy(this,a),this._values[a]=u):o=0!=(33554432&s)?this._promiseFulfilled(u._value(),a):0!=(16777216&s)?this._promiseRejected(u._reason(),a):this._promiseCancelled(a):o=this._promiseFulfilled(u,a)}o||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},{"./util":36}],24:[function(t,e){"use strict";e.exports=function(e,n){function r(t){return!w.test(t)}function i(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function o(t,e,n){var r=d.getDataPropertyOrDefault(t,e+n,g);return!!r&&i(r)}function s(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new m("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}function a(t,e,n,r){for(var a=d.inheritedDataKeys(t),u=[],c=0;c<a.length;++c){var l=a[c],f=t[l],h=r===k||k(l,f,t);"function"!=typeof f||i(f)||o(t,l,e)||!r(l,f,t,h)||u.push(l,f)}return s(u,e,n),u}function u(t,r,i,o,s,a){function u(){var i=r;r===h&&(i=this);var o=new e(n);o._captureStackTrace();var s="string"==typeof l&&this!==c?this[l]:t,u=p(o,a);try{s.apply(i,v(arguments,u))}catch(t){o._rejectCallback(_(t),!0,!0)}return o._isFateSealed()||o._setAsyncGuaranteed(),o}var c=function(){return this}(),l=t;return"string"==typeof l&&(t=o),d.notEnumerableProp(u,"__isPromisified__",!0),u}function c(t,e,n,r,i){for(var o=new RegExp(x(e)+"$"),s=a(t,e,o,n),u=0,c=s.length;u<c;u+=2){var l=s[u],f=s[u+1],p=l+e;if(r===C)t[p]=C(l,h,l,f,e,i);else{var v=r(f,function(){return C(l,h,l,f,e,i)});d.notEnumerableProp(v,"__isPromisified__",!0),t[p]=v}}return d.toFastProperties(t),t}function l(t,e,n){return C(t,e,void 0,t,null,n)}var f,h={},d=t("./util"),p=t("./nodeback"),v=d.withAppended,_=d.maybeWrapAsError,y=d.canEvaluate,m=t("./errors").TypeError,g={__isPromisified__:!0},b=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],w=new RegExp("^(?:"+b.join("|")+")$"),k=function(t){return d.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},x=function(t){return t.replace(/([$])/,"\\$")},C=y?f:u;e.promisify=function(t,e){if("function"!=typeof t)throw new m("expecting a function but got "+d.classString(t));if(i(t))return t;e=Object(e);var n=void 0===e.context?h:e.context,o=!!e.multiArgs,s=l(t,n,o);return d.copyDescriptors(t,s,r),s},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new m("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");e=Object(e);var n=!!e.multiArgs,r=e.suffix;"string"!=typeof r&&(r="Async");var i=e.filter;"function"!=typeof i&&(i=k);var o=e.promisifier;if("function"!=typeof o&&(o=C),!d.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=d.inheritedDataKeys(t),a=0;a<s.length;++a){var u=t[s[a]];"constructor"!==s[a]&&d.isClass(u)&&(c(u.prototype,r,i,o,n),c(u,r,i,o,n))}return c(t,r,i,o,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e){"use strict";e.exports=function(e,n,r,i){function o(t){var e,n=!1;if(void 0!==a&&t instanceof a)e=f(t),n=!0;else{var r=l.keys(t),i=r.length;e=new Array(2*i);for(var o=0;o<i;++o){var s=r[o];e[o]=t[s],e[o+i]=s}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function s(t){var n,s=r(t);return c(s)?(n=s instanceof e?s._then(e.props,void 0,void 0,void 0,void 0):new o(s).promise(),s instanceof e&&n._propagateFrom(s,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var a,u=t("./util"),c=u.isObject,l=t("./es5");"function"==typeof Map&&(a=Map);var f=function(){function t(t,r){this[e]=t,this[e+n]=r,e++}var e=0,n=0;return function(r){n=r.size,e=0;var i=new Array(2*r.size);return r.forEach(t,i),i}}(),h=function(t){for(var e=new a,n=t.length/2|0,r=0;r<n;++r){e.set(t[n+r],t[r])}return e};u.inherits(o,n),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){var n;if(this._isMap)n=h(this._values);else{n={};for(var r=this.length(),i=0,o=this.length();i<o;++i)n[this._values[i+r]]=this._values[i]}return this._resolve(n),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return s(this)},e.props=function(t){return s(t)}}},{"./es5":13,"./util":36}],26:[function(t,e){"use strict";function n(t,e,n,r,i){for(var o=0;o<i;++o)n[o+r]=t[o+e],t[o+e]=void 0}function r(t){this._capacity=t,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},r.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,n(this,0,this,e,this._front+this._length&e-1)},e.exports=r},{}],27:[function(t,e){"use strict";e.exports=function(e,n,r,i){function o(t,o){var u=r(t);if(u instanceof e)return a(u);if(null===(t=s.asArray(t)))return i("expecting an array or an iterable object but got "+s.classString(t));var c=new e(n);void 0!==o&&c._propagateFrom(o,3);for(var l=c._fulfill,f=c._reject,h=0,d=t.length;h<d;++h){var p=t[h];(void 0!==p||h in t)&&e.cast(p)._then(l,f,void 0,c,null)}return c}var s=t("./util"),a=function(t){return t.then(function(e){return o(e,t)})};e.race=function(t){return o(t,void 0)},e.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(t,e){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r,i){this.constructor$(t);var s=h();this._fn=null===s?n:d.domainBind(s,n),void 0!==r&&(r=e.resolve(r),r._attachCancellationCallback(this)),this._initialValue=r,this._currentCancellable=null,this._eachValues=i===o?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function u(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function c(t,e,n,i){return"function"!=typeof e?r("expecting a function but got "+d.classString(e)):new a(t,e,n,i).promise()}function l(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(f,void 0,void 0,this,void 0)):f.call(this,n)}function f(t){var n=this.array,r=n._promise,i=p(n._fn);r._pushContext();var o;(o=void 0!==n._eachValues?i.call(r._boundValue(),t,this.index,this.length):i.call(r._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(n._currentCancellable=o);var a=r._popContext();return s.checkForgottenReturns(o,a,void 0!==n._eachValues?"Promise.each":"Promise.reduce",r),o}var h=e._getDomain,d=t("./util"),p=d.tryCatch;d.inherits(a,n),a.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==o&&this._eachValues.push(t)},a.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},a.prototype._init=function(){},a.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},a.prototype.shouldCopyValues=function(){return!1},a.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},a.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},a.prototype._iterate=function(t){this._values=t;var n,r,i=t.length;if(void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n,!n.isRejected())for(;r<i;++r){var o={accum:null,value:t[r],index:r,length:i,array:this};n=n._then(l,void 0,void 0,o,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(u,u,void 0,n,this)},e.prototype.reduce=function(t,e){return c(this,t,e,null)},e.reduce=function(t,e,n,r){return c(t,e,n,r)}}},{"./util":36}],29:[function(t,n){"use strict";var r,i=t("./util"),o=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},s=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var a=e.setImmediate,u=process.nextTick;r=i.isRecentNode?function(t){a.call(e,t)}:function(t){u.call(process,t)}}else if("function"==typeof s&&"function"==typeof s.resolve){var c=s.resolve();r=function(t){c.then(t)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:o:function(){var t=document.createElement("div"),e={attributes:!0},n=!1,r=document.createElement("div");new MutationObserver(function(){t.classList.toggle("foo"),n=!1}).observe(r,e);var i=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver(function(){r.disconnect(),n()});r.observe(t,e),i()}}();n.exports=r},{"./util":36}],30:[function(t,e){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t)}var o=e.PromiseInspection;t("./util").inherits(i,n),i.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(t,e){var n=new o;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},i.prototype._promiseRejected=function(t,e){var n=new o;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new i(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(t,e){if((0|e)!==e||e<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new i(t),o=n.promise();return n.setHowMany(e),n.init(),o}var s=t("./util"),a=t("./errors").RangeError,u=t("./errors").AggregateError,c=s.isArray,l={};s.inherits(i,n),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=c(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(t){this._howMany=t},i.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this._resolve(1===this.howMany()&&this._unwrap?this._values[0]:this._values),!0)},i.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},i.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(l),this._checkOutcome())},i.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new u,e=this.length();e<this._values.length;++e)this._values[e]!==l&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(t){this._values.push(t)},i.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(t){return new a("Input array must contain at least "+this._howMany+" items but contains only "+t+" items")},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return o(t,e)},e.prototype.some=function(t){return o(this,t)},e._SomePromiseArray=i}},{"./errors":12,"./util":36}],32:[function(t,e){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},s=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e){"use strict";e.exports=function(e,n){function r(t,r){if(l(t)){if(t instanceof e)return t;var i=o(t);if(i===c){r&&r._pushContext();var u=e.reject(i.e);return r&&r._popContext(),u}if("function"==typeof i){if(s(t)){var u=new e(n);return t._then(u._fulfill,u._reject,void 0,u,null),u}return a(t,i,r)}}return t}function i(t){return t.then}function o(t){try{return i(t)}catch(t){return c.e=t,c}}function s(t){try{return f.call(t,"_promise0")}catch(t){return!1}}function a(t,r,i){function o(t){a&&(a._resolveCallback(t),a=null)}function s(t){a&&(a._rejectCallback(t,f,!0),a=null)}var a=new e(n),l=a;i&&i._pushContext(),a._captureStackTrace(),i&&i._popContext();var f=!0,h=u.tryCatch(r).call(t,o,s);return f=!1,a&&h===c&&(a._rejectCallback(h.e,!0,!0),a=null),l}var u=t("./util"),c=u.errorObj,l=u.isObject,f={}.hasOwnProperty;return r}},{"./util":36}],34:[function(t,e){"use strict";e.exports=function(e,n,r){function i(t){this.handle=t}function o(t){return clearTimeout(this.handle),t}function s(t){throw clearTimeout(this.handle),t}var a=t("./util"),u=e.TimeoutError;i.prototype._resultCancelled=function(){clearTimeout(this.handle)};var c=function(t){return l(+this).thenReturn(t)},l=e.delay=function(t,o){var s,a;return void 0!==o?(s=e.resolve(o)._then(c,null,null,t,void 0),r.cancellation()&&o instanceof e&&s._setOnCancel(o)):(s=new e(n),a=setTimeout(function(){s._fulfill()},+t),r.cancellation()&&s._setOnCancel(new i(a)),s._captureStackTrace()),s._setAsyncGuaranteed(),s};e.prototype.delay=function(t){return l(t,this)};var f=function(t,e,n){var r;r="string"!=typeof e?e instanceof Error?e:new u("operation timed out"):new u(e),a.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=n&&n.cancel()};e.prototype.timeout=function(t,e){t=+t;var n,a,u=new i(setTimeout(function(){n.isPending()&&f(n,e,a)},t));return r.cancellation()?(a=this.then(),n=a._then(o,s,void 0,u,void 0),n._setOnCancel(u)):n=this._then(o,s,void 0,u,void 0),n}}},{"./util":36}],35:[function(t,e){"use strict";e.exports=function(e,n,r,i,o,s){function a(t){setTimeout(function(){throw t},0)}function u(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function c(t,n){function i(){if(s>=c)return l._fulfill();var o=u(t[s++]);if(o instanceof e&&o._isDisposable()){try{o=r(o._getDisposer().tryDispose(n),t.promise)}catch(t){return a(t)}if(o instanceof e)return o._then(i,a,null,null,null)}i()}var s=0,c=t.length,l=new e(o);return i(),l}function l(t,e,n){this._data=t,this._promise=e,this._context=n}function f(t,e,n){this.constructor$(t,e,n)}function h(t){return l.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function d(t){this.length=t,this.promise=null,this[t-1]=null}var p=t("./util"),v=t("./errors").TypeError,_=t("./util").inherits,y=p.errorObj,m=p.tryCatch,g={};l.prototype.data=function(){return this._data},l.prototype.promise=function(){return this._promise},l.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():g},l.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=e!==g?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},l.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},_(f,l),f.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},d.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(t<2)return n("you must pass at least 2 arguments to Promise.using");var i=arguments[t-1];if("function"!=typeof i)return n("expecting a function but got "+p.classString(i));var o,a=!0;2===t&&Array.isArray(arguments[0])?(o=arguments[0],t=o.length,a=!1):(o=arguments,t--);for(var u=new d(t),f=0;f<t;++f){var v=o[f];if(l.isDisposer(v)){var _=v;v=v.promise(),v._setDisposable(_)}else{var g=r(v);g instanceof e&&(v=g._then(h,null,null,{resources:u,index:f},void 0))}u[f]=v}for(var b=new Array(u.length),f=0;f<b.length;++f)b[f]=e.resolve(u[f]).reflect();var w=e.all(b).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return y.e=n.error(),y;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}k._pushContext(),i=m(i);var r=a?i.apply(void 0,t):i(t),o=k._popContext();return s.checkForgottenReturns(r,o,"Promise.using",k),r}),k=w.lastly(function(){var t=new e.PromiseInspection(w);return c(u,t)});return u.promise=k,k._setOnCancel(u),k},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new f(t,this,i());throw new v}}},{"./errors":12,"./util":36}],36:[function(t,n,r){"use strict";function i(){try{var t=R;return R=null,t.apply(this,arguments)}catch(t){return A.e=t,A}}function o(t){return R=t,i}function s(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function a(t){return"function"==typeof t||"object"==typeof t&&null!==t}function u(t){return s(t)?new Error(y(t)):t}function c(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;n<r;++n)i[n]=t[n];return i[n]=e,i}function l(t,e,n){if(!T.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function f(t,e,n){return s(t)?t:(T.defineProperty(t,e,{value:n,configurable:!0,enumerable:!1,writable:!0}),t)}function h(t){throw t}function d(t){try{if("function"==typeof t){var e=T.names(t.prototype),n=T.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=F.test(t+"")&&T.names(t).length>0;if(n||r||i)return!0}return!1}catch(t){return!1}}function p(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t}function v(t){return M.test(t)}function _(t,e,n){for(var r=new Array(t),i=0;i<t;++i)r[i]=e+i+n;return r}function y(t){try{return t+""}catch(t){return"[no string representation]"}}function m(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function g(t){try{f(t,"isOperational",!0)}catch(t){}}function b(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function w(t){return m(t)&&T.propertyIsWritable(t,"stack")}function k(t){return{}.toString.call(t)}function x(t,e,n){for(var r=T.names(t),i=0;i<r.length;++i){var o=r[i];if(n(o))try{T.defineProperty(e,o,T.getDescriptor(t,o))}catch(t){}}}function C(t){return B?process.env[t]:void 0}function E(){if("function"==typeof Promise)try{if("[object Promise]"==={}.toString.call(new Promise(function(){})))return Promise}catch(t){}}function S(t,e){return t.bind(e)}var T=t("./es5"),O="undefined"==typeof navigator,A={e:{}},R,j="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:void 0!==this?this:null,P=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var r={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n},I=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(T.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],i=Object.create(null);null!=t&&!e(t);){var o;try{o=n(t)}catch(t){return r}for(var s=0;s<o.length;++s){var a=o[s];if(!i[a]){i[a]=!0;var u=Object.getOwnPropertyDescriptor(t,a);null!=u&&null==u.get&&null==u.set&&r.push(a)}}t=T.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var i=[];t:for(var o in n)if(r.call(n,o))i.push(o);else{for(var s=0;s<t.length;++s)if(r.call(t[s],o))continue t;i.push(o)}return i}}(),F=/this\s*\.\s*\S+\s*=/,M=/^[a-z$_][a-z$_0-9]*$/i,L=function(){return"stack"in new Error?function(t){return w(t)?t:new Error(y(t))}:function(t){if(w(t))return t;try{throw new Error(y(t))}catch(t){return t}}}(),D=function(t){return T.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var N="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};D=function(t){return T.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?N(t):null}}var U="undefined"!=typeof process&&"[object process]"===k(process).toLowerCase(),B="undefined"!=typeof process&&void 0!==process.env,q={isClass:d,isIdentifier:v,inheritedDataKeys:I,getDataPropertyOrDefault:l,thrower:h,isArray:T.isArray,asArray:D,notEnumerableProp:f,isPrimitive:s,isObject:a,isError:m,canEvaluate:O,errorObj:A,tryCatch:o,inherits:P,withAppended:c,maybeWrapAsError:u,toFastProperties:p,filledRange:_,toString:y,canAttachTrace:w,ensureErrorObject:L,originatesFromRejection:b,markAsOriginatingFromRejection:g,classString:k,copyDescriptors:x,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:U,hasEnvVariables:B,env:C,global:j,getNativePromise:E,domainBind:S};q.isRecentNode=q.isNode&&function(){var t=process.versions.node.split(".").map(Number);return 0===t[0]&&t[1]>10||t[0]>0}(),q.isNode&&q.toFastProperties(process);try{throw new Error}catch(t){q.lastLineError=t}n.exports=q},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(e,n("h6ac"))},g31e:function(t){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},g7Jl:function(t,e,n){function r(t,e,n,r){n=n||"";var i=u.format.apply(this,[n].concat(r)),o=new t(i);throw Error.captureStackTrace(o,e),o}function i(t,e,n){r(c.IllegalArgumentError,t,e,n)}function o(t,e,n){r(c.IllegalStateError,t,e,n)}function s(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array"}return e}function a(t){return function(e,n){var r=s(e);if(r==t)return e;i(arguments.callee,n||'Expected "'+t+'" but got "'+r+'".',Array.prototype.slice.call(arguments,2))}}var u=n("gfUn"),c=t.exports=n("AgUv");t.exports.checkArgument=function(t,e){t||i(arguments.callee,e,Array.prototype.slice.call(arguments,2))},t.exports.checkState=function(t,e){t||o(arguments.callee,e,Array.prototype.slice.call(arguments,2))},t.exports.checkIsDef=function(t,e){if(void 0!==t)return t;i(arguments.callee,e||"Expected value to be defined but was undefined.",Array.prototype.slice.call(arguments,2))},t.exports.checkIsDefAndNotNull=function(t,e){if(null!=t)return t;i(arguments.callee,e||'Expected value to be defined and not null but got "'+s(t)+'".',Array.prototype.slice.call(arguments,2))},t.exports.checkIsString=a("string"),t.exports.checkIsArray=a("array"),t.exports.checkIsNumber=a("number"),t.exports.checkIsBoolean=a("boolean"),t.exports.checkIsFunction=a("function"),t.exports.checkIsObject=a("object")},gc0D:function(t,e,n){t.exports={default:n("vcHl"),__esModule:!0}},gfUn:function(t,e,n){(function(t){function r(t,n){var r={seen:[],stylize:o};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&e._extend(r,n),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),a(r,t,r.depth)}function i(t,e){var n=r.styles[e];return n?"["+r.colors[n][0]+"m"+t+"["+r.colors[n][1]+"m":t}function o(t){return t}function s(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function a(t,n,r){if(t.customInspect&&n&&E(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return m(i)||(i=a(t,i,r)),i}var o=u(t,n);if(o)return o;var p=Object.keys(n),v=s(p);if(t.showHidden&&(p=Object.getOwnPropertyNames(n)),C(n)&&(p.indexOf("message")>=0||p.indexOf("description")>=0))return c(n);if(0===p.length){if(E(n)){return t.stylize("[Function"+(n.name?": "+n.name:"")+"]","special")}if(w(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(x(n))return t.stylize(Date.prototype.toString.call(n),"date");if(C(n))return c(n)}var _="",y=!1,g=["{","}"];if(d(n)&&(y=!0,g=["[","]"]),E(n)){_=" [Function"+(n.name?": "+n.name:"")+"]"}if(w(n)&&(_=" "+RegExp.prototype.toString.call(n)),x(n)&&(_=" "+Date.prototype.toUTCString.call(n)),C(n)&&(_=" "+c(n)),0===p.length&&(!y||0==n.length))return g[0]+_+g[1];if(r<0)return w(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var b;return b=y?l(t,n,r,v,p):p.map(function(e){return f(t,n,r,v,e,y)}),t.seen.pop(),h(b,_,g)}function u(t,e){if(b(e))return t.stylize("undefined","undefined");if(m(e)){return t.stylize("'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'","string")}return y(e)?t.stylize(""+e,"number"):p(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,n,r,i){for(var o=[],s=0,a=e.length;s<a;++s)o.push(R(e,String(s))?f(t,e,n,r,String(s),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(t,e,n,r,i,!0))}),o}function f(t,e,n,r,i,o){var s,u,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?u=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(u=t.stylize("[Setter]","special")),R(r,i)||(s="["+i+"]"),u||(t.seen.indexOf(c.value)<0?(u=v(n)?a(t,c.value,null):a(t,c.value,n-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n"))):u=t.stylize("[Circular]","special")),b(s)){if(o&&i.match(/^\d+$/))return u;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+u}function h(t,e,n){var r=0;return t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function v(t){return null===t}function _(t){return null==t}function y(t){return"number"==typeof t}function m(t){return"string"==typeof t}function g(t){return"symbol"==typeof t}function b(t){return void 0===t}function w(t){return k(t)&&"[object RegExp]"===T(t)}function k(t){return"object"==typeof t&&null!==t}function x(t){return k(t)&&"[object Date]"===T(t)}function C(t){return k(t)&&("[object Error]"===T(t)||t instanceof Error)}function E(t){return"function"==typeof t}function S(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t}function T(t){return Object.prototype.toString.call(t)}function O(t){return t<10?"0"+t.toString(10):t.toString(10)}function A(){var t=new Date,e=[O(t.getHours()),O(t.getMinutes()),O(t.getSeconds())].join(":");return[t.getDate(),F[t.getMonth()],e].join(" ")}function R(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var j=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(r(arguments[n]));return e.join(" ")}for(var n=1,i=arguments,o=i.length,s=String(t).replace(j,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}}),a=i[n];n<o;a=i[++n])v(a)||!k(a)?s+=" "+a:s+=" "+r(a);return s},e.deprecate=function(n,r){function i(){if(!o){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}if(b(t.process))return function(){return e.deprecate(n,r).apply(this,arguments)};if(!0===process.noDeprecation)return n;var o=!1;return i};var P,I={};e.debuglog=function(t){if(b(P)&&(P=process.env.NODE_DEBUG||""),t=t.toUpperCase(),!I[t])if(new RegExp("\\b"+t+"\\b","i").test(P)){var n=process.pid;I[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else I[t]=function(){};return I[t]},e.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=p,e.isNull=v,e.isNullOrUndefined=_,e.isNumber=y,e.isString=m,e.isSymbol=g,e.isUndefined=b,e.isRegExp=w,e.isObject=k,e.isDate=x,e.isError=C,e.isFunction=E,e.isPrimitive=S,e.isBuffer=n("vexR");var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",A(),e.format.apply(e,arguments))},e.inherits=n("tcrG"),e._extend=function(t,e){if(!e||!k(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(e,n("h6ac"))},gjjs:function(t,e,n){var r=n("Gfzd"),i=n("zotD"),o=n("knrM");t.exports=n("6MLN")?Object.defineProperties:function(t,e){i(t);for(var n,s=o(e),a=s.length,u=0;a>u;)r.f(t,n=s[u++],e[n]);return t}},gkZy:function(t,e,n){t.exports={default:n("TEgB"),__esModule:!0}},gojl:function(t,e,n){t.exports=n("akPY")},h6ac:function(t){var e;e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(e=window)}t.exports=e},hEIm:function(t,e,n){var r=n("zotD");t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},hVVj:function(t,e,n){function r(t,e,n){var r=e&&n||0,i=e||[];t=t||{};var s=void 0!==t.clockseq?t.clockseq:u,f=void 0!==t.msecs?t.msecs:(new Date).getTime(),h=void 0!==t.nsecs?t.nsecs:l+1,d=f-c+(h-l)/1e4;if(d<0&&void 0===t.clockseq&&(s=s+1&16383),(d<0||f>c)&&void 0===t.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=f,l=h,u=s,f+=122192928e5;var p=(1e4*(268435455&f)+h)%4294967296;i[r++]=p>>>24&255,i[r++]=p>>>16&255,i[r++]=p>>>8&255,i[r++]=255&p;var v=f/4294967296*1e4&268435455;i[r++]=v>>>8&255,i[r++]=255&v,i[r++]=v>>>24&15|16,i[r++]=v>>>16&255,i[r++]=s>>>8|128,i[r++]=255&s;for(var _=t.node||a,y=0;y<6;++y)i[r+y]=_[y];return e||o(i)}var i=n("f+DB"),o=n("dAjQ"),s=i(),a=[1|s[0],s[1],s[2],s[3],s[4],s[5]],u=16383&(s[6]<<8|s[7]),c=0,l=0;t.exports=r},hYHi:function(t,e,n){function r(t,e,n){var r=e&&n||0;"string"==typeof t&&(e="binary"==t?new Array(16):null,t=null),t=t||{};var s=t.random||(t.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[r+a]=s[a];return e||o(s)}var i=n("f+DB"),o=n("dAjQ");t.exports=r},htFH:function(t,e,n){var r=n("vSO4");r(r.S+r.F*!n("6MLN"),"Object",{defineProperty:n("Gfzd").f})},hznj:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("T4f3"),o=r(i),s=n("aIIw"),a=r(s),u=n("BX4+"),c=r(u),l=n("dACh"),f=r(l),h=n("jx4H"),d=r(h),p=n("VOrx"),v=r(p),_=n("ZKjc"),y=r(_),m=n("L3Vt"),g=r(m),b=function(t,e,n,r){return new(n||(n=g.default))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var w=n("E56Z"),k=n("GBRx"),x=n("b0lL"),C=n("/lpw"),E=n("PD3G"),S=function(t){function e(t,n,r){(0,f.default)(this,e);var i=(0,v.default)(this,(e.__proto__||(0,c.default)(e)).call(this,t,r));return i.actionQueue=new C.RetryingQueue,i.descriptor=n,i.descriptor.data=i.descriptor.data||{},i}return(0,y.default)(e,t),(0,d.default)(e,[{key:"_update",value:function(t){switch(t.type){case"document_updated":if(t.id>this.lastEventId){var e=this.descriptor.data;this.descriptor.last_event_id=t.id,this.descriptor.revision=t.document_revision,this.descriptor.data=t.document_data,this.traverse(e,t.document_data,!1),this.emit("updated",t.document_data,!1),this.emit("updatedRemotely",t.document_data),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:t.id,revision:t.document_revision,data:t.document_data})}break;case"document_removed":this.onRemoved(!1)}}},{key:"traverse",value:function(t,e,n){var r=this;x.createPatch(t,e).forEach(function(t){"add"===t.op?(r.emit("keyAdded",t.path,t.value,n),n||r.emit("keyAddedRemotely",t.path,t.value)):"replace"===t.op?(r.emit("keyUpdated",t.path,t.value,n),n||r.emit("keyUpdatedRemotely",t.path,t.value)):"remove"===t.op&&(r.emit("keyRemoved",t.path,n),n||r.emit("keyRemovedRemotely",t.path))})}},{key:"get",value:function(){return this.value}},{key:"set",value:function(t,e){return this._actualSet(t,e?function(){throw new Error("Revision mismatch")}:null)}},{key:"_actualSet",value:function(t,e){var n=this,r=void 0,i={data:t,revision:e?this.revision:void 0};return e&&(r=function(t){return b(n,void 0,void 0,a.default.mark(function n(){return a.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(412!==t.status){n.next=4;break}return n.next=3,this.softSync();case 3:return n.abrupt("return",{revision:this.revision,data:e(E.deepClone(this.value))});case 4:throw t;case 5:case"end":return n.stop()}},n,this)}))}),this.actionQueue.add(this._set.bind(this),this.uri,i,r).then(function(t){return t.last_event_id>n.descriptor.last_event_id&&(n.descriptor.revision=t.revision,n.descriptor.data=t.data,n.descriptor.last_event_id=t.last_event_id,n.services.storage.update(n.type,n.sid,n.uniqueName,{last_event_id:t.last_event_id,revision:t.revision,data:t.data})),n.emit("updated",n.value,!0),n.value})}},{key:"mutate",value:function(t){return b(this,void 0,void 0,a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._actualSet(t(E.deepClone(this.value)),t));case 1:case"end":return e.stop()}},e,this)}))}},{key:"update",value:function(t){return this.mutate(function(e){return(0,o.default)(e,t)})}},{key:"_set",value:function(t,e){return b(this,void 0,void 0,a.default.mark(function t(){var n;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.services.network.post(this.uri,{data:e.data},e.revision);case 2:return n=t.sent,t.abrupt("return",{revision:n.body.revision,data:e.data,last_event_id:n.body.last_event_id});case 4:case"end":return t.stop()}},t,this)}))}},{key:"softSync",value:function(){var t=this;return this.services.network.get(this.uri).then(function(e){return t._update({type:"document_updated",id:e.body.last_event_id,document_revision:e.body.revision,document_data:e.body.data}),t}).catch(function(e){404===e.status?t.onRemoved(!1):w.default.error("Can't get updates for "+t.sid+":",e)})}},{key:"onRemoved",value:function(t){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.emit("removed",t),t||this.emit("removedRemotely")}},{key:"removeDocument",value:function(){return b(this,void 0,void 0,a.default.mark(function t(){return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return t.stop()}},t,this)}))}},{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"value",get:function(){return this.descriptor.data}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"type",get:function(){return"document"}}],[{key:"type",get:function(){return"document"}}]),e}(k.SyncEntity);e.SyncDocument=S,e.default=S},"i+u+":function(t,e,n){"use strict";var r=n("lytE")(!0);n("uRfg")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},"i/BB":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n("FRpO"),o=function(t){function e(e){var n=t.call(this)||this;return n.minDelay=e.min,n.maxDelay=e.max,n.initialDelay=e.initial||0,n.maxAttemptsCount=e.maxAttemptsCount||0,n.maxAttemptsTime=e.maxAttemptsTime||0,n.randomness=e.randomness||0,n.inProgress=!1,n.attemptNum=0,n.prevDelay=0,n.currDelay=0,n}return r(e,t),e.prototype.attempt=function(){clearTimeout(this.timeout),this.attemptNum++,this.timeout=null,this.emit("attempt",this)},e.prototype.nextDelay=function(t){if("number"==typeof t)return this.prevDelay=0,this.currDelay=t,t;if(0==this.attemptNum)return this.initialDelay;if(1==this.attemptNum)return this.currDelay=this.minDelay;var e=this.currDelay+this.prevDelay;return this.prevDelay=this.currDelay,this.currDelay=e,e},e.prototype.randomize=function(t){var e=t*this.randomness,n=Math.round(Math.random()*e*2-e);return Math.max(0,t+n)},e.prototype.scheduleAttempt=function(t){var e=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount)return this.cleanup(),this.emit("failed",new Error("Maximum attempt count limit reached")),void this.reject(new Error("Maximum attempt count reached"));var n=this.nextDelay(t);n=this.randomize(n),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+n&&(this.cleanup(),this.emit("failed",new Error("Maximum attempt time limit reached")),this.reject(new Error("Maximum attempt time limit reached"))),this.timeout=setTimeout(function(){return e.attempt()},n)},e.prototype.cleanup=function(){clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0},e.prototype.start=function(){var t=this;if(this.inProgress)throw new Error("Retrier is already in progress");return this.inProgress=!0,new Promise(function(e,n){t.resolve=e,t.reject=n,t.startTimestamp=Date.now(),t.scheduleAttempt(t.initialDelay)})},e.prototype.cancel=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"),this.reject(new Error("Cancelled")))},e.prototype.succeeded=function(t){this.emit("succeeded",t),this.resolve(t)},e.prototype.failed=function(t,e){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(e)},e.prototype.run=function(t){var e=this;return this.on("attempt",function(){t().then(function(t){return e.succeeded(t)}).catch(function(t){return e.failed(t)})}),this.start()},e}(i.EventEmitter);e.Retrier=o,e.default=o},i1Q6:function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},iSVM:function(t,e,n){"use strict";function r(t){return t.split("\r\n").map(function(t){return t.split(": ")}).filter(function(t){return 2===t.length&&t[1].length>0}).reduce(function(t,e){return t[e[0]]=e[1],t},{})}function i(t){var e=t.getResponseHeader("Content-Type");if(!e||0!==e.indexOf("application/json")||0===t.responseText.length)return t.responseText;try{return JSON.parse(t.responseText)}catch(e){return t.responseText}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s="undefined"==typeof XMLHttpRequest?n(1).XMLHttpRequest:XMLHttpRequest,a=function(){function t(){}return o(t,null,[{key:"request",value:function(t,e){return new Promise(function(n,o){var a=new s;a.open(t,e.url,!0),a.onreadystatechange=function(){if(4===a.readyState){var t=r(a.getAllResponseHeaders()),e=i(a);200<=a.status&&a.status<300?n({status:a.status,headers:t,body:e}):o({status:a.status,description:a.statusText,headers:t,body:e})}};for(var u in e.headers)a.setRequestHeader(u,e.headers[u]),"Content-Type"===u&&"application/json"===e.headers[u]&&(e.body=JSON.stringify(e.body));a.send(e.body)})}},{key:"get",value:function(t){return this.request("GET",t)}},{key:"post",value:function(t){return this.request("POST",t)}},{key:"put",value:function(t){return this.request("PUT",t)}},{key:"delete",value:function(t){return this.request("DELETE",t)}}]),t}();e.default=a,t.exports=a,t.exports=e.default},ibPW:function(t,e,n){t.exports={default:n("Ky5l"),__esModule:!0}},jx4H:function(t,e,n){"use strict";e.__esModule=!0;var r=n("FFZn"),i=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()},knrM:function(t,e,n){var r=n("B9Lq"),i=n("KxjL");t.exports=Object.keys||function(t){return r(t,i)}},kohK:function(t,e,n){(function(t,r){var i;(function(){"use strict";function o(t){return t=String(t),t.charAt(0).toUpperCase()+t.slice(1)}function s(t,e,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return e&&n&&/^Win/i.test(t)&&!/^Windows Phone /i.test(t)&&(r=r[/[\d.]+$/.exec(t)])&&(t="Windows "+r),t=String(t),e&&n&&(t=t.replace(RegExp(e,"i"),n)),t=u(t.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function a(t,e){var n=-1,r=t?t.length:0;if("number"==typeof r&&r>-1&&r<=k)for(;++n<r;)e(t[n],n,t);else c(t,e)}function u(t){return t=p(t),/^(?:webOS|i(?:OS|P))/.test(t)?t:o(t)}function c(t,e){for(var n in t)S.call(t,n)&&e(t[n],n,t)}function l(t){return null==t?o(t):T.call(t).slice(8,-1)}function f(t,e){var n=null!=t?typeof t[e]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(n)||"object"==n&&!t[e])}function h(t){return String(t).replace(/([ -])(?!$)/g,"$1?")}function d(t,e){var n=null;return a(t,function(r,i){n=e(n,r,i,t)}),n}function p(t){return String(t).replace(/^ +| +$/g,"")}function v(t){function e(e){return d(e,function(e,n){var r=n.pattern||h(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=u(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e})}function n(){return this.description||""}var r=y,i=t&&"object"==typeof t&&"String"!=l(t);i&&(r=t,t=null);var o=r.navigator||{},a=o.userAgent||"";t||(t=a);var _,g,b=i||C==m,w=i?!!o.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(T.toString()),k=i?"Object":"ScriptBridgingProxyObject",E=i?"Object":"Environment",S=i&&r.java?"JavaPackage":l(r.java),O=i?"Object":"RuntimeObject",A=/\bJava/.test(S)&&r.java,R=A&&l(r.environment)==E,j=A?"a":"",P=A?"b":"",I=r.document||{},F=r.operamini||r.opera,M=x.test(M=i&&F?F["[[Class]]"]:l(F))?M:F=null,L=t,D=[],N=null,U=t==a,B=U&&F&&"function"==typeof F.version&&F.version(),q=function(e){return d(e,function(e,n){return e||RegExp("\\b"+(n.pattern||h(n))+"\\b","i").exec(t)&&(n.label||n)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),z=function(e){return d(e,function(e,n){return e||RegExp("\\b"+(n.pattern||h(n))+"\\b","i").exec(t)&&(n.label||n)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),H=e([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),V=function(e){return d(e,function(e,n,r){return e||(n[H]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(H)]||RegExp("\\b"+h(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),W=function(e){return d(e,function(e,n){var r=n.pattern||h(n);return!e&&(e=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=s(e,r,n.label||n)),e})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(q&&(q=[q]),V&&!H&&(H=e([V])),(_=/\bGoogle TV\b/.exec(H))&&(H=_[0]),/\bSimulator\b/i.test(t)&&(H=(H?H+" ":"")+"Simulator"),"Opera Mini"==z&&/\bOPiOS\b/.test(t)&&D.push("running in Turbo/Uncompressed mode"),"IE"==z&&/\blike iPhone OS\b/.test(t)?(_=v(t.replace(/like iPhone OS/,"")),V=_.manufacturer,H=_.product):/^iP/.test(H)?(z||(z="Safari"),W="iOS"+((_=/ OS ([\d_]+)/i.exec(t))?" "+_[1].replace(/_/g,"."):"")):"Konqueror"!=z||/buntu/i.test(W)?V&&"Google"!=V&&(/Chrome/.test(z)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(H))||/\bAndroid\b/.test(W)&&/^Chrome/.test(z)&&/\bVersion\//i.test(t)?(z="Android Browser",W=/\bAndroid\b/.test(W)?W:"Android"):"Silk"==z?(/\bMobi/i.test(t)||(W="Android",D.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&D.unshift("accelerated")):"PaleMoon"==z&&(_=/\bFirefox\/([\d.]+)\b/.exec(t))?D.push("identifying as Firefox "+_[1]):"Firefox"==z&&(_=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(W||(W="Firefox OS"),H||(H=_[1])):!z||(_=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(z))?(z&&!H&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(_+"/")+8))&&(z=null),(_=H||V||W)&&(H||V||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(W))&&(z=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(W)?W:_)+" Browser")):"Electron"==z&&(_=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&D.push("Chromium "+_):W="Kubuntu",B||(B=function(e){return d(e,function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null})}(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",h(z),"(?:Firefox|Minefield|NetFront)"])),(_="iCab"==q&&parseFloat(B)>3&&"WebKit"||/\bOpera\b/.test(z)&&(/\bOPR\b/.test(t)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(q)&&"WebKit"||!q&&/\bMSIE\b/i.test(t)&&("Mac OS"==W?"Tasman":"Trident")||"WebKit"==q&&/\bPlayStation\b(?! Vita\b)/i.test(z)&&"NetFront")&&(q=[_]),"IE"==z&&(_=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(z+=" Mobile",W="Windows Phone "+(/\+$/.test(_)?_:_+".x"),D.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(z="IE Mobile",W="Windows Phone 8.x",D.unshift("desktop mode"),B||(B=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=z&&"Trident"==q&&(_=/\brv:([\d.]+)/.exec(t))&&(z&&D.push("identifying as "+z+(B?" "+B:"")),z="IE",B=_[1]),U){if(f(r,"global"))if(A&&(_=A.lang.System,L=_.getProperty("os.arch"),W=W||_.getProperty("os.name")+" "+_.getProperty("os.version")),b&&f(r,"system")&&(_=[r.system])[0]){W||(W=_[0].os||null);try{_[1]=r.require("ringo/engine").version,B=_[1].join("."),z="RingoJS"}catch(t){_[0].global.system==r.system&&(z="Narwhal")}}else"object"==typeof r.process&&!r.process.browser&&(_=r.process)?"object"==typeof _.versions?"string"==typeof _.versions.electron?(D.push("Node "+_.versions.node),z="Electron",B=_.versions.electron):"string"==typeof _.versions.nw&&(D.push("Chromium "+B,"Node "+_.versions.node),z="NW.js",B=_.versions.nw):(z="Node.js",L=_.arch,W=_.platform,B=/[\d.]+/.exec(_.version),B=B?B[0]:"unknown"):R&&(z="Rhino");else l(_=r.runtime)==k?(z="Adobe AIR",W=_.flash.system.Capabilities.os):l(_=r.phantom)==O?(z="PhantomJS",B=(_=_.version||null)&&_.major+"."+_.minor+"."+_.patch):"number"==typeof I.documentMode&&(_=/\bTrident\/(\d+)/i.exec(t))?(B=[B,I.documentMode],(_=+_[1]+4)!=B[1]&&(D.push("IE "+B[1]+" mode"),q&&(q[1]=""),B[1]=_),B="IE"==z?String(B[1].toFixed(1)):B[0]):"number"==typeof I.documentMode&&/^(?:Chrome|Firefox)\b/.test(z)&&(D.push("masking as "+z+" "+B),z="IE",B="11.0",q=["Trident"],W="Windows");W=W&&u(W)}if(B&&(_=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(B)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(U&&o.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(N=/b/i.test(_)?"beta":"alpha",B=B.replace(RegExp(_+"\\+?$"),"")+("beta"==N?P:j)+(/\d+\+?/.exec(_)||"")),"Fennec"==z||"Firefox"==z&&/\b(?:Android|Firefox OS)\b/.test(W))z="Firefox Mobile";else if("Maxthon"==z&&B)B=B.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(H))"Xbox 360"==H&&(W=null),"Xbox 360"==H&&/\bIEMobile\b/.test(t)&&D.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(z)&&(!z||H||/Browser|Mobi/.test(z))||"Windows CE"!=W&&!/Mobi/i.test(t))if("IE"==z&&U)try{null===r.external&&D.unshift("platform preview")}catch(t){D.unshift("embedded")}else(/\bBlackBerry\b/.test(H)||/\bBB10\b/.test(t))&&(_=(RegExp(H.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||B)?(_=[_,/BB10/.test(t)],W=(_[1]?(H=null,V="BlackBerry"):"Device Software")+" "+_[0],B=null):this!=c&&"Wii"!=H&&(U&&F||/Opera/.test(z)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==z&&/\bOS X (?:\d+\.){2,}/.test(W)||"IE"==z&&(W&&!/^Win/.test(W)&&B>5.5||/\bWindows XP\b/.test(W)&&B>8||8==B&&!/\bTrident\b/.test(t)))&&!x.test(_=v.call(c,t.replace(x,"")+";"))&&_.name&&(_="ing as "+_.name+((_=_.version)?" "+_:""),x.test(z)?(/\bIE\b/.test(_)&&"Mac OS"==W&&(W=null),_="identify"+_):(_="mask"+_,z=M?u(M.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(_)&&(W=null),U||(B=null)),q=["Presto"],D.push(_));else z+=" Mobile";(_=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(_=[parseFloat(_.replace(/\.(\d)$/,".0$1")),_],"Safari"==z&&"+"==_[1].slice(-1)?(z="WebKit Nightly",N="alpha",B=_[1].slice(0,-1)):B!=_[1]&&B!=(_[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(B=null),_[1]=(/\bChrome\/([\d.]+)/i.exec(t)||0)[1],537.36==_[0]&&537.36==_[2]&&parseFloat(_[1])>=28&&"WebKit"==q&&(q=["Blink"]),U&&(w||_[1])?(q&&(q[1]="like Chrome"),_=_[1]||(_=_[0],_<530?1:_<532?2:_<532.05?3:_<533?4:_<534.03?5:_<534.07?6:_<534.1?7:_<534.13?8:_<534.16?9:_<534.24?10:_<534.3?11:_<535.01?12:_<535.02?"13+":_<535.07?15:_<535.11?16:_<535.19?17:_<536.05?18:_<536.1?19:_<537.01?20:_<537.11?"21+":_<537.13?23:_<537.18?24:_<537.24?25:_<537.36?26:"Blink"!=q?"27":"28")):(q&&(q[1]="like Safari"),_=_[0],_=_<400?1:_<500?2:_<526?3:_<533?4:_<534?"4+":_<535?5:_<537?6:_<538?7:_<601?8:"8"),q&&(q[1]+=" "+(_+="number"==typeof _?".x":/[.+]/.test(_)?"":"+")),"Safari"==z&&(!B||parseInt(B)>45)&&(B=_)),"Opera"==z&&(_=/\bzbov|zvav$/.exec(W))?(z+=" ",D.unshift("desktop mode"),"zvav"==_?(z+="Mini",B=null):z+="Mobile",W=W.replace(RegExp(" *"+_+"$"),"")):"Safari"==z&&/\bChrome\b/.exec(q&&q[1])&&(D.unshift("desktop mode"),z="Chrome Mobile",B=null,/\bOS X\b/.test(W)?(V="Apple",W="iOS 4.3+"):W=null),B&&0==B.indexOf(_=/[\d.]+$/.exec(W))&&t.indexOf("/"+_+"-")>-1&&(W=p(W.replace(_,""))),q&&!/\b(?:Avant|Nook)\b/.test(z)&&(/Browser|Lunascape|Maxthon/.test(z)||"Safari"!=z&&/^iOS/.test(W)&&/\bSafari\b/.test(q[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(z)&&q[1])&&(_=q[q.length-1])&&D.push(_),D.length&&(D=["("+D.join("; ")+")"]),V&&H&&H.indexOf(V)<0&&D.push("on "+V),H&&D.push((/^on /.test(D[D.length-1])?"":"on ")+H),W&&(_=/ ([\d.+]+)$/.exec(W),g=_&&"/"==W.charAt(W.length-_[0].length-1),W={architecture:32,family:_&&!g?W.replace(_[0],""):W,version:_?_[1]:null,toString:function(){var t=this.version;return this.family+(t&&!g?" "+t:"")+(64==this.architecture?" 64-bit":"")}}),(_=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(L))&&!/\bi686\b/i.test(L)?(W&&(W.architecture=64,W.family=W.family.replace(RegExp(" *"+_),"")),z&&(/\bWOW64\b/i.test(t)||U&&/\w(?:86|32)$/.test(o.cpuClass||o.platform)&&!/\bWin64; x64\b/i.test(t))&&D.unshift("32-bit")):W&&/^OS X/.test(W.family)&&"Chrome"==z&&parseFloat(B)>=39&&(W.architecture=64),t||(t=null);var K={};return K.description=t,K.layout=q&&q[0],K.manufacturer=V,K.name=z,K.prerelease=N,K.product=H,K.ua=t,K.version=z&&B,K.os=W||{architecture:null,family:null,version:null,toString:function(){return"null"}},K.parse=v,K.toString=n,K.version&&D.unshift(B),K.name&&D.unshift(z),W&&z&&(W!=String(W).split(" ")[0]||W!=z.split(" ")[0]&&!H)&&D.push(H?"("+W+")":"on "+W),D.length&&(K.description=D.join(" ")),K}var _={function:!0,object:!0},y=_[typeof window]&&window||this,m=y,g=_[typeof e]&&e,b=_[typeof t]&&t&&!t.nodeType&&t,w=g&&b&&"object"==typeof r&&r;!w||w.global!==w&&w.window!==w&&w.self!==w||(y=w);var k=Math.pow(2,53)-1,x=/\bOpera/,C=this,E=Object.prototype,S=E.hasOwnProperty,T=E.toString,O=v();y.platform=O,void 0!==(i=function(){return O}.call(e,n,e,t))&&(t.exports=i)}).call(this)}).call(e,n("l262")(t),n("h6ac"))},kthq:function(t,e,n){"use strict";(function(r){function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode("0x"+e)}).length}function s(t){var e=encodeURIComponent(t),n=e.replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode("0x"+e)}),r=new Uint8Array(n.length);return Array.prototype.forEach.call(n,function(t,e){r[e]=t.charCodeAt(0)}),r}function a(t){var e=Array.prototype.map.call(t,function(t){return String.fromCharCode(t)}).join(""),n=e.replace(/(.)/g,function(t,e){var n=e.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n});return decodeURIComponent(n)}function u(t){for(var e="",n=0;n<t.length;++n){var r=String.fromCharCode(t[n]);if(e+=r,"\r"===r){n+=2;break}}var i=e.split(" ");return{size:n,protocol:i[0],version:i[1],headerSize:Number(i[2])}}function c(t){switch(void 0===t?"undefined":(0,L.default)(t)){case"undefined":return"";case"object":return(0,F.default)(t);default:return t}}function l(t){var e=a(t);try{return JSON.parse(e)}catch(t){throw B.default.error("failed to parse input: ",e),t}}Object.defineProperty(e,"__esModule",{value:!0});var f=n("0Qy9"),h=i(f),d=n("L3Vt"),p=i(d),v=n("m8OI"),_=i(v),y=n("X9RM"),m=i(y),g=n("YZrv"),b=i(g),w=n("LlWG"),k=i(w),x=n("BX4+"),C=i(x),E=n("dACh"),S=i(E),T=n("jx4H"),O=i(T),A=n("VOrx"),R=i(A),j=n("ZKjc"),P=i(j),I=n("HxWs"),F=i(I),M=n("GyB/"),L=i(M),D=n("FRpO"),N=i(D),U=n("obon"),B=i(U),q=n("qQO4"),z=i(q),H=n("PvFw"),V=i(H),W=n("uxiv"),K=i(W),G=r.WebSocket||r.MozWebSocket||n(0),Q=function(t){function e(t){(0,S.default)(this,e);var n=(0,R.default)(this,(e.__proto__||(0,C.default)(e)).call(this));t.logLevel&&B.default.setLevel(t.logLevel);var r=V.default.exponential({randomisationFactor:.2,initialDelay:2e3,maxDelay:12e4});return r.on("ready",function(){n._retry()}),n.on("reply",function(t){n._processReply(t)}),(0,k.default)(n,{_config:{value:t},_transportReady:{value:!1,writable:!0},_disconnectedPromiseResolve:{value:null,writable:!0},_backoffDefault:{value:r},_backoff:{value:r,writable:!0},_fsm:{value:null,writable:!0},_watchTimer:{value:null,writable:!0},_timestamp:{value:0,writable:!0},_socket:{value:null,writable:!0},_activeToken:{value:null,writable:!0},activeToken:{enumerable:!0,get:function(){return n._activeToken}},state:{enumberable:!0,get:function(){return n._getState()}},isConnected:{enumberable:!0,get:function(){return n._isConnected()}},_activeRequests:{value:new b.default},_disconnectingTimer:{value:null,writable:!0},_isDeferredUpdate:{value:!1,writable:!0}}),n._fsm=K.default.create({initial:"disconnected",events:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"}],callbacks:{onconnecting:function(){n._startWatchdogTimer(),n._setupSocket(),n.emit("connecting")},onenterinitialising:function(){n._sendInit()},onleaveinitialising:function(){n._cancelInit()},onenterupdating:function(){n._sendUpdate()},onleaveupdating:function(){n._cancelUpdate()},onenterretrying:function(){n._initRetry(),n.emit("connecting")},onenterconnected:function(){n._resetBackoff(),n._onConnected()},onuserUpdateToken:function(){n._resetBackoff()},ontokenRejected:function(){n._resetBackoff(),n._closeSocket(),n._finalizeSocket()},onuserDisconnect:function(){n._closeSocket()},onenterdisconnecting:function(){n._startDisconnectTimer()},onleavedisconnecting:function(){n._cancelDisconnectTimer()},onenterwaitSocketClosed:function(){n._startDisconnectTimer()},onleavewaitSocketClosed:function(){n._cancelDisconnectTimer()},onenterwaitOffloadSocketClosed:function(){n._startDisconnectTimer()},onleavewaitOffloadSocketClosed:function(){n._cancelDisconnectTimer()},ondisconnected:function(){n._resetBackoff(),n._finalizeSocket()},onreceiveClose:function(t,e,r,i){B.default.debug("onreceiveClose: ",i),n._onCloseReceived(i)},onreceiveOffload:function(t,e,r,i){B.default.debug("onreceiveoffload: ",i),n._modifyBackoff(i.body),n._onCloseReceived(i.status)},onunsupported:function(){n._closeSocket(),n._finalizeSocket()},onerror:function(){n._closeSocket(),n._finalizeSocket()},onenterstate:function(t,e,r){n._changeState(t,e,r)}},error:function(){B.default.warn("FSM: unexpected transition",arguments)}}),n}return(0,P.default)(e,t),(0,O.default)(e,[{key:"_changeState",value:function(t,e,n){var r=this;B.default.debug("FSM: ",t,": ",e,">>",n),this.emit("stateChanged",this.state),this._isDeferredUpdate&&(this._isDeferredUpdate=!1,setTimeout(function(){r.updateToken()},0))}},{key:"_resetBackoff",value:function(){B.default.trace("_resetBackoff"),this._backoff=this._backoffDefault,this._backoff.reset()}},{key:"_modifyBackoff",value:function(t){B.default.trace("_modifyBackoff",t);var e=t?t.backoff_policy:null;if(e){var n=e.reconnect_min_ms||2e3,r=e.reconnect_max_ms||12e4;B.default.debug("new backoff policy",n,r),this._backoff=V.default.exponential({randomisationFactor:.2,initialDelay:n,maxDelay:r})}}},{key:"_startDisconnectTimer",value:function(){var t=this;B.default.trace("_startDisconnectTimer"),this._disconnectingTimer&&(clearTimeout(this._disconnectingTimer),this._disconnectingTimer=null),this._disconnectingTimer=setTimeout(function(){B.default.debug("disconnecting is timed out"),t._closeSocket()},3e3)}},{key:"_cancelDisconnectTimer",value:function(){B.default.trace("_cancelDisconnectTimer"),this._disconnectingTimer&&(clearTimeout(this._disconnectingTimer),this._disconnectingTimer=null)}},{key:"_processReply",value:function(t){B.default.debug("receive reply:",t);var e=this._activeRequests.get(t.id);if(e)switch(clearTimeout(e.timeout),this._activeRequests.delete(t.id),e.reqType){case"init":t.status.code>=200&&t.status.code<300?this._fsm.initSuccess(t.body):401===t.status.code||403===t.status.code?this._fsm.tokenRejected(t.status):429===t.status.code?(this._modifyBackoff(t.body),this._fsm.initError(t.status)):this._fsm.initError(t.status);break;case"update":t.status.code>=200&&t.status.code<300?this._fsm.updateSuccess(t.body):401===t.status.code||403===t.status.code?this._fsm.tokenRejected(t.status):429===t.status.code?(this._modifyBackoff(t.body),this._fsm.updateError(t.status)):this._fsm.updateError(t.status);break;default:B.default.error("unexpected reply")}}},{key:"_storeRequest",value:function(t,e,n){var r=this;B.default.trace("_storeRequest");var i={reqType:e,timeout:setTimeout(function(){B.default.debug("request",e,": ",t,"is timed out"),"init"!==e&&"update"!==e&&B.default.error("unknown request type",e),r._closeSocket()},n)};this._activeRequests.set(t,i)}},{key:"_isConnected",value:function(){return this.state===e.state.CONNECTED&&this._socket&&1===this._socket.readyState}},{key:"_getState",value:function(){if(!this._fsm)return e.state.DISCONNECTED;switch(this._fsm.current){case"connecting":case"initialising":case"retrying":case"error":return e.state.CONNECTING;case"updating":case"connected":return e.state.CONNECTED;case"rejected":return e.state.REJECTED;case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return e.state.DISCONNECTING;case"disconnected":default:return e.state.DISCONNECTED}}},{key:"_initRetry",value:function(){B.default.trace("_initRetry"),this._backoff.backoff()}},{key:"_retry",value:function(){B.default.trace("_retry"),this._socket=null,this._activeToken=null,this._fsm.userRetry()}},{key:"_onConnected",value:function(){this.emit("connected")}},{key:"_finalizeSocket",value:function(){if(B.default.trace("_finalizeSocket"),this._stopWatchdogTimer(),this._onDisconnected(),this._disconnectedPromiseResolve){var t=this._disconnectedPromiseResolve;this._disconnectedPromiseResolve=null,t()}}},{key:"_onDisconnected",value:function(){this._socket=null,this._activeToken=null,this.emit("disconnected")}},{key:"_setupSocket",value:function(){B.default.trace("_setupSocket:",this._config.token);var t=this,e=this._config.twilsockUri;B.default.debug("try to connect to:",e);var n=new G(e);n.binaryType="arraybuffer",n.onopen=function(){B.default.info("socket opened"),t._fsm.socketConnected()},n.onclose=function(e){B.default.info("socket closed",e),t._fsm.socketClosed()},n.onerror=function(t){B.default.error("error: ",t)},n.onmessage=function(e){B.default.trace("data: ",e.data);var n=new Uint8Array(e.data),r=u(n);if("TWILSOCK"!==r.protocol||"V3.0"!==r.version)return B.default.error("unsupported protocol: "+r.protocol+" ver "+r.version),void t._fsm.unsupportedProtocol();var i=null;try{i=l(n.subarray(r.size,r.size+r.headerSize))}catch(n){return B.default.error("failed to parse message header",n,e),void t._fsm.protocolError()}B.default.trace("message received: ",i);var o=null;if(i.payload_size>0){var s=2+r.size+r.headerSize,c=i.payload_size;if(i.hasOwnProperty("payload_type")&&0!==i.payload_type.indexOf("application/json"))0===i.payload_type.indexOf("text/plain")&&(o=a(n.subarray(s,s+c)));else try{o=l(n.subarray(s,s+c))}catch(n){return B.default.error("failed to parse message body",n,e),void t._fsm.protocolError()}}t._updateActivityTimestamp(),"notification"===i.method?(t._confirmReceiving(i),t.emit("message",i.message_type,o)):"reply"===i.method?t.emit("reply",{id:i.id,status:i.status,header:i,body:o}):"ping"===i.method?t._confirmReceiving(i):"close"===i.method&&(B.default.trace("connection close initated by server"),t._confirmReceiving(i),308===i.status.code?(B.default.info("connection has been offloaded"),t._fsm.receiveOffload({status:i.status.status,body:o})):406===i.status.code?(B.default.error("connection has been rejected because server can not parse protocol"),t._fsm.receiveFatalClose()):417===i.status.code?(B.default.info("connection has been rejected because server could not understand client`s reply"),t._fsm.receiveFatalClose(i.status.status)):410===i.status.code?(B.default.info("connection has expired"),t._fsm.receiveClose(i.status.status)):401===i.status.code?(B.default.info("connection is not authenticate"),t._fsm.receiveClose(i.status.status)):(B.default.error("unexpected close: ",i.status),t._fsm.receiveOffload({status:i.status.status,body:null})))},this._activeToken=this._config.token,this._socket=n}},{key:"_sendInit",value:function(){B.default.trace("_sendInit");var t={id:z.default.v4(),method:"init",token:this._activeToken};this._sendPacket(t),this._storeRequest(t.id,"init",5e3)}},{key:"_sendUpdate",value:function(){B.default.trace("_sendUpdate");var t={id:z.default.v4(),method:"update",token:this._activeToken};this._sendPacket(t),this._storeRequest(t.id,"update",5e3)}},{key:"_cancelInit",value:function(){B.default.trace("_cancelInit");var t=!0,e=!1,n=void 0;try{for(var r,i=(0,m.default)(this._activeRequests);!(t=(r=i.next()).done);t=!0){var o=(0,_.default)(r.value,2),s=o[0],a=o[1];a&&"init"===a.reqType&&(clearTimeout(a.timeout),this._activeRequests.delete(s))}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}},{key:"_cancelUpdate",value:function(){B.default.trace("_cancelUpdate");var t=!0,e=!1,n=void 0;try{for(var r,i=(0,m.default)(this._activeRequests);!(t=(r=i.next()).done);t=!0){var o=(0,_.default)(r.value,2),s=o[0],a=o[1];a&&"update"===a.reqType&&(clearTimeout(a.timeout),this._activeRequests.delete(s))}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}},{key:"_confirmReceiving",value:function(t){B.default.trace("_confirmReceiving");var e={method:"reply",id:t.id,payload_type:"application/json",status:{code:200,status:"OK"}};try{this._sendPacket(e)}catch(t){B.default.debug("failed to confirm packet receiving",t)}}},{key:"_sendPacket",value:function(t,e){var n=c(e);t.payload_size=o(n);var r=(0,F.default)(t)+"\r\n",i="TWILSOCK V3.0 "+(o(r)-2)+"\r\n";B.default.debug("send request:",i+r+n);var a=s(i+r+n);try{this._socket.send(a.buffer)}catch(e){throw B.default.info("failed to send ",t,e),B.default.info(e.stack),e}}},{key:"_closeSocket",value:function(){B.default.trace("_closeSocket"),this._socket&&(this._socket.onopen=null,this._socket.onclose=null,this._socket.onerror=null,this._socket.onmessage=null,this._socket.close()),this._fsm.socketClosed()}},{key:"connect",value:function(){B.default.trace("connect"),this._fsm.userConnect()}},{key:"disconnect",value:function(){var t=this;return B.default.trace("disconnect"),this._fsm.is("disconnected")?p.default.resolve():new p.default(function(e){t._disconnectedPromiseResolve=e,t._fsm.userDisconnect()})}},{key:"updateToken",value:function(){if(B.default.trace("updateToken:",this._config.token),"initialising"===this._fsm.current||"updating"===this._fsm.current||"waitSocketClosed"===this._fsm.current||"waitOffloadSocketClosed"===this._fsm.current)return B.default.debug("defer updateToken because of",this._fsm.current,"is in progress"),void(this._isDeferredUpdate=!0);this._isDeferredUpdate=!1,this._activeToken=this._config.token,this._fsm.userUpdateToken()}},{key:"sendUpstreamMessage",value:function(t,e,n){var r=z.default.v4(),i={host:t.host,path:t.path,method:t.method};t.hasOwnProperty("params")&&(i.params=t.params);var o={method:"message",id:r,http_request:i};return e&&(o.http_request.headers=e),e&&e.hasOwnProperty("Content-Type")&&(o.payload_type=e["Content-Type"]),this._sendPacket(o,n),r}},{key:"send",value:function(t,e){return t.id=t.id||z.default.v4(),this._sendPacket(t,e),t.id}},{key:"_onCloseReceived",value:function(t){B.default.trace("_onCloseReceived"),B.default.info("connection closed by server, reason is",t),this._socket&&(this._socket.onopen=null,this._socket.onerror=null,this._socket.onmessage=null)}},{key:"_startWatchdogTimer",value:function(){var t=this;B.default.trace("_startWatchdogTimer"),this._timestamp=Date.now(),this._watchTimer=setInterval(function(){Date.now()-t._timestamp>43e3&&t._socket&&t._socket.close()},5e3)}},{key:"_stopWatchdogTimer",value:function(){B.default.trace("_stopWatchdogTimer"),clearInterval(this._watchTimer)}},{key:"_updateActivityTimestamp",value:function(){B.default.trace("_updateActivityTimestamp"),this._timestamp=Date.now()}}]),e}(N.default);e.default=Q,Q.state={DISCONNECTED:"disconnected",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTING:"disconnecting",ERROR:"error",REJECTED:"rejected"},(0,h.default)(Q.state),(0,h.default)(Q),t.exports=e.default}).call(e,n("h6ac"))},ky2m:function(t,e,n){n("BtHH"),t.exports=n("zKeE").Object.getPrototypeOf},l262:function(t){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},lmjd:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("aIIw"),o=r(i),s=n("X9RM"),a=r(s),u=n("6t7t"),c=r(u),l=n("dACh"),f=r(l),h=n("jx4H"),d=r(h);Object.defineProperty(e,"__esModule",{value:!0});var p=function(){function t(e,n){(0,f.default)(this,t),this.balanceFactor=0,this.key=e,this.value=n,this.parent=null,this.left=null,this.right=null}return(0,d.default)(t,[{key:"update",value:function(t){this.value=t}},{key:"replace",value:function(t,e){t&&(this.left===e?this.left=e:this.right===e&&(this.right=e))}},{key:"isRoot",get:function(){return null===this.parent}},{key:"isLeaf",get:function(){return null===this.left&&null===this.right}},{key:"isLeftChild",get:function(){return this.parent.left===this}}]),t}();e.TreeMap=function(){function t(e,n){(0,f.default)(this,t),this.isLessThan=e||function(t,e){return t<e},this.isEqual=n||function(t,e){return t===e},this.root=null,this.count=null}return(0,d.default)(t,[{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(t,e){var n=this.getNode(t);n?n.update(e):this.insert(t,e)}},{key:"insert",value:function(t,e){var n=new p(t,e);if(this.count++,!this.root)return void(this.root=n);for(var r=this.root;;)if(this.isLessThan(t,r.key)){if(!r.left){r.left=n;break}r=r.left}else{if(!r.right){r.right=n;break}r=r.right}for(n.parent=r,r=n;r.parent;){var i=r.parent,o=i.balanceFactor;if(r.isLeftChild?i.balanceFactor++:i.balanceFactor--,Math.abs(i.balanceFactor)<Math.abs(o))break;if(i.balanceFactor<-1||i.balanceFactor>1){this.rebalance(i);break}r=i}}},{key:"get",value:function(t){for(var e=this.root;e;){if(this.isEqual(t,e.key))return e.value;e=this.isLessThan(t,e.key)?e.left:e.right}return null}},{key:"delete",value:function(t){var e=this.getNode(t);if(!e||e.key!==t)return null;var n=e.parent,r=e.left,i=e.right;if(!!r!=!!i){var o=r||i;n||o?n&&!o?this.root=o:(n.replace(e,null),this.rebalance(n)):this.root=null}else{for(var s=e.left;s.right;)s=s.right;if(e.left===s)e.isRoot?(this.root=s,s.parent=null):(e.isLeftChild?e.parent.left=s:e.parent.right=s,s.parent=e.parent),s.right=e.right,s.right.parent=s,s.balanceFactor=e.balanceFactor,e={parent:s,isLeftChild:!0};else{var a=s.parent,u=s.left;a.right=u,u&&(u.parent=a),e.isRoot?(this.root=s,s.parent=null):(e.isLeftChild?e.parent.left=s:e.parent.right=s,s.parent=e.parent),s.right=e.right,s.right.parent=s,s.left=e.left,s.left.parent=s,s.balanceFactor=e.balanceFactor,e={parent:a,isLeftChild:!1}}}for(this.count--;e.parent;){var c=e.parent,l=c.balanceFactor;if(e.isLeftChild?c.balanceFactor-=1:c.balanceFactor+=1,Math.abs(c.balanceFactor)>Math.abs(l)){if(!(c.balanceFactor<-1||c.balanceFactor>1))break;if(this.rebalance(c),0!==c.parent.balanceFactor)break;e=c.parent}else e=c}return null}},{key:"getNode",value:function(t){for(var e=this.root;e;){if(this.isEqual(t,e.key))return e;e=this.isLessThan(t,e.key)?e.left:e.right}return null}},{key:"rebalance",value:function(t){t.balanceFactor<0?t.right.balanceFactor>0?(this.rotateRight(t.right),this.rotateLeft(t)):this.rotateLeft(t):t.balanceFactor>0&&(t.left.balanceFactor<0?(this.rotateLeft(t.left),this.rotateRight(t)):this.rotateRight(t))}},{key:"rotateLeft",value:function(t){var e=t.right;t.right=e.left,null!==e.left&&(e.left.parent=t),e.parent=t.parent,null===e.parent?this.root=e:t.isLeftChild?e.parent.left=e:e.parent.right=e,e.left=t,t.parent=e,t.balanceFactor=t.balanceFactor+1-Math.min(e.balanceFactor,0),e.balanceFactor=e.balanceFactor+1-Math.max(t.balanceFactor,0)}},{key:"rotateRight",value:function(t){var e=t.left;t.left=e.right,null!==e.right&&(e.right.parent=t),e.parent=t.parent,null===e.parent?this.root=e:t.isLeftChild?e.parent.left=e:e.parent.right=e,e.right=t,t.parent=e,t.balanceFactor=t.balanceFactor-1-Math.min(e.balanceFactor,0),e.balanceFactor=e.balanceFactor-1-Math.max(t.balanceFactor,0)}},{key:c.default,value:o.default.mark(function t(){var e,n,r,i,s,u;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=!0,n=!1,r=void 0,t.prev=3,i=(0,a.default)(this.getIterator());case 5:if(e=(s=i.next()).done){t.next=12;break}return u=s.value,t.next=9,u;case 9:e=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(3),n=!0,r=t.t0;case 18:t.prev=18,t.prev=19,!e&&i.return&&i.return();case 21:if(t.prev=21,!n){t.next=24;break}throw r;case 24:return t.finish(21);case 25:return t.finish(18);case 26:case"end":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25]])})},{key:"getIterator",value:o.default.mark(function t(){var e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.root;case 1:if(!e){t.next=7;break}if(!this.isEqual(r,e.key)&&(null!==r||e.left)){t.next=4;break}return t.abrupt("break",7);case 4:e=this.isLessThan(r,e.key)||null===r?e.left:e.right,t.next=1;break;case 7:if(e){t.next=9;break}return t.abrupt("return",null);case 9:n=!0;case 10:if(!n){t.next=28;break}return t.next=13,[e.key,e.value];case 13:if(n=!1,!e.right){t.next=20;break}for(e=e.right;e.left;)e=e.left;n=!0,t.next=26;break;case 20:if(!e.parent){t.next=25;break}n=e.parent.left===e,e=e.parent,t.next=26;break;case 25:return t.abrupt("break",36);case 26:t.next=34;break;case 28:if(!e.parent){t.next=33;break}n=e.parent.left===e,e=e.parent,t.next=34;break;case 33:return t.abrupt("break",36);case 34:t.next=10;break;case 36:return t.abrupt("return",null);case 37:case"end":return t.stop()}},t,this)})},{key:"getReverseIterator",value:o.default.mark(function t(){var e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.root;case 1:if(!e){t.next=7;break}if(!this.isEqual(r,e.key)&&(null!==r||e.right)){t.next=4;break}return t.abrupt("break",7);case 4:e=this.isLessThan(r,e.key)&&null!==r?e.left:e.right,t.next=1;break;case 7:if(e){t.next=9;break}return t.abrupt("return",null);case 9:n=!0;case 10:if(!n){t.next=28;break}return t.next=13,[e.key,e.value];case 13:if(n=!1,!e.left){t.next=20;break}for(e=e.left;e.right;)e=e.right;n=!0,t.next=26;break;case 20:if(!e.parent){t.next=25;break}n=e.parent.right===e,e=e.parent,t.next=26;break;case 25:return t.abrupt("break",36);case 26:t.next=34;break;case 28:if(!e.parent){t.next=33;break}n=e.parent.right===e,e=e.parent,t.next=34;break;case 33:return t.abrupt("break",36);case 34:t.next=10;break;case 36:return t.abrupt("return",null);case 37:case"end":return t.stop()}},t,this)})},{key:"size",get:function(){return this.count}}]),t}()},luWe:function(t,e,n){"use strict";function r(t,e){return[t].concat((0,o.default)(e))}var i=n("VuZO"),o=function(t){return t&&t.__esModule?t:{default:t}}(i);Object.defineProperty(e,"__esModule",{value:!0});var s=n("T51w");e.default={setLevel:function(t){s.setLevel(t)},trace:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.trace.apply(null,r("EMS T:",e))},debug:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.debug.apply(null,r("EMS D:",e))},info:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.info.apply(null,r("EMS I:",e))},warn:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.warn.apply(null,r("EMS W:",e))},error:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.error.apply(null,r("EMS E:",e))}}},lytE:function(t,e,n){var r=n("MpYs"),i=n("U72i");t.exports=function(t){return function(e,n){var o,s,a=String(i(e)),u=r(n),c=a.length;return u<0||u>=c?t?"":void 0:(o=a.charCodeAt(u),o<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):s-56320+(o-55296<<10)+65536)}}},m8OI:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n("gkZy"),o=r(i),s=n("X9RM"),a=r(s);e.default=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var s,u=(0,a.default)(t);!(r=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if((0,o.default)(Object(e)))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},mbLO:function(t,e,n){var r=n("U72i");t.exports=function(t){return Object(r(t))}},mc9D:function(t,e){var n,r;!function(){function i(t,e){return this instanceof i?(this._low=0,this._high=0,this.remainder=null,void 0===e?s.call(this,t):"string"==typeof t?a.call(this,t,e):void o.call(this,t,e)):new i(t,e)}function o(t,e){return this._low=0|t,this._high=0|e,this}function s(t){return this._low=65535&t,this._high=t>>>16,this}function a(t,e){var n=parseInt(t,e||10);return this._low=65535&n,this._high=n>>>16,this}i(Math.pow(36,5)),i(Math.pow(16,7)),i(Math.pow(10,9)),i(Math.pow(2,30)),i(36),i(16),i(10),i(2);i.prototype.fromBits=o,i.prototype.fromNumber=s,i.prototype.fromString=a,i.prototype.toNumber=function(){return 65536*this._high+this._low},i.prototype.toString=function(t){return this.toNumber().toString(t||10)},i.prototype.add=function(t){var e=this._low+t._low,n=e>>>16;return n+=this._high+t._high,this._low=65535&e,this._high=65535&n,this},i.prototype.subtract=function(t){return this.add(t.clone().negate())},i.prototype.multiply=function(t){var e,n,r=this._high,i=this._low,o=t._high,s=t._low;return n=i*s,e=n>>>16,e+=r*s,e&=65535,e+=i*o,this._low=65535&n,this._high=65535&e,this},i.prototype.div=function(t){if(0==t._low&&0==t._high)throw Error("division by zero");if(0==t._high&&1==t._low)return this.remainder=new i(0),this;if(t.gt(this))return this.remainder=this.clone(),this._low=0,this._high=0,this;if(this.eq(t))return this.remainder=new i(0),this._low=1,this._high=0,this;for(var e=t.clone(),n=-1;!this.lt(e);)e.shiftLeft(1,!0),n++;for(this.remainder=this.clone(),this._low=0,this._high=0;n>=0;n--)e.shiftRight(1),this.remainder.lt(e)||(this.remainder.subtract(e),n>=16?this._high|=1<<n-16:this._low|=1<<n);return this},i.prototype.negate=function(){var t=1+(65535&~this._low);return this._low=65535&t,this._high=~this._high+(t>>>16)&65535,this},i.prototype.equals=i.prototype.eq=function(t){return this._low==t._low&&this._high==t._high},i.prototype.greaterThan=i.prototype.gt=function(t){return this._high>t._high||!(this._high<t._high)&&this._low>t._low},i.prototype.lessThan=i.prototype.lt=function(t){return this._high<t._high||!(this._high>t._high)&&this._low<t._low},i.prototype.or=function(t){return this._low|=t._low,this._high|=t._high,this},i.prototype.and=function(t){return this._low&=t._low,this._high&=t._high,this},i.prototype.not=function(){return this._low=65535&~this._low,this._high=65535&~this._high,this},i.prototype.xor=function(t){return this._low^=t._low,this._high^=t._high,this},i.prototype.shiftRight=i.prototype.shiftr=function(t){return t>16?(this._low=this._high>>t-16,this._high=0):16==t?(this._low=this._high,this._high=0):(this._low=this._low>>t|this._high<<16-t&65535,this._high>>=t),this},i.prototype.shiftLeft=i.prototype.shiftl=function(t,e){return t>16?(this._high=this._low<<t-16,this._low=0,e||(this._high&=65535)):16==t?(this._high=this._low,this._low=0):(this._high=this._high<<t|this._low>>16-t,this._low=this._low<<t&65535,e||(this._high&=65535)),this},i.prototype.rotateLeft=i.prototype.rotl=function(t){var e=this._high<<16|this._low;return e=e<<t|e>>>32-t,this._low=65535&e,this._high=e>>>16,this},i.prototype.rotateRight=i.prototype.rotr=function(t){var e=this._high<<16|this._low;return e=e>>>t|e<<32-t,this._low=65535&e,this._high=e>>>16,this},i.prototype.clone=function(){return new i(this._low,this._high)},n=[],void 0!==(r=function(){return i}.apply(e,n))&&(t.exports=r)}()},nFDa:function(t,e,n){n("i+u+"),n("COf8"),t.exports=n("ZxII").f("iterator")},o4G5:function(t){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},obon:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){return[t].concat((0,s.default)(e))}Object.defineProperty(e,"__esModule",{value:!0});var o=n("VuZO"),s=r(o),a=n("T51w"),u=r(a);e.default={setLevel:function(t){u.default.setLevel(t)},trace:function(){u.default.trace.apply(null,i("Twilsock T:",arguments))},debug:function(){u.default.debug.apply(null,i("Twilsock D:",arguments))},info:function(){u.default.info.apply(null,i("Twilsock I:",arguments))},warn:function(){u.default.warn.apply(null,i("Twilsock W:",arguments))},error:function(){u.default.error.apply(null,i("Twilsock E:",arguments))}},t.exports=e.default},ozpD:function(t,e,n){var r=n("3zRh"),i=n("hEIm"),o=n("af0K"),s=n("zotD"),a=n("S7IM"),u=n("7AqT"),c={},l={},e=t.exports=function(t,e,n,f,h){var d,p,v,_,y=h?function(){return t}:u(t),m=r(n,f,e?2:1),g=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(o(y)){for(d=a(t.length);d>g;g++)if((_=e?m(s(p=t[g])[0],p[1]):m(t[g]))===c||_===l)return _}else for(v=y.call(t);!(p=v.next()).done;)if((_=i(v,m,p.value,e))===c||_===l)return _};e.BREAK=c,e.RETURN=l},pFSU:function(t,e,n){var r=n("knrM"),i=n("Wyka");t.exports=function(t,e){for(var n,o=i(t),s=r(o),a=s.length,u=0;a>u;)if(o[n=s[u++]]===e)return n}},peL6:function(t,e,n){"use strict";(function(t){function r(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(t,e){if(r()<e)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=o.prototype):(null===t&&(t=new o(e)),t.length=e),t}function o(t,e,n){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,e,n)}function s(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?h(t,e,n,r):"string"==typeof e?l(t,e,n):d(t,e)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e,n,r){return a(e),e<=0?i(t,e):void 0!==n?"string"==typeof r?i(t,e).fill(n,r):i(t,e).fill(n):i(t,e)}function c(t,e){if(a(e),t=i(t,e<0?0:0|p(e)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function l(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!o.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|_(e,n);t=i(t,r);var s=t.write(e,n);return s!==r&&(t=t.slice(0,s)),t}function f(t,e){var n=e.length<0?0:0|p(e.length);t=i(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function h(t,e,n,r){if(n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),o.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=o.prototype):t=f(t,e),t}function d(t,e){if(o.isBuffer(e)){var n=0|p(e.length);return t=i(t,n),0===t.length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||Y(e.length)?i(t,0):f(t,e);if("Buffer"===e.type&&Z(e.data))return f(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(t){if(t>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|t}function v(t){return+t!=t&&(t=0),o.alloc(+t)}function _(t,e){if(o.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(t).length;default:if(r)return V(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,n);case"utf8":case"utf-8":return O(this,e,n);case"ascii":return R(this,e,n);case"latin1":case"binary":return j(this,e,n);case"base64":return T(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function m(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=o.from(e,r)),o.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,i);if("number"==typeof e)return e&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,i){function o(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}var s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}var c;if(i){var l=-1;for(c=n;c<a;c++)if(o(t,c)===o(e,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===u)return l*s}else-1!==l&&(c-=c-l),l=-1}else for(n+u>a&&(n=a-u),c=n;c>=0;c--){for(var f=!0,h=0;h<u;h++)if(o(t,c+h)!==o(e,h)){f=!1;break}if(f)return c}return-1}function w(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function k(t,e,n,r){return Q(V(e,t.length-n),t,n,r)}function x(t,e,n,r){return Q(W(e),t,n,r)}function C(t,e,n,r){return x(t,e,n,r)}function E(t,e,n,r){return Q(G(e),t,n,r)}function S(t,e,n,r){return Q(K(e,t.length-n),t,n,r)}function T(t,e,n){return X.fromByteArray(0===e&&n===t.length?t:t.slice(e,n))}function O(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o=t[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=n){var u,c,l,f;switch(a){case 1:o<128&&(s=o);break;case 2:u=t[i+1],128==(192&u)&&(f=(31&o)<<6|63&u)>127&&(s=f);break;case 3:u=t[i+1],c=t[i+2],128==(192&u)&&128==(192&c)&&(f=(15&o)<<12|(63&u)<<6|63&c)>2047&&(f<55296||f>57343)&&(s=f);break;case 4:u=t[i+1],c=t[i+2],l=t[i+3],128==(192&u)&&128==(192&c)&&128==(192&l)&&(f=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&f<1114112&&(s=f)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),i+=a}return A(r)}function A(t){var e=t.length;if(e<=$)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=$));return n}function R(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function j(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function P(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=H(t[o]);return i}function I(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function F(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,n,r,i,s){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function L(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function N(t,e,n,r){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(t,e,n,r,i){return i||N(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(t,e,n,r,23,4),n+4}function B(t,e,n,r,i){return i||N(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(t,e,n,r,52,8),n+8}function q(t){if(t=z(t).replace(tt,""),t.length<2)return"";for(;t.length%4!=0;)t+="=";return t}function z(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function H(t){return t<16?"0"+t.toString(16):t.toString(16)}function V(t,e){e=e||1/0;for(var n,r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function W(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function K(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function G(t){return X.toByteArray(q(t))}function Q(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function Y(t){return t!==t}var X=n("yh9p"),J=n("JgNJ"),Z=n("REa7");e.Buffer=o,e.SlowBuffer=v,e.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=r(),o.poolSize=8192,o._augment=function(t){return t.__proto__=o.prototype,t},o.from=function(t,e,n){return s(null,t,e,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(t,e,n){return u(null,t,e,n)},o.allocUnsafe=function(t){return c(null,t)},o.allocUnsafeSlow=function(t){return c(null,t)},o.isBuffer=function(t){return!(null==t||!t._isBuffer)},o.compare=function(t,e){if(!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Z(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=o.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},o.byteLength=_,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},o.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?O(this,0,t):y.apply(this,arguments)},o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},o.prototype.compare=function(t,e,n,r,i){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var s=i-r,a=n-e,u=Math.min(s,a),c=this.slice(r,i),l=t.slice(e,n),f=0;f<u;++f)if(c[f]!==l[f]){s=c[f],a=l[f];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},o.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},o.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},o.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return k(this,t,e,n);case"ascii":return x(this,t,e,n);case"latin1":case"binary":return C(this,t,e,n);case"base64":return E(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;o.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r;if(o.TYPED_ARRAY_SUPPORT)r=this.subarray(t,e),r.__proto__=o.prototype;else{var i=e-t;r=new o(i,void 0);for(var s=0;s<i;++s)r[s]=this[s+t]}return r},o.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||F(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},o.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||F(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},o.prototype.readUInt8=function(t,e){return e||F(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,e){return e||F(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,e){return e||F(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,e){return e||F(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUInt32BE=function(t,e){return e||F(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||F(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},o.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||F(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},o.prototype.readInt8=function(t,e){return e||F(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){e||F(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(t,e){e||F(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(t,e){return e||F(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return e||F(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return e||F(t,4,this.length),J.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return e||F(t,4,this.length),J.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return e||F(t,8,this.length),J.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return e||F(t,8,this.length),J.read(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){M(this,t,e,n,Math.pow(2,8*n)-1,0)}var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},o.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){M(this,t,e,n,Math.pow(2,8*n)-1,0)}var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},o.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,255,0),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},o.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},o.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},o.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):D(this,t,e,!0),e+4},o.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},o.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},o.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},o.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,127,-128),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},o.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},o.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):D(this,t,e,!0),e+4},o.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},o.prototype.writeFloatLE=function(t,e,n){return U(this,t,e,!0,n)},o.prototype.writeFloatBE=function(t,e,n){return U(this,t,e,!1,n)},o.prototype.writeDoubleLE=function(t,e,n){return B(this,t,e,!0,n)},o.prototype.writeDoubleBE=function(t,e,n){return B(this,t,e,!1,n)},o.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,s=r-n;if(this===t&&n<e&&e<r)for(i=s-1;i>=0;--i)t[i+e]=this[i+n];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},o.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0);var s;if("number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var a=o.isBuffer(t)?t:V(new o(t,r).toString()),u=a.length;for(s=0;s<n-e;++s)this[s+e]=a[s%u]}return this};var tt=/[^+\/0-9A-Za-z-_]/g}).call(e,n("h6ac"))},qEFr:function(t){t.exports={_args:[["twilio-sync@0.5.8","/Users/lsiegle/Desktop/web/twilio-barista"]],_from:"twilio-sync@0.5.8",_id:"twilio-sync@0.5.8",_inBundle:!1,_integrity:"sha1-8k4W1ffyRW2J3/Vi5ZDr7h4TCNo=",_location:"/twilio-sync",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"twilio-sync@0.5.8",name:"twilio-sync",escapedName:"twilio-sync",rawSpec:"0.5.8",saveSpec:null,fetchSpec:"0.5.8"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/twilio-sync/-/twilio-sync-0.5.8.tgz",_spec:"0.5.8",_where:"/Users/lsiegle/Desktop/web/twilio-barista",author:{name:"Twilio"},browser:"browser/index.js",dependencies:{"babel-runtime":"^6.23.0",karibu:"^1.0.1",loglevel:"^1.4.1","operation-retrier":"^1.1.2",platform:"^1.3.3",rfc6902:"^1.3.0","twilio-ems-client":"^0.2.0","twilio-notifications":"^0.4.0","twilio-transport":"^0.1.2",twilsock:"^0.3.0",uuid:"^3.0.1",xxhashjs:"^0.2.1"},description:"Twilio Sync client library",devDependencies:{"@types/chai":"^3.4.35","@types/chai-as-promised":"0.0.29","@types/loglevel":"^1.4.29","@types/mocha":"^2.2.39","@types/node":"^7.0.5","@types/sinon":"^1.16.35","@types/sinon-as-promised":"^4.0.5","@types/sinon-chai":"^2.7.27","async-test-tools":"^1.0.6","babel-cli":"^6.23.0","babel-plugin-add-module-exports":"^0.2.1","babel-plugin-array-includes":"^2.0.3","babel-plugin-transform-object-assign":"^6.22.0","babel-plugin-transform-runtime":"^6.23.0","babel-preset-es2015":"^6.22.0",babelify:"^7.3.0",backoff:"^2.5.0",browserify:"^14.1.0",chai:"^3.5.0","chai-as-promised":"^6.0.0",cheerio:"^0.22.0",del:"^2.2.2",gulp:"^3.9.1","gulp-babel":"^6.1.2","gulp-derequire":"^2.1.0","gulp-exit":"0.0.2","gulp-insert":"^0.5.0","gulp-istanbul":"^1.1.1","gulp-mocha":"^4.0.1","gulp-rename":"^1.2.2","gulp-replace":"^0.5.4","gulp-tap":"^0.1.3","gulp-tslint":"^7.1.0","gulp-typescript":"^3.1.5","gulp-uglify":"^2.0.1","gulp-util":"^3.0.8","ink-docstrap":"^1.3.0",isparta:"^4.0.0",jsdoc:"^3.4.3",jsonwebtoken:"^7.3.0",karma:"^1.5.0","karma-browserify":"^5.1.1","karma-browserstack-launcher":"^1.2.0","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.2","run-sequence":"^1.2.2",sinon:"^1.17.7","sinon-as-promised":"^4.0.2","sinon-chai":"^2.8.0","ts-node":"^3.0.0",tslint:"^4.5.1",twilio:"^3.3.0-edge",typescript:"2.2.1",underscore:"^1.8.3","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.1.0",watchify:"^3.9.0"},engines:{node:">=6"},license:"MIT",main:"lib/index.js",name:"twilio-sync",scripts:{prepublish:"gulp build",test:"gulp unit-test"},version:"0.5.8"}},qQO4:function(t,e,n){var r=n("hVVj"),i=n("hYHi"),o=i;o.v1=r,o.v4=i,t.exports=o},qXBc:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n("dACh"),o=r(i),s=n("jx4H"),a=r(s);Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(e){(0,o.default)(this,t),this.data=e}return(0,a.default)(t,[{key:"update",value:function(t,e,n){return this.data.lastEventId=t,this.data.revision=e,this.data.value=n,this}},{key:"uri",get:function(){return this.data.uri}},{key:"revision",get:function(){return this.data.revision}},{key:"lastEventId",get:function(){return this.data.lastEventId}},{key:"index",get:function(){return this.data.index}},{key:"value",get:function(){return this.data.value}}]),t}();e.ListItem=u,e.default=u},r9SO:function(t,e,n){t.exports={h32:n("Nf0/"),h64:n("OFjk")}},rMkZ:function(t,e,n){var r=n("Wyka"),i=n("Ni5N").f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(t){try{return i(t)}catch(t){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?a(t):i(r(t))}},sxPs:function(t,e,n){var r=n("z7R8"),i=n("0WCH"),o=n("Wyka"),s=n("EKwp"),a=n("yS17"),u=n("R6c1"),c=Object.getOwnPropertyDescriptor;e.f=n("6MLN")?c:function(t,e){if(t=o(t),e=s(e,!0),u)try{return c(t,e)}catch(t){}if(a(t,e))return i(!r.f.call(t,e),t[e])}},tMiz:function(t,e,n){var r=n("3zRh"),i=n("E5Ce"),o=n("mbLO"),s=n("S7IM"),a=n("TD/Z");t.exports=function(t,e){var n=1==t,u=2==t,c=3==t,l=4==t,f=6==t,h=5==t||f,d=e||a;return function(e,a,p){for(var v,_,y=o(e),m=i(y),g=r(a,p,3),b=s(m.length),w=0,k=n?d(e,b):u?d(e,0):void 0;b>w;w++)if((h||w in m)&&(v=m[w],_=g(v,w,y),t))if(n)k[w]=_;else if(_)switch(t){case 3:return!0;case 5:return v;case 6:return w;case 2:k.push(v)}else if(l)return!1;return f?-1:c||l?l:k}}},tcrG:function(t){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},tuDi:function(){},tvE3:function(t,e,n){n("FshL");var r=n("zKeE").Object;t.exports=function(t,e){return r.defineProperties(t,e)}},uRfg:function(t,e,n){"use strict";var r=n("1kq3"),i=n("vSO4"),o=n("gojl"),s=n("akPY"),a=n("yS17"),u=n("dhak"),c=n("b7Q2"),l=n("11Ut"),f=n("HHE0"),h=n("Ug9I")("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,v,_,y,m){c(n,e,v);var g,b,w,k=function(t){if(!d&&t in S)return S[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},x=e+" Iterator",C="values"==_,E=!1,S=t.prototype,T=S[h]||S["@@iterator"]||_&&S[_],O=T||k(_),A=_?C?k("entries"):O:void 0,R="Array"==e?S.entries||T:T;if(R&&(w=f(R.call(new t)))!==Object.prototype&&(l(w,x,!0),r||a(w,h)||s(w,h,p)),C&&T&&"values"!==T.name&&(E=!0,O=function(){return T.call(this)}),r&&!m||!d&&!E&&S[h]||s(S,h,O),u[e]=O,u[x]=p,_)if(g={values:C?O:k("values"),keys:y?O:k("keys"),entries:A},m)for(b in g)b in S||o(S,b,g[b]);else i(i.P+i.F*(d||E),e,g);return g}},ugM7:function(t,e,n){var r=n("zotD"),i=n("7AqT");t.exports=n("zKeE").getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return r(e.call(t))}},uj5A:function(t,e,n){"use strict";var r=n("knrM"),i=n("Ocr3"),o=n("z7R8"),s=n("mbLO"),a=n("E5Ce"),u=Object.assign;t.exports=!u||n("wLcK")(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r})?function(t){for(var e=s(t),n=arguments.length,u=1,c=i.f,l=o.f;n>u;)for(var f,h=a(arguments[u++]),d=c?r(h).concat(c(h)):r(h),p=d.length,v=0;p>v;)l.call(h,f=d[v++])&&(e[f]=h[f]);return e}:u},uxiv:function(t,e){!function(){var n={VERSION:"2.4.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(t,e){var r="string"==typeof t.initial?{state:t.initial}:t.initial,i=t.terminal||t.final,o=e||t.target||{},s=t.events||[],a=t.callbacks||{},u={},c={},l=function(t){var e=Array.isArray(t.from)?t.from:t.from?[t.from]:[n.WILDCARD];u[t.name]=u[t.name]||{};for(var r=0;r<e.length;r++)c[e[r]]=c[e[r]]||[],c[e[r]].push(t.name),u[t.name][e[r]]=t.to||e[r];t.to&&(c[t.to]=c[t.to]||[])};r&&(r.event=r.event||"startup",l({name:r.event,from:"none",to:r.state}));for(var f=0;f<s.length;f++)l(s[f]);for(var h in u)u.hasOwnProperty(h)&&(o[h]=n.buildEvent(h,u[h]));for(var h in a)a.hasOwnProperty(h)&&(o[h]=a[h]);return o.current="none",o.is=function(t){return Array.isArray(t)?t.indexOf(this.current)>=0:this.current===t},o.can=function(t){return!this.transition&&void 0!==u[t]&&(u[t].hasOwnProperty(this.current)||u[t].hasOwnProperty(n.WILDCARD))},o.cannot=function(t){return!this.can(t)},o.transitions=function(){return(c[this.current]||[]).concat(c[n.WILDCARD]||[])},o.isFinished=function(){return this.is(i)},o.error=t.error||function(t,e,n,r,i,o,s){throw s||o},o.states=function(){return Object.keys(c).sort()},r&&!r.defer&&o[r.event](),o},doCallback:function(t,e,r,i,o,s){if(e)try{return e.apply(t,[r,i,o].concat(s))}catch(e){return t.error(r,i,o,s,n.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",e)}},beforeAnyEvent:function(t,e,r,i,o){return n.doCallback(t,t.onbeforeevent,e,r,i,o)},afterAnyEvent:function(t,e,r,i,o){return n.doCallback(t,t.onafterevent||t.onevent,e,r,i,o)},leaveAnyState:function(t,e,r,i,o){return n.doCallback(t,t.onleavestate,e,r,i,o)},enterAnyState:function(t,e,r,i,o){return n.doCallback(t,t.onenterstate||t.onstate,e,r,i,o)},changeState:function(t,e,r,i,o){return n.doCallback(t,t.onchangestate,e,r,i,o)},beforeThisEvent:function(t,e,r,i,o){return n.doCallback(t,t["onbefore"+e],e,r,i,o)},afterThisEvent:function(t,e,r,i,o){return n.doCallback(t,t["onafter"+e]||t["on"+e],e,r,i,o)},leaveThisState:function(t,e,r,i,o){return n.doCallback(t,t["onleave"+r],e,r,i,o)},enterThisState:function(t,e,r,i,o){return n.doCallback(t,t["onenter"+i]||t["on"+i],e,r,i,o)},beforeEvent:function(t,e,r,i,o){if(!1===n.beforeThisEvent(t,e,r,i,o)||!1===n.beforeAnyEvent(t,e,r,i,o))return!1},afterEvent:function(t,e,r,i,o){n.afterThisEvent(t,e,r,i,o),n.afterAnyEvent(t,e,r,i,o)},leaveState:function(t,e,r,i,o){var s=n.leaveThisState(t,e,r,i,o),a=n.leaveAnyState(t,e,r,i,o);return!1!==s&&!1!==a&&(n.ASYNC===s||n.ASYNC===a?n.ASYNC:void 0)},enterState:function(t,e,r,i,o){n.enterThisState(t,e,r,i,o),n.enterAnyState(t,e,r,i,o)},buildEvent:function(t,e){return function(){var r=this.current,i=e[r]||(e[n.WILDCARD]!=n.WILDCARD?e[n.WILDCARD]:r)||r,o=Array.prototype.slice.call(arguments);if(this.transition)return this.error(t,r,i,o,n.Error.PENDING_TRANSITION,"event "+t+" inappropriate because previous transition did not complete");if(this.cannot(t))return this.error(t,r,i,o,n.Error.INVALID_TRANSITION,"event "+t+" inappropriate in current state "+this.current);if(!1===n.beforeEvent(this,t,r,i,o))return n.Result.CANCELLED;if(r===i)return n.afterEvent(this,t,r,i,o),n.Result.NOTRANSITION;var s=this;this.transition=function(){return s.transition=null,s.current=i,n.enterState(s,t,r,i,o),n.changeState(s,t,r,i,o),n.afterEvent(s,t,r,i,o),n.Result.SUCCEEDED},this.transition.cancel=function(){s.transition=null,n.afterEvent(s,t,r,i,o)};var a=n.leaveState(this,t,r,i,o);return!1===a?(this.transition=null,n.Result.CANCELLED):n.ASYNC===a?n.Result.PENDING:this.transition?this.transition():void 0}}};void 0!==t&&t.exports&&(e=t.exports=n),e.StateMachine=n}()},uzcO:function(t,e,n){var r,i,o,s=n("3zRh"),a=n("o4G5"),u=n("ebIA"),c=n("9kxq"),l=n("i1Q6"),f=l.process,h=l.setImmediate,d=l.clearImmediate,p=l.MessageChannel,v=0,_={},y=function(){var t=+this;if(_.hasOwnProperty(t)){var e=_[t];delete _[t],e()}},m=function(t){y.call(t.data)};h&&d||(h=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return _[++v]=function(){a("function"==typeof t?t:Function(t),e)},r(v),v},d=function(t){delete _[t]},"process"==n("ShN9")(f)?r=function(t){f.nextTick(s(y,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,r=s(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(t){l.postMessage(t+"","*")},l.addEventListener("message",m,!1)):r="onreadystatechange"in c("script")?function(t){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),y.call(t)}}:function(t){setTimeout(s(y,t,1),0)}),t.exports={set:h,clear:d}},vSO4:function(t,e,n){var r=n("i1Q6"),i=n("zKeE"),o=n("3zRh"),s=n("akPY"),a=function t(e,n,a){var u,c,l,f=e&t.F,h=e&t.G,d=e&t.S,p=e&t.P,v=e&t.B,_=e&t.W,y=h?i:i[n]||(i[n]={}),m=y.prototype,g=h?r:d?r[n]:(r[n]||{}).prototype;h&&(a=n);for(u in a)(c=!f&&g&&void 0!==g[u])&&u in y||(l=c?g[u]:a[u],y[u]=h&&"function"!=typeof g[u]?a[u]:v&&c?o(l,r):_&&g[u]==l?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):p&&"function"==typeof l?o(Function.call,l):l,p&&((y.virtual||(y.virtual={}))[u]=l,e&t.R&&m&&!m[u]&&s(m,u,l)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},vUQk:function(t,e,n){"use strict";var r=n("Gfzd"),i=n("0WCH");t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},vcHl:function(t,e,n){n("YD0x"),t.exports=n("zKeE").Object.assign},vexR:function(t){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},vvo2:function(t,e,n){n("tuDi"),n("i+u+"),n("COf8"),n("+o4f"),n("XMdB"),t.exports=n("zKeE").Set},wLcK:function(t){t.exports=function(t){try{return!!t()}catch(t){return!0}}},x6MZ:function(t,e,n){var r=n("ZHvQ"),i=n("YLmZ");t.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},"xwD+":function(t){t.exports=function(t,e){return{value:e,done:!!t}}},y9oC:function(t,e,n){(function(e){(function(){t.exports=n("An/8"),null!=e.window&&(e.window.Bottleneck=t.exports)}).call(this)}).call(e,n("h6ac"))},yOG5:function(t,e,n){var r=n("vSO4");r(r.S,"Object",{create:n("TNJq")})},yS17:function(t){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},ycyv:function(t,e,n){var r=n("knrM"),i=n("Ocr3"),o=n("z7R8");t.exports=function(t){var e=r(t),n=i.f;if(n)for(var s,a=n(t),u=o.f,c=0;a.length>c;)u.call(t,s=a[c++])&&e.push(s);return e}},yeEC:function(t,e,n){t.exports={default:n("cjsw"),__esModule:!0}},yh9p:function(t,e){"use strict";function n(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function r(t){return 3*t.length/4-n(t)}function i(t){var e,r,i,o,s,a=t.length;o=n(t),s=new l(3*a/4-o),r=o>0?a-4:a;var u=0;for(e=0;e<r;e+=4)i=c[t.charCodeAt(e)]<<18|c[t.charCodeAt(e+1)]<<12|c[t.charCodeAt(e+2)]<<6|c[t.charCodeAt(e+3)],s[u++]=i>>16&255,s[u++]=i>>8&255,s[u++]=255&i;return 2===o?(i=c[t.charCodeAt(e)]<<2|c[t.charCodeAt(e+1)]>>4,s[u++]=255&i):1===o&&(i=c[t.charCodeAt(e)]<<10|c[t.charCodeAt(e+1)]<<4|c[t.charCodeAt(e+2)]>>2,s[u++]=i>>8&255,s[u++]=255&i),s}function o(t){return u[t>>18&63]+u[t>>12&63]+u[t>>6&63]+u[63&t]}function s(t,e,n){for(var r,i=[],s=e;s<n;s+=3)r=(t[s]<<16)+(t[s+1]<<8)+t[s+2],i.push(o(r));return i.join("")}function a(t){for(var e,n=t.length,r=n%3,i="",o=[],a=0,c=n-r;a<c;a+=16383)o.push(s(t,a,a+16383>c?c:a+16383));return 1===r?(e=t[n-1],i+=u[e>>2],i+=u[e<<4&63],i+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],i+=u[e>>10],i+=u[e>>4&63],i+=u[e<<2&63],i+="="),o.push(i),o.join("")}e.byteLength=r,e.toByteArray=i,e.fromByteArray=a;for(var u=[],c=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,d=f.length;h<d;++h)u[h]=f[h],c[f.charCodeAt(h)]=h;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},z7R8:function(t,e){e.f={}.propertyIsEnumerable},zKeE:function(t){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},zWNa:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("LlWG"),o=r(i),s=n("dACh"),a=r(s),u=n("jx4H"),c=r(u);e.default=function(){function t(e,n){var r=this;(0,a.default)(this,t),n=(n||{}).Notification||{},(0,o.default)(this,{_registrarUri:{value:(n.ersUri||"https://ers.twilio.com")+"/v1/registrations"},_token:{value:e,writable:!0},registrarUri:{get:function(){return r._registrarUri}},token:{get:function(){return r._token}}})}return(0,c.default)(t,[{key:"updateToken",value:function(t){this._token=t}}]),t}(),t.exports=e.default},zotD:function(t,e,n){var r=n("BxvP");t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}}});
//# sourceMappingURL=debug.5604b.js.map